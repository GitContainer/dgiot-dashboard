/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2022年06月15日12时40分13秒
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0392ef72"],{"04d6":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"16c0":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{ref:"platform",staticClass:"platform"},[a("div",{staticClass:"home_dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.deviceInfo.name,visible:e.deviceFlag,width:"100vh"},on:{"update:visible":function(t){e.deviceFlag=t}}},[a("info",{attrs:{devicedetail:e.deviceInfo}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1),a("div",{staticClass:"map_header",style:{height:e.queryForm.workGroupTreeShow?"160px":"auto"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"0px"!=e.cardHeight,expression:"cardHeight != '0px'"}],staticClass:"map_card"},[a("el-row",[a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["product_count"],expression:"loadingConfig['product_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"projector-fill"}})],1),a("el-col",{staticClass:"card-right",attrs:{span:12}},[a("router-link",{attrs:{to:"/dashboard/productlist"}},[a("p",[e._v(e._s(e.$translateTitle("home.pro_count")))]),a("p",[e._v(e._s(e._product_count))])])],1)],1)],1),a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["app_count"],expression:"loadingConfig['app_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"apps-fill"}})],1),a("el-col",{staticClass:"card-right",attrs:{span:12}},[a("router-link",{attrs:{to:"/roles/applicationManagement"}},[a("p",[e._v(e._s(e.$translateTitle("home.app_count")))]),a("p",[e._v(e._s(e._app_count))])])],1)],1)],1),a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["device_count"],expression:"loadingConfig['device_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"device-recover-fill"}})],1),a("el-col",{staticClass:"card-right",staticStyle:{cursor:"pointer"},attrs:{span:12},nativeOn:{click:function(t){return e.goDevice()}}},[a("p",[e._v(e._s(e.$translateTitle("home.dev_count")))]),a("p",[e._v(e._s(e._dev_count))])])],1)],1),a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["warn_count"],expression:"loadingConfig['warn_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{staticClass:"card-left",attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"projector-2-fill"}})],1),a("el-col",{staticClass:"card-right",attrs:{span:12}},[a("router-link",{attrs:{to:"/CloudOt/alarm"}},[a("p",[e._v(" "+e._s(e.$translateTitle("equipment.Total number of alarms"))+" ")]),a("p",[e._v(e._s(e.warnCount))])])],1)],1)],1)],1)],1)]),a("el-card",{attrs:{shadow:"hover"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:"baidu"==e.mapType,expression:"mapType == 'baidu'"}],attrs:{row:24}},[a("el-col",{attrs:{span:e.leftRow,xs:24}},[a("el-row",{attrs:{span:24}},[a("div",{staticClass:"chart_map",staticStyle:{position:"relative"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"card_left"},[a("el-row",{staticClass:"card_left-row",attrs:{gutter:24}},[a("el-col",{staticClass:"card_left-row-col",attrs:{span:6}},[a("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#ffad33","border-color":"#ffad33"}},[a("div",{staticStyle:{"text-align":"center"}},[a("Tag",{staticStyle:{background:"rgb(255, 173, 51)"},attrs:{checkable:"",color:"warning"}},[e._v(" "+e._s(e.offlineData.length||0)+" ")]),a("p",[e._v(e._s(e.$translateTitle("zetadevices.offline")))])],1)])],1),a("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[a("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#19be6b","border-color":"#19be6b"}},[a("div",{staticStyle:{"text-align":"center"}},[a("Tag",{staticStyle:{background:"rgb(25, 190, 107)"},attrs:{checkable:"",color:"success"}},[e._v(" "+e._s(e.dev_online_count||0)+" ")]),a("p",[e._v(e._s(e.$translateTitle("zetadevices.online")))])],1)])],1),a("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[a("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#f16643","border-color":"#f16643"}},[a("div",{staticStyle:{"text-align":"center"}},[a("Tag",{staticStyle:{background:"rgb(241, 102, 67)"},attrs:{checkable:"",color:"error"}},[e._v(" "+e._s(e.warnCount)+" ")])],1),a("p",[e._v(" "+e._s(e.$translateTitle("leftbar.alarms"))+" ")])])],1)],1)],1),a("div",{staticClass:"card",staticStyle:{position:"absolute",right:"100px","z-index":"1000"}},[a("p",{staticStyle:{margin:"0","font-size":"18px",color:"#f16643","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("zetadevices.offline"))+" ")]),a("Card",{staticStyle:{width:"80px",height:"80px",color:"#fff","background-color":"#ffad33","border-color":"#ffad33","border-radius":"50%",opacity:"0.89"}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v(e._s(e.offlineData.length||0))])])]),a("p",{staticStyle:{margin:"0","font-size":"18px",color:"rgb(25, 190, 107)","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("zetadevices.online"))+" ")]),a("Card",{staticStyle:{width:"80px",height:"80px",margin:"5px 0",color:"#fff","background-color":"#19be6b","border-color":"#19be6b","border-radius":"50%",opacity:"0.89"}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v(e._s(e.dev_online_count||0))])])]),a("p",{staticStyle:{margin:"0","font-size":"18px",color:"rgb(241, 102, 67)","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("leftbar.alarms"))+" ")]),a("Card",{staticStyle:{width:"80px",height:"80px",color:"#fff","background-color":"#f16643","border-color":"#f16643","border-radius":"50%",opacity:"0.89"}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v(e._s(e.warnCount))])])])],1),a("baidu-map",{staticClass:"baidu_map",style:{height:e.mapHeight,width:e.mapWidth},attrs:{id:"baidu_map",ak:e.ak,center:e.center,"scroll-wheel-zoom":!0,zoom:e.sizeZoom}},[a("bm-control",[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=19}}},[e._v(" "+e._s(e.$translateTitle("home.max"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=10}}},[e._v(" "+e._s(e.$translateTitle("home.restore"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=3}}},[e._v(" "+e._s(e.$translateTitle("home.min"))+" ")]),a("el-button",{staticClass:"ri-fullscreen-fill",attrs:{size:"mini"},on:{click:function(t){return e.toggleFull()}}}),a("bm-overview-map",{attrs:{"is-open":!0}}),a("bm-scale",{attrs:{offset:{width:260,height:0}}}),a("bm-city-list",{attrs:{offset:{width:330,height:0}}})],1),a("bml-marker-clusterer",{attrs:{"average-center":!0}},e._l(e._tableData,(function(t,i){return a("div",{key:i},[a("bm-marker",{attrs:{animation:"BMAP_ANIMATION_BOUNCE",dragging:!0,icon:{url:1==t.icon?e.icoPath.icoPath1:e.icoPath.icoPath2,size:{width:70,height:70}},position:{lng:t.location.longitude,lat:t.location.latitude}}},[a("bm-label",{attrs:{content:t.name,"label-style":{color:"red",fontSize:"12px"},offset:{width:15,height:6}},on:{click:function(a){return e._goDevice(t,i)}}})],1)],1)})),0),a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),a("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","auto-location":!0,"show-address-bar":!0,"show-zoom-info":!0}})],1)],1)])],1),a("el-col",{attrs:{span:24-e.leftRow,xs:24}},[a("div",{staticClass:"home_card"},[a("el-tabs",{on:{"tab-click":e.resizeTheChart},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("home.info"),name:"first"}},[a("div",{staticClass:"box-card"},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-button",[e._v(" "+e._s(e.$translateTitle("home.info"))+" ")])],1),a("div",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple"},[e.Product?a("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.Product,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("menu.icon"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-image",{staticStyle:{width:"26px",height:"26px"},attrs:{"preview-src-list":[""+t.icon],src:t.icon}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])]}}],null,!1,3281234111)}),a("el-table-column",{attrs:{label:e.$translateTitle("task.productname"),prop:"name","show-overflow-tooltip":!0,width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{on:{click:function(t){return e.goDevice(i.name)}}},[e._v(" "+e._s(i.name)+" ")])]}}],null,!1,699248853)}),a("el-table-column",{attrs:{label:e.$translateTitle("home.dev_count")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{on:{click:function(t){return e.goDevice(i.name)}}},[e._v(" "+e._s(i.deviceChild.length)+" ")])]}}],null,!1,100581394)})],1):e._e()],1)])],1)],1)])],1),a("el-col",{attrs:{md:24,sm:24,xl:24,xs:24}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(" "+e._s(e.$translateTitle("equipment.Equipment Overview"))+" ")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{icon:"el-icon-refresh",type:"text"},on:{click:function(t){return e.resizeTheChart()}}})],1),a("div",{staticClass:"text item"},[a("dgiot-chart",{ref:"charts",attrs:{data:e._ChartStatus,"data-empty":!e.ChartStatus.rows,extend:e.chartExtend,height:"160px",loading:e.loading,settings:e.chartSettings,type:"ring"}})],1)])],1)],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_unline"),name:"second"}},[a("div",{staticClass:"box-card"},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-badge",{staticClass:"item",attrs:{value:e._dev_off_count}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_unline")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_unline"))+" ")])],1)],1),a("div",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._offlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{attrs:{title:i.name+e.$translateTitle("home.Last online Time")+i.updatedAt},on:{click:function(t){return e.showInfo(i.objectId)}}},[e._v(" "+e._s(i.name)+" ")])]}}])})],1)],1)])],1)],1)])],1)]),a("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_online"),name:"third"}},[a("div",{staticClass:"box-card"},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-badge",{staticClass:"item",attrs:{value:e._dev_online_count}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_online")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_online"))+" ")])],1)],1),a("div",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._onlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{attrs:{title:i.name+e.$translateTitle("home.Last online Time")+i.updatedAt},on:{click:function(t){return e.showInfo(i.objectId)}}},[e._v(" "+e._s(i.name)+" ")])]}}])})],1)],1)])],1)],1)])],1)])],1)],1)])],1)],1)],1)])},o=[],r=a("fdeb"),s=a.n(r),l=a("327b"),n=a.n(l),c=a("1285"),d=a("5880"),p=a("bc35"),u=a("bb22"),m=a("ed08"),h=a("c4e6"),g=a("22f9"),b=a("cb88"),f=Object.defineProperty,v=Object.defineProperties,y=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,C=(e,t,a)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,k=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&C(e,a,t[a]);if(_)for(var a of _(t))T.call(t,a)&&C(e,a,t[a]);return e},x=(e,t)=>v(e,y(t)),S=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});window.dgiot.dgiotEnv=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});var I={name:"Home",components:{BmPointCollection:b["BmPointCollection"],BmInfoWindow:b["BmInfoWindow"],info:h["default"],BmScale:b["BmScale"],BmMapType:b["BmMapType"],BmOverviewMap:b["BmOverviewMap"],BmPanorama:b["BmPanorama"],BmControl:b["BmControl"],BmLabel:b["BmLabel"],BaiduMap:b["BaiduMap"],BmNavigation:b["BmNavigation"],BmGeolocation:b["BmGeolocation"],BmCityList:b["BmCityList"],BmMarker:b["BmMarker"],BmlMarkerClusterer:b["BmlMarkerClusterer"]},data(){return this.chartSettings={radius:[5,40],offsetY:100},this.chartExtend={yAxisType:["percent"],tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"}},{queryParams:{},mapHeight:"800px",mapWidth:"800px",polyline:{editing:!1,paths:[]},list:{toolbar:!1,latitude:"31.551162",longitude:"120.260545",zoom:15},mapType:"baidu",isShow:!0,ak:this.$dgiot.secret.baidu.map,center:{lng:120.260545,lat:31.551162},icoPath:{icoPath1:s.a,icoPath2:n.a},router:"",loadingConfig:{product_count:!1,app_count:!1,device_count:!1,warn_count:!1},warnCount:0,count:0,productIco:"",ChartStatus:{columns:["状态","数量"],rows:[{"状态":"在线","数量":0},{"状态":"离线","数量":0}]},clientId:"dgiot_clientId_",infoWindow:{show:!0,contents:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."},loading:!0,marker:{},deviceFlag:!1,deviceInfo:{detail:{}},Product:[],imgurl:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",subtopic:"",isConnect:!1,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20,workGroupName:"",workGroupTreeShow:!1,access_token:""},roleProps:{children:"children",label:"name"},leftWidth:"",cardHeight:"",fixedPaddingTop:"",curDepartmentId:"",leftRow:24,treeDataValue:"",deptTreeData:[],show:!1,sizeZoom:5,tableData:[],offlineData:[],onlineData:[],chartSetting:{yAxis:{type:"value",minInterval:1}},msgtopic:"",NODE_ENV:"production",category:[],activeName:"second",filterBox:"filterBox-first",project_count:0,app_count:0,product_count:0,dev_count:0,active:!1,dev_active_count:0,dev_online_count:0,dev_off_count:0,projectList:[],formInline:{starttime:"",project:""}}},computed:k({},Object(d["mapGetters"])({objectId:"user/objectId",roleTree:"user/roleTree",collapse:"settings/collapse",_Product:"user/_Product",language:"settings/language",_dev_count:"dashboard/_dev_count",_project_count:"dashboard/_project_count",_app_count:"dashboard/_app_count",_product_count:"dashboard/_product_count",token:"user/token",_dev_online_count:"dashboard/_dev_online_count",_onlineData:"dashboard/_onlineData",_dev_off_count:"dashboard/_dev_off_count",_offlineData:"dashboard/_offlineData",_ChartStatus:"dashboard/_ChartStatus",_tableData:"dashboard/_tableData",_pcimg:"dashboard/_pcimg",_role:"acl/role",_mimg:"dashboard/_mimg",mqttInfo:"mqttDB/mqttInfo",treeFlag:"settings/treeFlag"})),watch:{treeFlag:{handler:function(e){this.mapWidth=e?.77*window.innerWidth+"px":.98*window.innerWidth+"px"},deep:!0,limit:!0},sizeZoom:{handler:function(e){console.log("当前sizeZoom 为 "+e)},deep:!0,limit:!0}},mounted(){window.bh="",window.kd="",this.initMapHeight(),this.router=this.$dgiotBus.router(this.$route.fullPath),this.$dgiotBus.$off("qqMapClcik"),this.$dgiotBus.$on("qqMapClcik",e=>{console.log(e)}),this.queryForm.account="zh"==this.language?"全部产品":"All Products",this.initDgiotMqtt(),window.onresize=()=>(()=>{this.mapHeight=.8*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px"})()},beforeDestroy(){return S(this,null,(function*(){}))},activated(){this.resizeTheChart()},destroyed(){this.resizeTheChart()},methods:x(k({initMapHeight(){return S(this,null,(function*(){this.mapHeight=.7*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px"}))},handler({BMap:e,map:t}){console.log(e,t)},getPosition(e){return e.forEach(e=>{e.lng=e.location.longitude,e.lat=e.location.latitude}),console.log(e),e},initDgiotMqtt(){this.$nextTick(()=>S(this,null,(function*(){yield this.queryData(),yield this.setTreeFlag(!0)})))},getWarnCount(){return S(this,arguments,(function*(e={count:"objectId",where:{}}){e.where["createdAt"]={$gt:{__type:"Date",iso:moment().subtract(1,"days").format("YYYY-MM-DD")}},e.where["updatedAt"]={$lt:{__type:"Date",iso:moment(new Date).format("YYYY-MM-DD")}};try{const{count:t=0}=yield this.$query_object("Maintenance",e);this.warnCount=t}catch(t){this.$baseMessage(""+t,"error","dgiot-hey-message-error")}}))},toggleFull(e){this.count++,this.count%2==0?this.$exitFull("baidu_map"):this.$beFull("baidu_map")},resizeTheChart(){this.loading=!0;let e=this.$refs["charts"];e&&(e.$children[0].resize(),setTimeout(()=>{this.loading=!1},2e3))},tableRowClassName({row:e,rowIndex:t}){return 1===t?"warning-row":2===t?"success-row":""}},Object(d["mapMutations"])({setTreeFlag:"settings/setTreeFlag",resaveMqttInfo:"mqttDB/resaveMqttInfo",set_Product:"user/set_Product",set_dev_count:"dashboard/set_dev_count",set_project_count:"dashboard/set_project_count",set_app_count:"dashboard/set_app_count",set_product_count:"dashboard/set_product_count",set_dev_online_count:"dashboard/set_dev_online_count",set_onlineData:"dashboard/set_onlineData",set_dev_off_count:"dashboard/set_dev_off_count",set_offlineData:"dashboard/set_offlineData",set_ChartStatus:"dashboard/set_ChartStatus",set_tableData:"dashboard/set_tableData"})),{deviceToDetail(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.objectId,nodeType:"2",ischildren:"false"}})},getCategory(e){let t="";return this.category.filter(a=>{a.type==e&&(t=a.data.CategoryName)}),t},closeInfo(e,t){},showDeatils(e,t){return S(this,null,(function*(){}))},showInfo(e){return S(this,null,(function*(){this.deviceInfo=yield Object(c["getDevice"])(e);let t=this.deviceInfo.product.objectId||"undefined",a=this.deviceInfo.devaddr||"undefined",i=[{topic:`thing/${t}/${a}/post`,type:"pub",desc:"设备上报",isdef:!0},{topic:`thing/${t}/${a}`,type:"sub",desc:"消息下发",isdef:!0}];this.deviceInfo.product.topics?this.deviceInfo.topicData=this.deviceInfo.product.topics.concat(i):this.deviceInfo.topicData=i,this.deviceFlag=!0}))},mqttMsg(e){let t=Object(m["isBase64"])(e)?Base64.decode(e):e;console.log(t,"收到消息");let a=JSON.parse(t).value,i=JSON.parse(t).vuekey;switch(i){case"app_count":this.app_count=a.count,this.set_app_count(this.app_count);break;case"project_count":this.project_count=a.count,this.set_project_count(this.project_count);break;case"product_count":this.product_count=a.count,this.set_product_count(this.product_count),this.Product=a.results;break;case"dev_online_count":this.dev_online_count=a.count,this.set_dev_online_count(this.dev_online_count),this.onlineData=a.results,this.set_onlineData(this.onlineData);break;case"dev_off_count":console.error(a,"mqttMsgValue"),this.dev_off_count=a.count,this.offlineData=a.results,this.set_dev_off_count(this.dev_off_count),this.set_offlineData(this.offlineData);break;case"warn_count":this.warnCount=a.count;break;case"ChartStatus":this.ChartStatus=a.chartData,this.set_ChartStatus(this.ChartStatus),this.resizeTheChart(),this.$forceUpdate();break;case"baiduMap":this.tableData=a,this.tableData.forEach(e=>{e.show=!1,e.color="0"===e.icon?"yellow":"1"===e.icon?"blue":"red"}),this.set_tableData(this.tableData),this.$forceUpdate();break;case"device_count":this.dev_count=a.count,this.set_dev_count(this.dev_count);break;default:break}this.$forceUpdate()},toggleCard(e){"0px"!=e?($(".map_card").css({height:"0px"}),this.cardHeight="0px"):($(".map_card").css({height:"98px"}),this.cardHeight="98px")},toggleLeftWidth(e){"0px"!=e?($(".dgiot-side-bar").css({width:"0px"}),$(".dgiot-main").css({"margin-left":"0px"}),this.leftWidth="0px"):($(".dgiot-side-bar").css({width:"200px"}),$(".dgiot-main").css({"margin-left":"200px"}),this.leftWidth="200px")},selectProdChange(e){},queryData(){return S(this,null,(function*(){const{dashboard:e={}}=yield Object(g["getDlinkJson"])("Dashboard");this.queryParams=e,setTimeout(()=>{this.queryParams.forEach(e=>{let t=e.vuekey;this.loadingConfig[""+t]=!0})},1240);const t="32511dbfe5";yield Object(u["Startdashboard"])(this.queryParams,t),this.$dgiotBus.$on(this.$dgiotBus.getTopicKeyBypage("dashboard"),e=>{const{payloadString:t}=e;console.log("home page topic data",t),console.log(e),this.mqttMsg(t)}),this.$nextTick(()=>{if("tencent"==this.mapType&&(this.setTreeFlag(!1),this.$refs.qqmap.$children[0].qqmap)){console.clear(),console.error(this.$refs.qqmap.$children[0]," this.$refs.qqmap.$children[0].qqmap"),document.querySelector(".lngTips").style.display="none",window.qq.maps.event.addListener(this.$refs.qqmap.$children[0].qqmap,"mousemove",(function(e){document.querySelector(".lngTips").style.display="none"}));var e=new window.qq.maps.LatLng(28.475997,121.331121),t=new qq.maps.InfoWindow({map:this.$refs.qqmap.$children[0].qqmap,position:e,content:'<div><h3>国家水泵产品质量检验中心(浙江)\n</h3><p>浙江省台州市温岭市迎宾大道温岭市泵业创新服务综合体\n</p><img class="pic" style="width:320px" src="https://sv6.map.qq.com/mmthumb?svid=18091033131005101120600&amp;from=web"></div>'});t.open(),this.$refs.qqmap.$children[0].qqmap.setZoom(18)}})}))},getProduct(){return S(this,null,(function*(){const{results:e}=yield queryProduct({count:"objectId",order:"-updatedAt",keys:"name,icon",where:{}});e.unshift({name:"zh"==this.language?"全部产品":"All Products",objectId:"0"}),this.set_Product(e)}))},change(e){e&&$(".el-tree").css({height:"100px",display:"block","overflow-x":"auto"})},handleNodeClick(e,t){return S(this,null,(function*(){const a=this._role.map(e=>e.name);if($(".el-tree").css({height:"0px",display:"none","overflow-x":"auto"}),$(".el-select-dropdown").css({display:"none"}),this.queryForm.workGroupName=e.label,this.treeDataValue=e.label,a.includes(e.name))this.queryForm.access_token=this.token;else if(1!=t.level){const{access_token:t=""}=yield Object(p["getToken"])(e.name);this.queryForm.access_token=t}else this.queryForm.access_token=this.token;this.queryForm.workGroupTreeShow=!this.queryForm.workGroupTreeShow;const{name:i,objectId:o}=e;this.curDepartmentId=o}))},handleChange(){},handleClickVisit(e){this.$router.push({path:"/Topo",query:{productid:e.objectId}})},goDevice(e){var t;this.$router.push({path:"/dashboard/device",query:{product:e}}),console.log(window.errRoute),(null==(t=null==window?void 0:window.errRoute)?void 0:t.name)&&this.$router.push({path:"/dashboard/devicelist",query:{product:e}})},_goDevice(e){var t;this.$router.push({path:"dashboard/device",query:{devicename:e.name}}),console.log(window.errRoute),(null==(t=null==window?void 0:window.errRoute)?void 0:t.name)&&this.$router.push({path:"/dashboard/devicelist",query:{devicename:e.name}})},goLink(e,t){var a;switch(e){case"real-time":this.$router.push({path:"/roles/editdevices",query:{deviceid:this.deviceInfo.objectId,nodeType:2,ischildren:"false"}});break;case"konva":this.$router.push({path:"/Topo",query:{productid:this.deviceInfo.product.objectId,devaddr:this.deviceInfo.devaddr,deviceid:this.deviceInfo.objectId,type:"device"}});break;case"video":const{basedata:e}=this.deviceInfo;if(!(null==(a=null==e?void 0:e.videoSrc)?void 0:a.length))return this.$baseMessage(this.$translateTitle("equipment.The device is not bound to the video address yet"),"info","dgiot-hey-message-error"),!1;this.$router.push({path:"/Tools/player",query:{type:e.videoType||"m3u8",url:e.videoSrc}});break}},Gotoproduct(e){this.$router.push({path:"/dashboard/productlist",query:{project:e}})}})},P=I,j=(a("f1e8"),a("2877")),D=Object(j["a"])(P,i,o,!1,null,"29cfecba",null);t["default"]=D.exports},"20fc":function(e,t,a){"use strict";a("ea58")},"2b83a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devproduct devproduct-container"},[a("input",{ref:"uploader",staticStyle:{display:"none"},attrs:{accept:"zip",type:"file"},on:{change:function(t){return e.doUpload(t)}}}),a("el-dialog",{staticStyle:{margin:"0 auto"},attrs:{"append-to-body":!0,visible:e.dialogVisible,top:"1vh",width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t}}}),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.parserView},on:{"update:visible":function(t){e.parserView=t}}},[a("f-render",{attrs:{config:e.formConfig,pure:""},model:{value:e.formConfig,callback:function(t){e.formConfig=t},expression:"formConfig"}})],1),a("el-dialog",{staticClass:"parserTable",attrs:{"append-to-body":!0,visible:e.parserTable},on:{"update:visible":function(t){e.parserTable=t}}},[a("div",{staticClass:"header-title parserTable",attrs:{slot:"title"},slot:"title"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.addParse(e.parserTableList)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),a("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return t.preventDefault(),e.saveParse(e.parserTableList)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.parserTableList.parser,height:e.height}},[a("el-table-column",{attrs:{label:e.$translateTitle("product.chinesetitle"),align:"center",prop:"name",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("product.englishtitle"),align:"center",prop:"enname",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("leftbar.settings"),align:"center","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,o=t.$index;return[a("el-button",{attrs:{plain:"",type:"primary"},on:{click:function(t){return e.editParse(o,i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")]),a("el-button",{attrs:{plain:"",type:"success"},on:{click:function(t){return e.previewParse(i.config)}}},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")]),a("el-button",{attrs:{plain:"",size:"small",type:"danger"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteParse(o,e.parserTableList.parser)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1)],1),a("dgiot-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),a("div",{staticClass:"prosecond"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("product.searchproductname"),clearable:""},model:{value:e.formInline.productname,callback:function(t){e.$set(e.formInline,"productname",t)},expression:"formInline.productname"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.searchProduct(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addproduct.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.createproduct"))+" ")])],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.exportpro.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.exportpro"))+" ")])],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.handleImport()}}},[e._v(" "+e._s(e.$translateTitle("product.importpro"))+" ")])],1)],1),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"box-card",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),gutter:20}},e._l(e.proTableData,(function(t,i){return a("el-col",{key:i,attrs:{lg:6,md:8,sm:12,xl:6,xs:24}},[a("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{hoverable:""},scopedSlots:e._u([{key:"actions",fn:function(){return[a("el-row",{attrs:{gutter:24}},[a("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{offset:2,span:2}},[a("a-icon",{staticStyle:{"font-size":"28px"},attrs:{type:"eye",title:"产品详情"},nativeOn:{click:function(a){return e.deviceToDetail(t)}}})],1),a("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{span:2}},[a("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"book",title:e.$translateTitle("product.dict")},nativeOn:{click:function(a){return e.editorDict(t.objectId)}}})],1),a("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{span:2}},[a("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"video-camera",title:e.$translateTitle("concentrator.konva")},nativeOn:{click:function(a){return e.goKonva(t.objectId)}}})],1),a("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{offset:1,span:1}},[a("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"edit",title:e.$translateTitle("button.edit")},nativeOn:{click:function(a){return e.editorProduct(t.objectId)}}})],1),a("el-col",{staticStyle:{margin:"0 auto","text-align":"center"},attrs:{span:3}},[a("a-icon",{staticStyle:{"font-size":"24px"},attrs:{type:"delete",title:e.$translateTitle("button.Delete")},nativeOn:{click:function(a){return e.makeSure(t,i)}}})],1)],1)]},proxy:!0}],null,!0)},[a("a-card-meta",{attrs:{title:t.name,description:t.desc},nativeOn:{click:function(a){return e.deviceToDetail(t)}},scopedSlots:e._u([{key:"avatar",fn:function(){return[a("el-image",{key:t.icon+t.objectId,staticStyle:{height:"40px"},attrs:{src:e.$FileServe+t.icon,"preview-src-list":[e.$FileServe+t.icon]}},[a("div",{staticClass:"image-slot",staticStyle:{"text-align":"center"},attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"40px","text-align":"center"}})])]),a("br"),e._v(" "+e._s(t.objectId)+" ")]},proxy:!0}],null,!0)}),a("el-descriptions",{attrs:{column:4,size:"medium",direction:"vertical",border:""}},[a("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("home.dev_online"),title:t.objectId}},[a("el-link",{attrs:{type:"success"},nativeOn:{click:function(a){return e.goLink(t,"online")}}},[e._v(" "+e._s(t.online_counts||0)+" ")])],1),a("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("home.dev_unline"),title:t.objectId}},[a("el-link",{attrs:{type:"warning"},nativeOn:{click:function(a){return e.goLink(t,"offline")}}},[e._v(" "+e._s(t.offline_counts||0)+" ")])],1),a("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("device.poweron"),title:t.objectId}},[a("el-link",{attrs:{type:"success"},nativeOn:{click:function(a){return e.goLink(t,"poweron")}}},[e._v(" "+e._s(t.poweron_counts||0)+" ")])],1),a("el-descriptions-item",{attrs:{contentStyle:{"text-align":"center"},label:e.$translateTitle("device.poweroff"),title:t.objectId}},[a("el-link",{attrs:{type:"primary"},nativeOn:{click:function(a){return e.goLink(t,"poweroff")}}},[e._v(" "+e._s(t.poweroff_counts||0)+" ")])],1)],1)],1)],1)})),1),a("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageSize,layout:"total, sizes, prev, pager, next, jumper","page-size":e.queryForm.limit,"page-sizes":[8,16,32,64],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("div",{staticClass:"devproduct-prodialog"},[a("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"before-close":e.handleClose,"close-on-click-modal":!1,title:e.moduleTitle,visible:e.dialogFormVisible,"append-to-body":"",size:"50%",top:"5vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-alert",{directives:[{name:"show",rawName:"v-show",value:!e.currentDepartment.name,expression:"!currentDepartment.name"}],attrs:{closable:!1,description:"请先选择部门后,再来新增产品",title:"温馨提示",type:"success"}}),a("div",{staticClass:"devproduct-prodialog-content"},[a("div",{staticClass:"contentone"},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(" "+e._s(e.$translateTitle("product.productinformation"))+" ")]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{key:e.form.type,ref:"form",attrs:{"label-width":"产品名称"==e.$translateTitle("product.productname")?"120px":"160px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"name"}},[a("el-input",{attrs:{disabled:"edit"==e.custom_status,autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.device manufacturer"),prop:"devType"}},[a("el-input",{attrs:{disabled:"edit"==e.custom_status,autocomplete:"off"},model:{value:e.form.devType,callback:function(t){e.$set(e.form,"devType",t)},expression:"form.devType"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.classification"),prop:0==e.form.type?"":"categoryname"}},["edit"!=e.custom_status?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:10}},[a("el-radio-group",{attrs:{disabled:"edit"==e.custom_status},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:1}},[e._v(" "+e._s(e.$translateTitle("product.Standard category"))+" ")]),a("el-radio",{attrs:{label:0}},[e._v(" "+e._s(e.$translateTitle("product.Custom category"))+" ")])],1)],1),1==e.form.type?a("el-col",{staticStyle:{padding:"0"},attrs:{span:13}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.categoryname,callback:function(t){e.$set(e.form,"categoryname",t)},expression:"form.categoryname"}},[a("el-icon",{staticClass:"el-icon-edit el-input__icon",attrs:{slot:"append",size:"mini"},nativeOn:{click:function(t){return e.handlecateClick.apply(null,arguments)}},slot:"append"})],1)],1):e._e()],1):a("span",[e._v(e._s(e.product.category.name))])],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.dynamicregistration"),prop:"netType"}},[a("el-tooltip",{attrs:{content:e.$translateTitle("product.text1"),placement:"top"}},[a("el-switch",{attrs:{"active-text":"开启动态注册","inactive-text":"关闭动态注册","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form.dynamicReg,callback:function(t){e.$set(e.form,"dynamicReg",t)},expression:"form.dynamicReg"}})],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Storage channel"),prop:"tdchannel"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},model:{value:e.form.tdchannel,callback:function(t){e.$set(e.form,"tdchannel",t)},expression:"form.tdchannel"}},e._l(e.tdchannelList,(function(e){return a("el-option",{key:e.objectId,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.taskchannel"),prop:"taskchannel"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},model:{value:e.form.taskchannel,callback:function(t){e.$set(e.form,"taskchannel",t)},expression:"form.taskchannel"}},e._l(e.taskchannelList,(function(e){return a("el-option",{key:e.objectId,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Acquisition channel"),prop:"otherchannel"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select"),"value-key":"objectId"},model:{value:e.form.otherchannel,callback:function(t){e.$set(e.form,"otherchannel",t)},expression:"form.otherchannel"}},e._l(e.otherchannelList,(function(e){return a("el-option",{key:e.objectId,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"edit"!=e.custom_status,expression:"custom_status != 'edit'"}],attrs:{label:e.$translateTitle("product.Current department"),prop:"edit"!=e.custom_status?"relationApp":""}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.Current department"),readonly:""},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.nodetype"),prop:"nodeType"}},[a("el-radio-group",{model:{value:e.form.nodeType,callback:function(t){e.$set(e.form,"nodeType",t)},expression:"form.nodeType"}},[a("el-radio",{attrs:{label:3}},[e._v(" "+e._s(e.$translateTitle("product.direct"))+" ")]),a("el-radio",{attrs:{label:1}},[e._v(" "+e._s(e.$translateTitle("product.gateway"))+" ")]),a("el-radio",{attrs:{label:2}},[e._v(" "+e._s(e.$translateTitle("product.groupgateway"))+" ")]),a("el-radio",{attrs:{label:0}},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")])],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.networking"),prop:"netType"}},[a("el-select",{attrs:{placeholder:e.$translateTitle("product.selectgateway")},model:{value:e.form.netType,callback:function(t){e.$set(e.form,"netType",t)},expression:"form.netType"}},e._l(e.channel,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("menu.icon"),prop:"icon"}},[e.imageUrl?a("div",[a("img",{staticClass:"avatar",attrs:{src:e.$FileServe+e.imageUrl}}),a("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.deleteImgsrc.apply(null,arguments)}}},[e._v(" 删除 ")])],1):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(t){return e.uploadCkick("product_ico")}}}),a("form",{ref:"uploadform",staticStyle:{position:"absolute",visibility:"hidden"},attrs:{enctype:"multipart/form-data",method:"POST"}},[a("input",{staticStyle:{position:"relative","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),a("br")]),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),a("div",{staticClass:"devproduct-prodialog-footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),a("el-button",{on:{click:function(t){return e.handleCloseDialogForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1),a("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"append-to-body":!0,visible:e.cascaderDrawer,size:"40%"},on:{"update:visible":function(t){e.cascaderDrawer=t}}},[a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("dgiot-query-form",[a("dgiot-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},on:{change:e.handleCateSearch},model:{value:e.queryForm.category,callback:function(t){e.$set(e.queryForm,"category",t)},expression:"queryForm.category"}},e._l(e.categoryList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.Templatename")}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入模板名称"},model:{value:e.v.name,callback:function(t){e.$set(e.v,"name",t)},expression:"v.name"}})],1),a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{staticClass:"el-icon-search",attrs:{"native-type":"submit",type:"primary"},on:{click:function(t){return e.queryprodut({})}}})],1)],1)],1)],1),a("el-table",{attrs:{data:e.tableData}},[a("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":"",sortable:"",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"名称","show-overflow-tooltip":"",sortable:"",prop:"name",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:"id","show-overflow-tooltip":"",sortable:"",width:"auto",prop:"objectId"}}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作","show-overflow-tooltip":"",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",type:"info"},on:{click:function(t){return e.chooseTemplate(i)}}},[e._v(" 选择 ")])]}}])})],1)],1)],1),a("el-pagination",{attrs:{background:"","current-page":e.v.size,layout:e.v.layout,"page-size":e.v.limit,total:e.v.total},on:{"current-change":e.vhandleCurrentChange,"size-change":e.vhandleSizeChange}})],1)])],1),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogProfile,top:"1vh"},on:{"update:visible":function(t){e.dialogProfile=t}}},[a("dgiot-profile",{ref:"dialogProfile",attrs:{"is-product":!0}})],1),e.dictVisible?a("a-drawer",{staticStyle:{"z-index":"999"},attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.title_temp_dialog,visible:e.dictVisible,width:"60%"},on:{close:function(t){e.dictVisible=!e.dictVisible}}},[a("el-form",{ref:"dictTempForm",attrs:{model:e.dictTempForm,rules:e.rule,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"字典模板名称",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.name,callback:function(t){e.$set(e.dictTempForm,"name",t)},expression:"dictTempForm.name"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"字典模板状态",prop:"enable"}},[a("el-radio",{attrs:{border:"",label:"1"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" 启用 ")]),a("el-radio",{attrs:{border:"",label:"0"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" 禁用 ")])],1)],1)],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"字典模板数据"}},[a("el-tabs",{model:{value:e.elactiveName,callback:function(t){e.elactiveName=t},expression:"elactiveName"}},[a("el-tab-pane",{attrs:{label:"Table",name:"Table"}},[a("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"small",type:"primary"},nativeOn:{click:function(t){return e.addRow(e.dictTempForm.params)}}},[e._v(" 新 增 ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.dictTempForm.params}},[a("el-table-column",{attrs:{label:"序号",prop:"order"}}),a("el-table-column",{attrs:{label:"标识符",prop:"identifier"}}),a("el-table-column",{attrs:{label:"功能名称",prop:"name"}}),a("el-table-column",{attrs:{label:"数据类型",prop:"type"}}),a("el-table-column",{attrs:{label:"数据地址",prop:"address"}}),a("el-table-column",{attrs:{label:"数据长度",prop:"bytes"}}),a("el-table-column",{attrs:{label:"是否必填",prop:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.required?a("span",[e._v("是")]):a("span",[e._v("否")])]}}],null,!1,2053984958)}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,o=t.$index;return[a("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.delRow(o,i)}}},[e._v(" 删除 ")]),a("el-button",{attrs:{plain:"",size:"mini",title:"编辑",type:"info"},nativeOn:{click:function(t){return e.editRow(o,i)}}},[e._v(" 编辑 ")])]}}],null,!1,3125019904)})],1)],1)],1)],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"描述"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},placeholder:"请输入描述",type:"textarea"},model:{value:e.dictTempForm.description,callback:function(t){e.$set(e.dictTempForm,"description",t)},expression:"dictTempForm.description"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.onJsonSave("dictTempForm")}}},[e._v(" 提交 ")]),a("el-button",{on:{click:function(t){e.dictVisible=!1}}},[e._v("取消")])],1)],1)],1):e._e(),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.closeDict,"close-on-click-modal":!1,title:e.title_dict_edit_dialog,visible:e.edit_dict_temp_dialog,top:"5vh",width:"60%"},on:{"update:visible":function(t){e.edit_dict_temp_dialog=t},open:function(t){return e.opendialog("tempparams")}}},[a("el-form",{ref:"tempparams",attrs:{model:e.tempparams,"label-position":"left","label-width":"100px",size:"mini"}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"序号",prop:"order"}},[a("el-input",{model:{value:e.tempparams.order,callback:function(t){e.$set(e.tempparams,"order",e._n(t))},expression:"tempparams.order"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[a("el-input",{model:{value:e.tempparams.identifier,callback:function(t){e.$set(e.tempparams,"identifier",t)},expression:"tempparams.identifier"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.functionname"),prop:"name"}},[a("el-input",{model:{value:e.tempparams.name,callback:function(t){e.$set(e.tempparams,"name",t)},expression:"tempparams.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.datatype"),prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.tempTypeChange},model:{value:e.tempparams.type,callback:function(t){e.$set(e.tempparams,"type",t)},expression:"tempparams.type"}},[a("el-option",{attrs:{label:e.$translateTitle("product.init"),value:"int"}}),a("el-option",{attrs:{label:e.$translateTitle("product.float"),value:"float"}}),a("el-option",{attrs:{label:e.$translateTitle("product.double"),value:"double"}}),a("el-option",{attrs:{label:e.$translateTitle("product.bool"),value:"bool"}}),a("el-option",{attrs:{label:e.$translateTitle("product.enum"),value:"enum"}}),a("el-option",{attrs:{label:e.$translateTitle("product.string"),value:"string"}}),a("el-option",{attrs:{label:"switch",value:"switch"}})],1)],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.unit")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("product.unit"),filterable:""},model:{value:e.tempparams.unit,callback:function(t){e.$set(e.tempparams,"unit",t)},expression:"tempparams.unit"}},e._l(e.allunit,(function(e,t){return a("el-option",{key:t,attrs:{label:e.Name+"/"+e.Symbol,value:e.Symbol}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"协议类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.protocol,callback:function(t){e.$set(e.tempparams,"protocol",t)},expression:"tempparams.protocol"}},e._l(["normal","modbus","GW376","hex"],(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.tempparams.protocol,expression:"tempparams.protocol == 'modbus'"}],attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据格式"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.originaltype,callback:function(t){e.$set(e.tempparams,"originaltype",t)},expression:"tempparams.originaltype"}},e._l([{value:"bit",label:"位"},{value:"short16_AB",label:"16位 有符号(AB)"},{value:"short16_BA",label:"16位 有符号(BA)"},{value:"ushort16_AB",label:"16位 无符号(AB)"},{value:"ushort16_BA",label:"16位 无符号(BA)"},{value:"long32_ABCD",label:"32位 有符号(ABCD)"},{value:"long32_CDAB",label:"32位 有符号(CDAB)"},{value:"ulong32_ABCD",label:"32位 无符号(ABCD)"},{value:"ulong32_CDAB",label:"32位 无符号(CDAB)"},{value:"float32_ABCD",label:"32位 浮点数(ABCD)"},{value:"float32_CDAB",label:"32位 浮点数(CDAB)"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.tempparams.protocol,expression:"tempparams.protocol == 'modbus'"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",size:"small"}},[a("el-table-column",{attrs:{align:"center",label:"从机地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.slaveid,callback:function(t){e.$set(e.tempparams,"slaveid",t)},expression:"tempparams.slaveid"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"寄存器状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.operatetype,callback:function(t){e.$set(e.tempparams,"operatetype",t)},expression:"tempparams.operatetype"}},e._l([{value:"writeCoil",label:"0X05:写单个线圈寄存器"},{value:"writeHreg",label:"0X06:写单个保持寄存器"},{value:"writeCoils",label:"0X0f:写多个线圈寄存器"},{value:"writeHregs",label:"0X10:写多个保持寄存器"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i.slaveid))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"数据地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.address,callback:function(t){e.$set(e.tempparams,"address",t)},expression:"tempparams.address"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i.slaveid))])]}}])}),"writeCoils"==e.tempparams.operatetype||"writeHregs"==e.tempparams.operatetype?a("el-table-column",{attrs:{align:"center",label:"寄存器个数","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.registersnumber,callback:function(t){e.$set(e.tempparams,"registersnumber",t)},expression:"tempparams.registersnumber"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i.slaveid))])]}}],null,!1,713879905)}):e._e(),a("el-table-column",{attrs:{align:"center",label:"写入字节数","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",t)},expression:"tempparams.bytes"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i.slaveid))])]}}])})],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:"GW376"==e.tempparams.protocol,expression:"tempparams.protocol == 'GW376'"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",size:"small"}},[a("el-table-column",{attrs:{align:"center",label:"应用层功能码","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.afn,callback:function(t){e.$set(e.tempparams,"afn",t)},expression:"tempparams.afn"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"信息点","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.da,callback:function(t){e.$set(e.tempparams,"da",t)},expression:"tempparams.da"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"信息类","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.dt,callback:function(t){e.$set(e.tempparams,"dt",t)},expression:"tempparams.dt"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i.slaveid))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"字节类型","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tempparams.byteType,callback:function(t){e.$set(e.tempparams,"byteType",t)},expression:"tempparams.byteType"}},e._l(["little","bytes","bit"],(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i.slaveid))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"字节长度","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",t)},expression:"tempparams.bytes"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(i.slaveid))])]}}])})],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"!=e.tempparams.protocol&&"GW376"!=e.tempparams.protocol,expression:"\n            tempparams.protocol != 'modbus' && tempparams.protocol != 'GW376'\n          "}],attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据地址"}},[a("el-input",{attrs:{placeholder:"数据地址"},model:{value:e.tempparams.address,callback:function(t){e.$set(e.tempparams,"address",t)},expression:"tempparams.address"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据长度"}},[a("el-input",{attrs:{placeholder:"数据长度（字节）"},model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",e._n(t))},expression:"tempparams.bytes"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 采集值 设备上行数据经采集公式计算后显示 。 "),a("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),a("br"),e._v(" 如： "),a("br"),e._v(" 加：%s+10 "),a("br"),e._v(" 减：%s-10 "),a("br"),e._v(" 乘：%s*10 "),a("br"),e._v(" 除：%s/10 "),a("br"),e._v(" 余数：%s%10 "),a("br")]),a("i",{staticClass:"el-icon-question"})]),a("el-form-item",{attrs:{label:"采集公式"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{rows:1,type:"textarea"},model:{value:e.tempparams.collection,callback:function(t){e.$set(e.tempparams,"collection",t)},expression:"tempparams.collection"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 设置值 平台下行数据经设置公式计算后设置 。 "),a("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),a("br"),e._v(" 如： "),a("br"),e._v(" 加：%s+10 "),a("br"),e._v(" 减：%s-10 "),a("br"),e._v(" 乘：%s*10 "),a("br"),e._v(" 除：%s/10 "),a("br"),e._v(" 余数：%s%10 "),a("br")]),a("i",{staticClass:"el-icon-question"})]),a("el-form-item",{attrs:{label:"设置公式"}},[a("el-input",{attrs:{rows:1,type:"textarea"},model:{value:e.tempparams.setting,callback:function(t){e.$set(e.tempparams,"setting",t)},expression:"tempparams.setting"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"必填"}},[a("el-radio",{attrs:{label:!0,border:""},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" 是 ")]),a("el-radio",{attrs:{label:!1,border:""},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" 否 ")])],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"只读"}},[a("el-radio",{attrs:{label:!0,border:""},model:{value:e.tempparams.readonly,callback:function(t){e.$set(e.tempparams,"readonly",t)},expression:"tempparams.readonly"}},[e._v(" 是 ")]),a("el-radio",{attrs:{label:!1,border:""},model:{value:e.tempparams.readonly,callback:function(t){e.$set(e.tempparams,"readonly",t)},expression:"tempparams.readonly"}},[e._v(" 否 ")])],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"列表显示"}},[a("el-radio",{attrs:{label:!0,border:""},model:{value:e.tempparams.isshow,callback:function(t){e.$set(e.tempparams,"isshow",t)},expression:"tempparams.isshow"}},[e._v(" 是 ")]),a("el-radio",{attrs:{label:!1,border:""},model:{value:e.tempparams.isshow,callback:function(t){e.$set(e.tempparams,"isshow",t)},expression:"tempparams.isshow"}},[e._v(" 否 ")])],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},["switch"==e.tempparams.type?a("el-form-item",{attrs:{label:"开"}},[a("el-input",{model:{value:e.tempparams.activevalue,callback:function(t){e.$set(e.tempparams,"activevalue",t)},expression:"tempparams.activevalue"}})],1):e._e()],1),a("el-col",{attrs:{span:12}},["switch"==e.tempparams.type?a("el-form-item",{attrs:{label:"关"}},[a("el-input",{model:{value:e.tempparams.inactivevalue,callback:function(t){e.$set(e.tempparams,"inactivevalue",t)},expression:"tempparams.inactivevalue"}})],1):e._e()],1)],1),"enum"!=e.tempparams.type&&"switch"!=e.tempparams.type?a("el-form-item",{attrs:{label:"默认值",prop:"default"}},["bool"==e.tempparams.type?a("el-select",{staticClass:"notauto",attrs:{readonly:""},model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}},[a("el-option",{attrs:{value:!0,label:"是"}}),a("el-option",{attrs:{value:!1,label:"否"}})],1):"int"==e.tempparams.type?a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",e._n(t))},expression:"tempparams.default"}}):a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}})],1):e._e(),"enum"==e.tempparams.type?a("el-form-item",{attrs:{label:"Enum数据"}},[a("el-tabs",{model:{value:e.elactiveName1,callback:function(t){e.elactiveName1=t},expression:"elactiveName1"}},[a("el-tab-pane",{attrs:{label:"Table",name:"Table1"}},[a("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addDomain.apply(null,arguments)}}},[e._v(" 新 增 ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tempparams.specs,height:e.height}},[a("el-table-column",{attrs:{align:"center",label:"属性"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:i.attribute,callback:function(t){e.$set(i,"attribute",t)},expression:"row.attribute"}})]}}],null,!1,145805847)}),a("el-table-column",{attrs:{align:"center",label:"属性值"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-input",{model:{value:i.attributevalue,callback:function(t){e.$set(i,"attributevalue",t)},expression:"row.attributevalue"}})]}}],null,!1,2139517436)}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.removeDomain(i)}}},[e._v(" 删除 ")])]}}],null,!1,1667144408)})],1)],1)],1)],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitFormTempDict()}}},[e._v(" 提交 ")])],1)],1)],1)],1),a("div",{staticClass:"import-dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,visible:e.importDialogShow,title:"导入产品",width:"25%"},on:{"update:visible":function(t){e.importDialogShow=t}}},[a("el-form",{ref:"uploadProForm",attrs:{model:e.formPro}},[a("el-upload",{ref:"fileUpload",staticClass:"upload-demo",attrs:{action:e.uploadAction,"auto-upload":!1,data:e.uploadData,"file-list":e.fileList,headers:e.uploadHeaders,"on-change":e.handleChange,"on-error":e.handleUploadError,"on-success":e.handleUploadSuccess,"with-credentials":!0,accept:".xls, .xlsx, .zip"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" 选泽文件 ")])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-left",attrs:{size:"small",type:"primary"},on:{click:e.submitUpload}},[e._v(" 上 传 ")]),a("el-button",{staticClass:"btn-right",attrs:{size:"small"},on:{click:function(t){e.importDialogShow=!1}}},[e._v(" 取 消 ")])],1)],1)],1)],1)},o=[],r=a("30b0"),s=a("ed08"),l=a("89e8"),n=a("5880"),c=a("7212"),d=a("1285"),p=a("5da9"),u=a("e0e9"),m=a("7497"),h=a("0af3"),g=a("ef68"),b=a("03b1"),f=a("22f9"),v=Object.defineProperty,y=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,C=(e,t,a)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,k=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&C(e,a,t[a]);if(y)for(var a of y(t))T.call(t,a)&&C(e,a,t[a]);return e},x=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});const S=a("6818");let I={};S.keys().forEach(e=>{let t=S(e);I[e.replace(/^\.\/(.*)\.\w+$/,"$1")]=t.default});var P={components:k({"dgiot-profile":r["default"]},I),data(){return{v:{skip:0,layout:"total, sizes, prev, pager, next, jumper",limit:10,name:"",search:"",type:"name"},inputParams:{},storageArr:["默认-行式存储","默认-列式存储","InfluxDB-行式存储","InfluxDB-列式存储","TDEngine-列式存储"],channeltype:"2",channeldialog:!1,channelResource:[],selectedRow:{},tableData:[],product:{},allTemp:[],category:[],descriptions:{tableType:"things",things:[],productId:"",dictTableList:[],decoderTableList:{},productDetail:{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}},parserTableList:[],tableLoading:!1},queryForm:{name:"",category:"",productId:"",productFlag:!1,pageNo:1,pageSize:1,searchDate:[],limit:8,skip:0,total:0,order:"-createdAt",keys:"count(*)"},cascaderDrawer:!1,drawerWidth:Number($(window).width())-240,height:this.$baseTableHeight(0),config:{},dataList:[{}],parserView:!1,parserTable:!1,parserTableList:{parser:[]},parserFromId:"",dialogVisible:!1,moduleTitle:this.$translateTitle("product.createproduct"),allunit:[],productInfo:{},edit_dict_temp_dialog:!1,title_dict_edit_dialog:"新增字典数据",tempparams:{name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,isshow:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},unit:"",inactivevalue:"",activevalue:"",da:"",dt:"",afn:""},tabs:"card",elactiveName:"Table",elactiveName1:"Table1",editDictTempId:"",title_temp_dialog:"",dictTempForm:"",rule:[],dictVisible:!1,listLoading:!1,custom_row:{},custom_status:"add",hashkey:"",length:10,total:0,start:0,activeName:"first",formInline:{productname:""},uploadHeaders:{sessionToken:Cookies.get("access_token")},uploadAction:"",uploadData:{},fileList:[],productIdentifier:"",proTableData:[],formLabelWidth:"120px",dialogFormVisible:!1,importDialogShow:!1,cType:"",form:{dynamicReg:!0,config:{checkList:["konva","amis"]},type:1,storageStrategy:"",name:"",tdchannel:"7b290e5a0a",category:"",taskchannel:"6c48effac2",otherchannel:"",nodeType:3,desc:"",netType:"",devType:"",categoryid:"",producttempid:"",productSecret:"",roles:[],relationApp:""},taskchannelList:[],tdchannelList:[],otherchannelList:[],formPro:{name:"",url:""},rules:{name:[{required:!0,message:"请输入产品",trigger:"blur"}],tdchannel:[{required:!0,message:"请选择存储通道",trigger:"blur"}],storageStrategy:[{required:!0,message:"请选择存储策略",trigger:"blur"}],taskchannel:[{required:!0,message:"请选择任务通道",trigger:"blur"}],otherchannel:[{required:!0,message:"请选择采集通道",trigger:"blur"}],devType:[{required:!0,message:"请输入设备厂家",trigger:"blur"}],categoryname:[{required:!0,message:"请选择所属分类",trigger:"change"}],nodeType:[{required:!0,message:"请选择节点类型",trigger:"change"}],netType:[{required:!0,message:"请选择联网方式",trigger:"change"}],relationApp:[{required:!0,message:"请选择产品可见角色",trigger:"change"}]},option:[],ruleoptions:[],channel:[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道(直连)",value:"5G"},{label:"WIFI通道(直连)",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"Modbus",value:"Modbus"},{label:"LoRa(WAN)(直连)",value:"LoRaWAN"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接(直连)",value:"网线连接"},{label:"自定义",value:"OTHER"}],dialogProfile:!1,imageUrl:"",selectfromtype:"",productid:"",parserDict:[],formConfig:{},editIndex:0,Parserzh:"",parseren:"",loading:!1,categoryList:[],fileServer:"",access_token:"",projectid:"",projectName:"",allTableDate:[],showTree:!1,showcateTree:!1,multipleSelection:[]}},computed:k({},Object(n["mapGetters"])({defaultKonva:"topo/defaultKonva",token:"user/token",currentDepartment:"user/currentDepartment"})),mounted(){this.categorytree(),this.getAllunit();const{project:e=""}=this.$route.query;this.formInline.productname=e,this.searchProduct(0)},beforeDestroy(){this.projectName=""},methods:{vhandleSizeChange(e){this.v.limit=e,this.queryprodut()},vhandleCurrentChange(e){this.v.skip=Number(e-1)*Number(this.queryForm.limit),this.queryprodut()},handleQuery(){this.v.limit=20,this.queryprodut()},goLink(e,t){switch(t){case"online":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,status:"ONLINE"}});break;case"offline":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,status:"OFFLINE"}});break;case"poweron":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,isEnable:!0}});break;case"poweroff":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId,isEnable:!1}});break;case"device":this.$router.push({path:"/dashboard/devicelist",query:{product:e.objectId}});break}console.log(e,t)},handleSizeChange(e){this.queryForm.limit=e,this.searchProduct()},handleCurrentChange(e){this.queryForm.skip=Number(e-1)*Number(this.queryForm.limit),this.searchProduct()},handleIconClick(e){return x(this,null,(function*(){this.dialogProfile=!this.dialogProfile,yield this.$refs.dialogProfile.StepsListRowClick(this.selectedRow)}))},handlecateClick(){this.categorytree(),this.cascaderDrawer=!0},handleSelectionChange(e){this.multipleSelection=e;let t=[];dgiotlog.log("multipleSelection",this.multipleSelection,this.selectfromtype),_.isObject(e)||e.forEach(e=>{t.push(e.objectId)}),"otherchannel"==this.selectfromtype?this.form[this.selectfromtype]=t:(dgiotlog.log(this.cType),this.form[this.selectfromtype]=e.objectId),dgiotlog.log("multipleSelection",this.form)},getResource(e,t,a){return x(this,null,(function*(){this.cType=a,this.selectfromtype=e,this.channeltype=t}))},getChannel(e,t,a){let i={};return i=""==a?e.filter((function(e){return e.type==t})):e.filter((function(e){return e.type==t&&e.cType==a})),i},Get_Re_Channel(){return x(this,null,(function*(){const e={count:"objectId",order:"-createdAt",keys:"count(*)",where:{}},{results:t}=yield Object(l["queryChannel"])(e);this.channelResource=t,this.taskchannelList=this.getChannel(t,"2","INSTRUCT"),this.tdchannelList=this.getChannel(t,"2","TD"),this.otherchannelList=this.getChannel(t,"1","")}))},referenceHandle(e){return x(this,null,(function*(){yield this.$refs.profile.StepsListRowClick(e)}))},queryprodut(e){return x(this,null,(function*(){let t={skip:this.v.skip,limit:this.v.limit,include:"category",count:"objectId",where:{}};this.v.name&&(t.where.name={$regex:this.v.name}),(null==e?void 0:e.categorys)&&(t.where.category={$in:e.categorys}),console.log(t),console.log("params");try{const{results:e=[],count:a=0}=yield Object(g["queryProductTemplet"])(t);this.tableData=e,this.v.total=a}catch(a){dgiotlog.log(a),this.$baseMessage(a,"error","dgiot-hey-message-error")}}))},goKonva(e){this.$router.push({path:"/Topo?productid",query:{productid:e}})},uploadCkick(e){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:"app",path:"product/ico/",filename:`${this.productid}.${e}`}},fileInfo(e){dgiotlog.log("info",e),this.imageUrl=e.path,this.loading=!1},files(e,t){this.inputParams.filename=`${this.productid}.${t}`,this.inputParams.file=e},getAllunit(){return x(this,null,(function*(){this.allunit=[];const{UnifyUnitSpecsDTO:e=[]}=yield Object(f["getDlinkJson"])("Unit");this.allunit=e}))},submitEnum(){"Enum"==this.tempparams.type&&this.tempparams.specs.map(e=>{var t=e["attribute"];this.tempparams.struct[t]=e["attributevalue"]})},addDomain(){this.tempparams.specs.push({attribute:"",attributevalue:""})},removeDomain(e){var t=this.tempparams.specs.indexOf(e);-1!==t&&this.tempparams.specs.splice(t,1)},delRow(e,t){console.log(e,t),this.dictTempForm.params.splice(e,1)},editRow(e,t){this.editIndexId=e,this.title_dict_edit_dialog="修改字典数据",this.edit_dict_temp_dialog=!0,this.tempparams=t},closeDict(){this.edit_dict_temp_dialog=!this.edit_dict_temp_dialog},onJsonSave(e){this.$refs[e].validate(e=>{dgiotlog.log(this.editDictTempId),e&&this.put_Dict_temp(this.editDictTempId,this.dictTempForm)})},put_Dict_temp(e,t){return x(this,null,(function*(){dgiotlog.log(t);const{config:a={basedate:{}}}=this.productInfo;a.basedate=t;const i={config:a},{updatedAt:o}=yield Object(c["putProduct"])(e,i);void 0!=o?(this.dictVisible=!1,this.$message({type:"success",showClose:!0,duration:2e3,message:"字典数据更新成功"})):this.$message({type:"error",showClose:!0,duration:2e3,message:"字典数据更新失败"})}))},submitFormTempDict(){this.submitEnum(),this.edit_dict_temp_dialog=!1,void 0!=this.editIndexId?(this.dictTempForm.params[this.editIndexId]=this.tempparams,this.$message({type:"success",message:"编辑成功",showClose:!0,duration:2e3})):(this.dictTempForm.params.push(this.tempparams),this.$message({type:"success",message:"新增成功",showClose:!0,duration:2e3}))},opendialog(e){this.$nextTick(()=>{this.$refs[e].clearValidate()})},tempTypeChange(e){"bool"==e?(this.tempparams.default=!0,this.tempparams.default=!0):this.tempparams.default="int"==e?0:void 0},addRow(e){this.editIndexId=void 0,this.title_dict_edit_dialog="新增字典数据",this.edit_dict_temp_dialog=!0,this.tempparams={name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,isshow:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},collection:"%s",setting:"%s",unit:""}},onError(){this.$message("非Json数据类型")},selectApp(e){e&&Object(p["getServer"])(e).then(e=>{e&&(this.fileServer=e.file,this.access_token=e.access_token)})},treeData(e){const t=JSON.parse(JSON.stringify(e));return t.filter(e=>{const a=t.filter(t=>e.objectId==t.parent.objectId);return a.length>0&&(e.children=a),0==e.parent.objectId})},deleteImgsrc(){this.imageUrl=""},dataURItoBlob(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);return new Blob([i],{type:a})},submitUpload(){this.uploadAction="/product",this.$nextTick(()=>{this.uploadData.appid=Cookies.get("appids"),this.$refs.fileUpload.submit()})},handleUploadSuccess(e,t,a){this.$message({type:"success",message:"产品导入成功",showClose:!0,duration:2e3}),this.importDialogShow=!1,this.$refs["uploadProForm"].resetFields(),this.searchProduct()},handleUploadError(e,t,a){this.$message({message:e,showClose:!0,duration:2e3})},handleChange(e,t){t.length>0&&(this.fileList=[t[t.length-1]])},utc2beijing(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},searchProduct(e){return x(this,null,(function*(){try{this.listLoading=!0,0==e&&(this.start=0);var t=[];let a={count:"objectId",order:"-updatedAt",skip:this.queryForm.skip,limit:this.queryForm.limit,where:{},excludeKeys:"children,thing,decoder,topics,productSecret,view,category,producttemplet"};this.formInline.productname&&(a.where.name={$regex:this.formInline.productname});const{results:i=[],count:o=0}=yield this.$query_object("Product",a);i&&(i.map(e=>{""!=e.category&&e.category&&"report"!=e.devType&&t.push(e.category)}),this.listLoading=!1,this.proTableData=i,this.total=o)}catch(a){this.listLoading=!1,dgiotlog.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},handleClose(){this.dialogFormVisible=!1},chooseTemplate(e){return x(this,null,(function*(){var t,a;this.selectedRow=e,console.log(e),this.$set(this.form,"categoryid",(null==(t=null==e?void 0:e.category)?void 0:t.objectId)?e.category.objectId:"0"),this.$set(this.form,"categoryname",(null==(a=null==e?void 0:e.category)?void 0:a.name)?e.category.name+"/"+e.name:e.name),this.$set(this.form,"producttempid",e.objectId),this.form.thing=e.thing?e.thing:{},this.cascaderDrawer=!this.cascaderDrawer,console.log("select",e)}))},getcategoryname(e){return x(this,null,(function*(){const{name:t}=yield Object(b["getCategory"])(e.parent.objectId),a="所有领域"==t?e.name:t+"/"+e.name;return a}))},handleCloseDialogForm(){this.dialogFormVisible=!1,this.$nextTick(()=>{this.$refs["form"].resetFields()})},properties(e,t="things"){this.descriptions.tableLoading=!0,dgiotlog.log(e),this.descriptions.things=e,this.descriptions.tableType=t,setTimeout(()=>this.descriptions.tableLoading=!1,1200)},addproduct(){this.Get_Re_Channel(),this.queryprodut({}),this.custom_status="add",this.moduleTitle=this.$translateTitle("product.createproduct"),this.imageUrl="",this.form={dynamicReg:!0,name:"",type:1,category:"",nodeType:3,desc:"",netType:" ",devType:"",productSecret:"",relationApp:this.currentDepartment.name,roles:[],categoryname:"",config:{checkList:["konva","amis"]}},this.productid=moment(new Date).valueOf().toString(),this.dialogFormVisible=!0},getParent(e,t,a){return t.map(i=>{e==i.id?(a.unshift(i.value),this.getParent(i.parentid,t,a)):0==i.parentid&&i.id==e&&a.unshift(i.value)}),this.form.category=a[0],a},getIndustryParent(e,t){t.map(a=>{a.value==e&&this.getParent(a.id,t,[])})},editorParser(e){return x(this,null,(function*(){this.parserFromId=e;try{const{config:t={parser:[]},thing:a={}}=yield Object(c["getProduct"])(e);this.parserTableList=t,dgiotlog.log(this.parserTableList),this.parserDict=_.merge(a,t)}catch(t){this.parserTableList={parser:[]},dgiotlog.log("eeeeeeeeeeeee",t)}this.parserTable=!0}))},editParse(e,t){this.formConfig=t,this.editIndex=e,this.dialogVisible=!0},saveParse(e,t=-1){return x(this,null,(function*(){t+2>0&&(this.parserTableList.parser[t]=_.merge({},e));try{yield Object(c["putProduct"])(this.parserFromId,{config:t+2>0?this.parserTableList:e});this.$message({showClose:!0,message:this.$translateTitle("user.Save the template successfully"),duration:2e3,type:"success"}),this.dialogVisible=!1,this.parserTable=!1}catch(a){this.$baseMessage(this.$translateTitle("user.Save the template error")+""+a,"error","dgiot-hey-message-error"),dgiotlog.log(a,"eeee")}dgiotlog.log(e)}))},previewParse(e){this.parserView=!0,this.formConfig=e,dgiotlog.log("previewParse",e)},addParse(e){e["parser"].push({name:Object(s["uuid"])(6),enname:Object(s["uuid"])(6),config:{}})},deleteParse(e,t){t.splice(e,1)},editorDict(e){return x(this,null,(function*(){this.getAllunit();const t=yield Object(c["getProduct"])(e),{config:a={basedate:{}}}=t;this.productInfo=t,dgiotlog.log(" this.parserDict",this.parserDict),this.editDictTempId=e,this.dictTempForm={name:"",cType:"",enable:"1",description:"",params:[]},this.title_temp_dialog="创建字典模板",dgiotlog.log(a),a.basedate&&a.basedate.name&&(this.title_temp_dialog="修改字典模板",this.dictTempForm=a.basedate),this.rule={name:[{required:!0,message:"请输入字典模板名称",trigger:"blur"}],cType:[{required:!0,message:"请输入字典模板类型",trigger:"blur"}],enable:[{required:!0,message:"请选择状态",trigger:"change"}]},dgiotlog.log(this.dictTempForm,"config"),this.dictVisible=!0}))},editorProduct(e){return x(this,null,(function*(){this.Get_Re_Channel();const t=this.$baseColorfullLoading(),a=yield Object(c["getProduct"])(e);this.form=a,t.close(),this.product=a,this.imageUrl="",this.moduleTitle=this.$translateTitle("product.editproduct"),this.custom_status="edit",this.custom_row=a,this.dialogFormVisible=!0,this.productid=a.objectId,this.form.desc=a.desc,this.form.category=a.category,this.form.producttemplet=a.producttemplet,this.form.config=_.merge(a.config,{checkList:[]}),this.form.name=a.name,this.form.nodeType=a.nodeType,this.form.dynamicReg=a.dynamicReg,this.$set(this.form,"type",a.channel?a.channel.type:""),this.$set(this.form,"tdchannel",a.channel?a.channel.tdchannel:""),this.$set(this.form,"taskchannel",a.channel?a.channel.taskchannel:""),this.$set(this.form,"otherchannel",a.channel?a.channel.otherchannel:""),this.$set(this.form,"storageStrategy",a.channel?a.channel.storageStrategy:""),this.form.netType=a.netType,this.form.devType=a.devType,this.form.categoryname=a.category?a.category.name:"",this.form.productSecret=a.productSecret,this.form.nodeType=a.nodeType,a.icon&&(this.imageUrl=a.icon),console.log("row",a),dgiotlog.log("form",this.form)}))},categorytree(){return x(this,null,(function*(){const e={order:"createdAt",keys:"count(*)",where:{level:{$in:[0,1]}}},{results:t}=yield Object(b["queryCategory"])(e);this.queryprodut({}),this.categoryList=t,dgiotlog.log("this",this.categoryList)}))},handleCateSearch(e){if(this.queryForm.category=e,this.showcateTree=!this.showcateTree,"a60a85475a"==e)this.queryprodut({});else{let t={keys:"objectId",where:{parent:{className:"Category",objectId:e,__type:"Pointer"}}};Object(b["queryCategory"])(t).then(t=>{const a=[];a.push(e),t.results.forEach(e=>{a.push(e.objectId)}),dgiotlog.log("ids",a),this.queryprodut({categorys:a})})}},submitForm(){var e={content:{},profile:{},dynamicReg:this.form.dynamicReg,name:this.form.name,nodeType:this.form.nodeType,netType:this.form.netType,icon:this.imageUrl,devType:this.form.devType,desc:this.form.desc,thing:this.form.thing?this.form.thing:{},category:{objectId:0==Number(this.form.type)?"5ca6049839":this.form.categoryid,__type:"Pointer",className:"Category"},producttemplet:{objectId:0==Number(this.form.type)?"0":this.form.producttempid,__type:"Pointer",className:"ProductTemplet"},channel:{type:this.form.type,tdchannel:this.form.tdchannel,taskchannel:this.form.taskchannel,otherchannel:this.form.otherchannel,storageStrategy:this.form.storageStrategy}};this.$refs.form.validate(t=>{if(t)if("add"===this.custom_status){var a=Math.ceil(25*Math.random()),i=Base64.encode(String.fromCharCode(65+a)+Math.ceil(1e7*Math.random())+Number(new Date));const t="role:"+this.form.relationApp,o={};o[t]={read:!0,write:!0},o["*"]={read:!0},console.clear(),console.log("this.form",this.form),console.log(this.form.config.checkList,"this.form.config.checkList");const r={productSecret:i,ACL:o,topics:{},decoder:{},config:{checkList:this.form.config.checkList}},s=_.merge(e,r);dgiotlog.log("createProduct",s),this.createProduct(s)}else console.log("editProduct",e),delete e.category,delete e.producttemplet,delete e.thing,this.editProduct(e);else this.$message("必填项未填")})},doUpload(e){return x(this,null,(function*(){const t=e.target.files[0],a=this.$baseColorfullLoading(3);try{const e=yield Object(h["ImportParse"])("Product",t);a.close(),dgiotlog.log("eresresrror",e),this.$message({showClose:!0,message:this.$translateTitle("user.Save the template successfully"),duration:2e3,type:"success"})}catch(i){a.close(),dgiotlog.log("error",i),this.$baseMessage(i,"error","dgiot-hey-message-error")}this.$dgiotBus.$emit("reload-router-view")}))},createProduct(e){return x(this,null,(function*(){const t=yield Object(c["postProduct"])(e);dgiotlogger.info("postProduct：",t),t.objectId?(this.initQuery("产品创建成功","success"),this.dialogFormVisible=!1,setTimeout(()=>{this.queryForm.skip=0,this.searchProduct()},1200)):this.$message({type:"error",message:t.error||t,showClose:!0,duration:2e3})}))},editProduct(e){return x(this,null,(function*(){const t=yield this.$update_object("Product",this.custom_row.objectId,e);t.updatedAt?this.initQuery("产品修改成功","success"):this.$message({showClose:!0,duration:2e3,type:"error",message:t.error})}))},initQuery(e,t){this.$message({type:t||"info",message:e,showClose:!0,duration:2e3}),this.dialogFormVisible=!1,this.resetProductForm(),this.$refs["form"].resetFields(),this.searchProduct()},resetProductForm(){this.form={dynamicReg:!0,name:"",category:"",nodeType:3,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:"",config:{checkList:[]}},this.imageUrl=""},deviceToDetail(e){this.$router.push({path:"/roles/detailproduct",query:{id:e.objectId}})},GoTodevices(e){this.$router.push({path:"/roles/thing",query:{productid:e.objectId}})},makeSure(e,t){const a={count:"objectId",skip:0,limit:1,where:{product:e.objectId}};this.$baseConfirm("你确定要删除当前项吗",null,()=>x(this,null,(function*(){yield Object(d["queryDevice"])(a).then(t=>{t.count>0?this.$message("请先删除该产品下设备"):Object(c["delProduct"])(e.objectId).then(e=>{e&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"删除成功"}),setTimeout(()=>{this.searchProduct()},1e3))})}),setTimeout(()=>{this.searchProduct()},1e3)})))},blackDict(e,t){return x(this,null,(function*(){const a={data:t,key:e,type:"Product"},i=yield Object(u["postDict"])(a);i?this.$message({showClose:!0,duration:2e3,type:"success",message:"备份成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"备份失败"})}))},CloneData(e){return x(this,null,(function*(){const t={category:e.attributes.category,devType:e.attributes.devType,name:e.attributes.name,thing:e.attributes.thing},{objectId:a,code:i}=yield Object(m["getHashClass"])("Product",t);200==i&&this.blackDict(a,t)}))},proudctClone(e){e.attributes.config.cloneState=!0,e.attributes.config.cloneState=!0;const t=e,a=Object(c["putProduct"])(e.id,t);a&&this.CloneData(e)},proudctEdit(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#?drawProudctid=${e.objectId}&proudctid=${e.objectId}`;localStorage.setItem("rowId",e.objectId),window.open(i,"__blank")},proudctView(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#/views/${e.objectId}`;window.open(i,"__blank")},goTopoview(){var e=window.location.origin+"/spa";const{NODE_ENV:t}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});e="development"==t?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var a=e+"/#/view";window.open(a,"__blank")},handleImport(){return x(this,null,(function*(){yield this.$refs.uploader.click()}))},exportpro(){return x(this,null,(function*(){const e=this.$baseColorfullLoading(2);try{const t=yield Object(h["ExportParse"])("Product",{});e.close(),this.$convertRes2Blob(t)}catch(t){e.close(),this.$baseMessage(t,"error","dgiot-hey-message-error")}}))}}},j=P,D=(a("9715"),a("b351"),a("2877")),A=Object(D["a"])(j,i,o,!1,null,"5225701e",null);t["default"]=A.exports},"30b0":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"custom-table",staticClass:"devproduct devproduct-container",class:{"dgiot-fullscreen":e.isFullscreen}},[a("el-dialog",{attrs:{"append-to-body":!0,center:"",title:"选择告警类型",visible:e.Notification.show,width:"30%"},on:{"update:visible":function(t){return e.$set(e.Notification,"show",t)}}},[a("span",[a("el-radio",{attrs:{label:"start"},model:{value:e.Notification.detail.radio,callback:function(t){e.$set(e.Notification.detail,"radio",t)},expression:"Notification.detail.radio"}},[e._v(" 告警产生 ")]),a("el-radio",{attrs:{label:"stop"},model:{value:e.Notification.detail.radio,callback:function(t){e.$set(e.Notification.detail,"radio",t)},expression:"Notification.detail.radio"}},[e._v(" 告警恢复 ")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.Notification.show=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.createdNotification(e.Notification.detail)}}},[e._v(" 创 建 ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.wmxhandleClose,"close-on-click-modal":!1,title:e.wmxSituation+"自定义属性",top:"5vh",visible:e.wmxdialogVisible,width:"60%"},on:{"update:visible":function(t){e.wmxdialogVisible=t}}},[a("dgiot-wmx",{ref:"sizeForm",attrs:{"size-form1":e.sizeForm},on:{addDas:e.addDas,addDomain:e.addDomain,removeDas:e.removeDas,removeDomain:e.removeDomain,submitForm:e.submitFormwmx,wmxhandleClose:e.wmxhandleClose}})],1),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.viewobjectmodel"),visible:e.schemadialogVisible},on:{"update:visible":function(t){e.schemadialogVisible=t}}},[a("div",[a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"400px"},attrs:{id:"editor1"}},[a("textarea",{staticClass:"ace_text-input",staticStyle:{overflow:"scroll"}})])]),a("span",{staticClass:"dialog-footer",staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.preserve}},[e._v(" "+e._s(e.$translateTitle("equipment.update"))+" ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,title:e.formConfig.uid,visible:e.amisVisible,width:"75%"},on:{"update:visible":function(t){e.amisVisible=t}}},[a("dgiot-views",{attrs:{"view-form":e.viewForm}})],1),a("el-dialog",{directives:[{name:"drag-dialog",rawName:"v-drag-dialog"}],attrs:{"append-to-body":"",visible:e.parserView},on:{"update:visible":function(t){e.parserView=t}}},[a("f-render",{attrs:{config:e.formConfig,pure:""},model:{value:e.formConfig,callback:function(t){e.formConfig=t},expression:"formConfig"}})],1),a("div",{staticClass:"prosecond"},[a("dgiot-query-form",[a("dgiot-query-form-top-panel",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,"label-width":"100px",model:e.formInline},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("resource.category")}},[a("div",{staticClass:"border-panel"},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"mini"},on:{clear:e.clearCategory},model:{value:e.formInline.category,callback:function(t){e.$set(e.formInline,"category",t)},expression:"formInline.category"}},e._l(e.categoryList,(function(t,i){return a("el-option",{key:i,attrs:{label:t.name,value:t.objectId},nativeOn:{click:function(a){return e.categoryChange(t)}}})})),1)],1)]),a("el-form-item",{attrs:{label:e.$translateTitle("alert.product name")}},[a("el-input",{staticStyle:{width:"90%"},attrs:{clearable:"",placeholder:e.$translateTitle("product.searchproductname"),size:"mini"},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}},[a("el-button",{staticStyle:{padding:"0 !important",margin:"0 !important"},attrs:{slot:"append",icon:"el-icon-search",size:"mini"},on:{click:function(t){return e.queryProduttemp({})}},slot:"append"})],1)],1)],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.$lodash.isEmpty(e.productDetail),expression:"!$lodash.isEmpty(productDetail)"}],attrs:{size:"mini",type:"primary"},on:{click:function(t){e.isFullscreen=!e.isFullscreen}}},[a("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}}),e._v(" "+e._s(e.isFullscreen?e.$translateTitle("alert.Exit Full Screen"):e.$translateTitle("alert.full screen"))+" ")],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{lg:4,md:5,sm:6,xl:3,xs:4}},[a("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto"},style:{height:e.tableHeight+"px"}},e._l(e.categorysonList,(function(t,i){return a("li",{key:i,staticClass:"infinite-list-item",attrs:{disabled:""},on:{click:function(a){return a.stopPropagation(),e.categorysonChange(t)}}},[a("el-link",{attrs:{type:e.linkType==t.name?"success":""}},[e._v(" "+e._s(t.name)+"    ")]),a("el-button",{staticClass:"el-icon-plus",attrs:{plain:"",size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),e.addproducttemp(t)}}})],1)})),0)]),a("el-col",{attrs:{lg:5,md:6,sm:6,xl:3,xs:4}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.proTableData,"header-cell-style":{"text-align":"center"},height:e.tableHeight,"highlight-current-row":"",size:"medium"},on:{"row-click":e.StepsListRowClick}},[a("el-table-column",{attrs:{label:e.$translateTitle("product.productname"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{staticClass:"el-icon-edit",attrs:{title:e.$translateTitle("developer.delete"),type:"text"},on:{click:function(t){return t.stopPropagation(),e.editproducttemp(i)}}}),a("el-button",{staticClass:"el-icon-delete",staticStyle:{color:"red"},attrs:{title:e.$translateTitle("developer.delete"),type:"text"},on:{click:function(t){return t.stopPropagation(),e.deleteproducttemp(i)}}})]}}])})],1)],1),a("el-col",{attrs:{lg:15,md:13,sm:12,xl:18,xs:16}},[a("profile-descriptions",{ref:"ProfileDescription",attrs:{"decoder-table-list":e.decoderTableList,"dict-table-list":e.dictTableList,"parser-table-list":e.parserTableList,"product-detail":e.productDetail,"product-id":e.producttempId,"table-loading":e.tableLoading,"table-type":e.tableType,"thing-key":e.thingKey,things:e.things}})],1)],1)],1),a("profile-drawer",{ref:"drawer",attrs:{"parser-table":e.parserTable,"parser-tables":e.parserTables}}),a("profile-dict",{ref:"dict",attrs:{allunit:e.allunit,"data-list":e.dataList,"dict-visible":e.dictVisible,"edit-flag":e.edit_dict_temp_dialog,"parser-table":e.parserTable,rules:e.dictrules,tempparam:e.tempparams,"title-dict":e.title_dict_edit_dialog,"title-temp-dialog":e.title_temp_dialog}}),a("product-templet",{ref:"templet",on:{"fetch-data":function(t){return e.queryProduttemp({})}}}),a("el-drawer",{attrs:{"append-to-body":"","before-close":e.handleClose,"close-on-click-modal":!1,size:"50%",title:e.moduleTitle,top:"5vh",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticClass:"devproduct-prodialog-content"},[a("div",{staticClass:"contentone"},[a("el-form",{ref:"form",attrs:{"label-width":"150px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.Producttemplatename"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[a("el-input",{attrs:{disabled:e.addflag,placeholder:e.$translateTitle("product.pleaseselectyourcate")},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.form.categoryname,callback:function(t){e.$set(e.form,"categoryname",t)},expression:"form.categoryname"}}),e.showTree?a("div",[a("el-tree",{attrs:{data:e.categorytree,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),a("el-form-item",{attrs:{label:e.$translateTitle("menu.icon"),prop:"icon"}},[e.imageUrl?a("div",[a("img",{staticClass:"avatar",attrs:{src:e.$FileServe+e.imageUrl}}),a("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.deleteImgsrc.apply(null,arguments)}}},[e._v(" 删除 ")])],1):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(t){return e.uploadCkick("producttemp_ico")}}}),a("form",{ref:"uploadform",staticStyle:{position:"absolute",visibility:"hidden"},attrs:{enctype:"multipart/form-data",method:"POST"}},[a("input",{staticStyle:{position:"relative","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),a("br")]),a("dgiot-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),a("div",{staticClass:"devproduct-prodialog-footer",staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),a("el-button",{on:{click:function(t){return e.handleCloseDialogForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)])],1)},o=[],r=a("03b1"),s=a("5880"),l=a("7212"),n=a("e0e9"),c=a("d0fdb"),d=a("5da9"),p=a("7497"),u=a("ed07"),m=a("ef68"),h=a("0af3"),g=a("ed08"),b=a("aed5"),f=a("5118"),v=a("d292"),y=a("0c3c"),w=Object.defineProperty,T=Object.defineProperties,$=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,S=(e,t,a)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,I=(e,t)=>{for(var a in t||(t={}))k.call(t,a)&&S(e,a,t[a]);if(C)for(var a of C(t))x.call(t,a)&&S(e,a,t[a]);return e},P=(e,t)=>T(e,$(t)),j=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});const D=a("6818");let A={};var F;D.keys().forEach(e=>{let t=D(e);A[e.replace(/^\.\/(.*)\.\w+$/,"$1")]=t.default});var O={components:P(I({dgiotViews:y["default"]},A),{"dgiot-wmx":b["default"]}),props:{},data(){return{Notification:{show:!1,detail:{}},amisVisible:!1,viewForm:{},tableHeight:this.$baseTableHeight(0),dataList:[{}],dictrules:{},isFullscreen:!1,things:[],tableType:"things",multipleTable:[],thingKey:moment(new Date).valueOf().toString(),productDetail:{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}},linkType:"",productOptions:[],DbaTable:[],parserView:!1,parserTable:!1,parserType:"",parserTables:[],parserTableList:[],dictTableList:[],decoderTableList:{},productConfig:{},parserFromId:"",dialogVisible:!1,moduleTitle:this.$translateTitle("product.createproducttemplate"),allunit:[],productInfo:{},edit_dict_temp_dialog:!1,title_dict_edit_dialog:"新增字典数据",tempparams:{name:"",identifier:"",type:"",order:0,address:"",bytes:"",default:0,required:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},unit:""},elactiveName:"Table",elactiveName1:"Table1",editDictTempId:"",title_temp_dialog:"",dictTempForm:{},rule:[],dictVisible:!1,listLoading:!1,tableLoading:!1,custom_row:{},custom_status:"add",hashkey:"",defaultProps:{children:"children",label:"label"},length:10,total:0,start:0,activeName:"first",formInline:{productname:"",category:""},uploadHeaders:{sessionToken:Cookies.get("access_token")},uploadAction:"",uploadData:{},fileList:[],producttempId:"",productIdentifier:"",proTableData:[],formLabelWidth:"120px",dialogFormVisible:!1,importDialogShow:!1,categorytree:[],inputParams:{},form:{name:"",decoder:{},thing:{},config:{},nodeType:0,netType:"",icon:""},formPro:{name:"",url:""},rules:{name:[{required:!0,message:"请输入产品",trigger:"blur"}]},option:[],ruleoptions:[],channel:[{label:"蜂窝(2G/3G/4G)(直连)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道(直连)",value:"5G"},{label:"WIFI通道(直连)",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"Modbus",value:"Modbus"},{label:"LoRa(WAN)(直连)",value:"LoRaWAN"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接(直连)",value:"网线连接"},{label:"自定义",value:"OTHER"}],imageUrl:"",parserDict:[],formConfig:{},editIndex:0,Parserzh:"",parseren:"",loading:!1,categoryList:[],categorysonList:[],queryForm:{name:""},categoryListOptions:[],fileServer:"",access_token:"",projectid:"",allTableDate:[],showTree:!1,addflag:!0,wmxdialogVisible:!1,schemadialogVisible:!1,wmxSituation:"新增",modifyIndex:-1}},computed:I({},Object(s["mapGetters"])({token:"user/token",roleTree:"user/roleTree",sizeForm:"konva/sizeForm"})),watch:{productDetail:{handler(e){this.$nextTick((function(){var t;(null==(t=null==e?void 0:e.thing)?void 0:t.properties)&&this.properties(e.thing.properties)}))},immediate:!0,deep:!0}},mounted(){this.$baseEventBus.$off("showNotificationSettings"),this.$baseEventBus.$on("showNotificationSettings",e=>{console.debug(e),this.Notification={show:!0,detail:e}}),this.$baseEventBus.$off("profileDialog"),this.$baseEventBus.$on("profileDialog",({config:e,type:t,flag:a,productInfo:i,parserType:o})=>{console.log(e,t,a,i,o),this.productDetail=i,this.productInfo=i,this.parserType=t,this.productConfig=_.merge({basedate:{params:{}}},e),this.editorParser(e,t,a)}),this.$baseEventBus.$off("profileAmisDialog"),this.$baseEventBus.$on("profileAmisDialog",({config:e,productInfo:t})=>{this.amisVisible=!0,this.viewForm={showRow:!0,class:"Product",type:"notification",key:this.$route.query.id,title:"",disabled:!0,data:{type:"page",initApi:{url:"iotapi/classes/Device/parse_objectid",method:"get",adaptor:'return {\r\n  "status":0,\r\n  "msg":"",\r\n  "data":response.data.basedata\r\n  }',headers:{store:"localStorage",dgiotReplace:"parse_objectid"},dataType:"json"},body:[{type:"form",api:{method:"put",url:"iotapi/classes/Device/parse_objectid",headers:{store:"localStorage",dgiotReplace:"parse_objectid"},dataType:"json",requestAdaptor:"return {\r\n    ...api,\r\n    data: {\r\n        basedata:{ ...api.data}\r\n    }\r\n}"},body:[{type:"input-text",label:"设备名称",name:"name"}]}]},hiddenRow:["class","key","createdAt"]}});const{project:e=""}=this.$route.query;this.formInline.productname=e,this.querycategorylist(),this.featchTable(),this.queryProduttemp({})},methods:P(I({createdNotification(e){return j(this,null,(function*(){yield console.log(e),yield this.$router.push({path:"/rules_engine/addengine",query:{productid:this.$route.query.id,uid:e.objectId,title:"编辑",type:"Notification_"+this.Notification.detail.radio+"_"+this.$route.query.id}})}))},doUpload(e){return j(this,null,(function*(){const t=e.target.files[0],a=this.$baseColorfullLoading(3);try{const e=yield Object(h["ImportParse"])("Product",t);a.close(),dgiotlog.log("eresresrror",e),this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"})}catch(i){a.close(),dgiotlog.log("error",i),this.$baseMessage(i,"error","dgiot-hey-message-error")}this.$dgiotBus.$emit("reload-router-view")}))},querycategorylist(){return j(this,null,(function*(){const e={order:"createdAt",keys:"count(*)",where:{level:{$in:[0,1]}}},{results:t}=yield Object(r["queryCategory"])(e);this.categoryList=t,t&&"/dashboard/profile"==this.$route.fullPath&&this.$nextTick(()=>{this.categoryChange({name:"所有领域"})})}))},StepsListRowClick(e){return j(this,null,(function*(){this.$dgiotBus.$off("monaco-save");var t={},a=!0;try{const i=a=!1,o=yield Object(m["getProductTemplet"])(e.objectId);t=_.merge(o,{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}}),this.$baseMessage(this.$translateTitle("alert.Data request successfully"),"success","dgiot-hey-message-success"),a&&i.close()}catch(i){dgiotlog.log(i),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+i,"error","dgiot-hey-message-error")}dgiotlog.log("productDetail",t),this.producttempId=e.objectId,this.productDetail=t,this.$refs.ProfileDescription.productDetail=t}))},clearCategory(){this.linkType="",this.queryProduttemp({})},categoryChange(e){this.linkType=e.name;const t=this.$baseColorfullLoading();this.categorysonList=[];let a={order:"createdAt",include:"parent",where:{}};"所有领域"==e.name?(a.where={level:{$gte:1}},Object(r["queryCategory"])(a).then(e=>{this.categorysonList=e.results}),this.queryProduttemp({})):(a.where={parent:e.objectId},Object(r["queryCategory"])(a).then(t=>{this.categorysonList=[e].concat(t.results);var a=[];this.categorysonList.forEach(e=>{a.push(e.objectId)}),this.queryProduttemp({categorys:{$in:a}})})),t.close()},categorysonChange(e){this.linkType=e.name,this.queryProduttemp({category:e.objectId})},addproducttemp(e){this.fetchData(),this.addflag=!0,this.form={name:"",decoder:{},thing:{},config:{},nodeType:0,netType:"",categoryname:e.name,categoryid:e.objectId},this.dialogFormVisible=!0,this.producttempId=moment(new Date).valueOf().toString()},editproducttemp(e){dgiotlog.log("row",e),this.fetchData(),this.addflag=!1,this.form=e,this.producttempId=e.objectId,this.$set(this.form,"categoryname",e.category?e.category.name:""),this.$set(this.form,"categoryid",e.category?e.category.objectId:""),this.dialogFormVisible=!0},deleteproducttemp(e){Object(m["delProductTemplet"])(e.objectId).then(t=>{t?this.$message({showClose:!0,duration:2e3,type:"success",message:"产品模板删除成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"产品模板删除失败"}),this.queryProduttemp({category:e.category.objectId})})},handleNodeClick(e){this.$set(this.form,"categoryid",e.objectId),this.$set(this.form,"categoryname",e.name),this.showTree=!this.showTree},fetchData(){return j(this,null,(function*(){let e=this.queryForm.name.length?'{ "$regex": "'+this.queryForm.name+'"}':'{ "$ne": "null" }',t={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level"],"where":{"level": {"$gte": 1}, "name":'+e+"}}",parent:"parent"};const{results:a=[]}=yield Object(v["post_tree"])(t);this.categorytree=a}))},queryProduttemp(e){return j(this,null,(function*(){let t={order:"-createdAt",keys:"count(*)",include:"category,name",where:{}};this.queryForm.name&&(t.where.name={$regex:this.queryForm.name}),e.category&&(t.where.category=e.category),e.categorys&&(t.where.category=e.categorys);try{const{results:e=[],count:a=0}=yield Object(m["queryProductTemplet"])(t);this.proTableData=e,this.total=a}catch(a){dgiotlog.log(a),this.$baseMessage(a,"error","dgiot-hey-message-error")}}))},properties(e,t="things"){this.tableLoading=!0,this.things=e,this.tableType=t,Object(f["setTimeout"])(()=>this.tableLoading=!1,1200)},previewParse(e){this.parserView=!0,this.formConfig=e},addParse(e){e.push({name:this.parserType+"name",enname:this.parserType+"English Name",uid:Object(g["uuid"])(6),config:{},type:this.parserType,identifier:"identifier",visible:!0,table:"Device",class:"profile",description:this.parserType+"description"}),this.saveParse(e,-1,!1)},editParse(e,t){dgiotlog.log(t),this.formConfig=t,this.editIndex=e,this.parserTable=!1,this.$nextTick(()=>{this.dialogVisible=!0})},deleteParse(e,t,a){dgiotlog.log("uid",e),a.forEach((t,i)=>{t.uid==e&&a.splice(i,1),dgiotlog.log("rows",a)}),this.saveParse(a,-1,!1)},editorParser(e,t,a){var i,o,r,s;console.log("config",e,e,t,a);const{objectId:l,thing:n={}}=this.productDetail;var c=[],d=[],p=[];this.producttempId=l,this.parserFromId=l,this.editDictTempId=l,this.parserType=t,this.tableType=t,this.productConfig=_.merge({basedate:{params:{}}},e),dgiotlog.log("this.parserTableList",this.parserTableList,this.parserTables,this.tableType),(null==(r=null==(o=null==(i=this.productDetail)?void 0:i.basedate)?void 0:o.params)?void 0:r.length)&&this.productDetail.basedate.params.forEach(e=>{c.push({field:e.identifier,label:e.name,default:e.default})}),(null==(s=null==n?void 0:n.properties)?void 0:s.length)&&n.properties.forEach(e=>{d.push({field:e.identifier,label:e.name,default:e.default||""})}),localStorage.setItem("_sourceDict",JSON.stringify(c)),localStorage.setItem("_sourceModule",d),localStorage.setItem("_sourceField",p),this.decoderTableList={},dgiotlog.log("this.tableType ",this.tableType)},saveParse(e,t=-1,a=!0){return j(this,null,(function*(){const i=this.productConfig.config[""+this.parserType];t+1>0?i[t]=_.merge({},e):this.productConfig.config[""+this.parserType]=e;try{yield Object(l["putProduct"])(this.parserFromId,{config:this.productConfig.config});this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"}),this.dialogVisible=!1,a&&(this.parserTable=!1,this.queryProduttemp({}))}catch(o){this.$baseMessage(this.$translateTitle("user.Save the template error")+""+o,"error","dgiot-hey-message-error"),dgiotlog.log(o,"eeee")}dgiotlog.log(e)}))},featchTable(){return j(this,null,(function*(){this.setTreeFlag(!1);try{const{results:e=[]}=yield Object(u["getTable"])();this.DbaTable=e}catch(e){dgiotlog.log(e),this.$baseMessage(e,"error","dgiot-hey-message-error")}}))},uploadCkick(e){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:"app",path:"producttemp/ico/",filename:`${this.producttempId}.${e}`}},fileInfo(e){dgiotlog.log("info",e),this.imageUrl=e.path,this.loading=!1},files(e,t){this.inputParams.filename=`${this.producttempId}.${t}`,this.inputParams.file=e},getAllunit(){return j(this,null,(function*(){this.allunit=[];const{results:e}=yield Object(n["getAllunit"])("unit",200);this.allunit=e.concat([])}))},onJsonSave(e,t){dgiotlog.log("this.$refs",this.$refs.dict),this.$refs.dict.$refs[e].validate(e=>{dgiotlog.log(this.editDictTempId),e&&this.put_Dict_temp(this.editDictTempId,t)})},put_Dict_temp(e,t){return j(this,null,(function*(){dgiotlog.log(t);const{config:a={basedate:{}}}=this.productInfo;a.basedate=t;const i={config:a},{updatedAt:o}=yield Object(l["putProduct"])(e,i);void 0!=o?(this.dictVisible=!1,this.$message("字典数据更新成功")):this.$message("字典数据更新失败")}))},changeNode(e,t){0!=t&&(this.form.netType=""),this.channel=0==e?[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"LoRa(WAN)",value:"LoRaWAN"},{label:"Modbus",value:"Modbus"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]:[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"LoRaWAN",value:"LoRaWAN"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]},selectApp(e){e&&Object(d["getServer"])(e).then(e=>{e&&(this.fileServer=e.file,this.access_token=e.access_token)})},deleteImgsrc(){this.imageUrl=""},handleClose(){this.dialogFormVisible=!1},handleCloseDialogForm(){this.dialogFormVisible=!1,this.$nextTick(()=>{this.$refs["form"].resetFields()})},submitForm(){const e={"*":{read:!0,write:!0}};var t={name:this.form.name,category:{objectId:this.form.categoryid,__type:"Pointer",className:"Category"},icon:this.imageUrl?this.imageUrl:"",desc:this.form.desc?this.form.desc:"",content:{},profile:{}};this.$refs.form.validate(a=>{a?this.addflag?(t.ACL=e,dgiotlog.log("params",t),Object(m["postProductTemplet"])(t).then(e=>{e.objectId?this.$message({type:"success",showClose:!0,duration:2e3,message:"产品模板创建成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"产品模板创建失败"}),this.queryProduttemp({category:this.form.categoryid}),this.dialogFormVisible=!1})):Object(m["putProductTemplet"])(this.producttempId,t).then(e=>{dgiotlog.log("resresresres",e),e.updatedAt?this.$message({showClose:!0,duration:2e3,type:"success",message:"产品模板修改成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"产品模板修改失败"}),this.queryProduttemp({category:this.form.categoryid}),this.dialogFormVisible=!1}):this.$message("必填项未填")})},productSizeChange(e){this.length=e,this.queryProduttemp({})},productCurrentChange(e){this.start=(e-1)*this.length,this.queryProduttemp({})},blackDict(e,t){return j(this,null,(function*(){const a={data:t,key:e,type:"Product"},i=yield Object(n["postDict"])(a);i?this.$message({showClose:!0,duration:2e3,type:"success",message:"备份成功"}):this.$message({showClose:!0,duration:2e3,type:"error",message:"备份失败"})}))},CloneData(e){return j(this,null,(function*(){const t={category:e.attributes.category,devType:e.attributes.devType,name:e.attributes.name,thing:e.attributes.thing},{objectId:a,code:i}=yield Object(p["getHashClass"])("Product",t);200==i&&this.blackDict(a,t)}))},proudctClone(e){e.attributes.config.cloneState=!0,e.attributes.config.cloneState=!0;const t=e,a=Object(l["putProduct"])(e.id,t);a&&this.CloneData(e)},proudctEdit(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#?drawProudctid=${e.objectId}&proudctid=${e.objectId}`;localStorage.setItem("rowId",e.objectId),window.open(i,"__blank")},proudctView(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#/views/${e.objectId}`;window.open(i,"__blank")},goTopoview(){var e=window.location.origin+"/spa";const{NODE_ENV:t}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});e="development"==t?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var a=e+"/#/view";window.open(a,"__blank")},lockingParse(e,t,a){const{disable:i=!1}=a[""+t];a[""+t].disable=!i,this.saveParse(a,-1,!1)},exportpro(){this.allTableDate?Object(c["export_txt_to_zip"])(JSON.stringify(this.allTableDate),"Dict","Dict"):this.$message({showClose:!0,duration:2e3,type:"warning",message:"数据为空,无法导出"})}},Object(s["mapMutations"])({setSizeForm:"konva/setSizeForm",setTreeFlag:"settings/setTreeFlag"})),{getFormOrginalData(){return{devicetype:this.devicetype,strategy:"20",resource:1,identifier:"",dis:"0X10",dinumber:"null",type:"int",startnumber:"",endnumber:"",step:"",true:"",truevalue:1,false:"",falsevalue:0,isread:"r",isshow:!0,unit:"",string:"",date:"String类型的UTC时间戳 (毫秒)",specs:{},precision:3,round:"all",struct:[{attribute:"",attributevalue:""}],rate:1,offset:0,order:0,protocol:"normal",operatetype:"readCoils",originaltype:"int",slaveid:"0X10",collection:"%s",control:"%d",nobound:[],editdatatype:!1,iscount:"0",countstrategy:20,countround:"all",countcollection:"%s",daslist:[]}},createProperty(){this.setSizeForm(this.getFormOrginalData()),this.wmxdialogVisible=!0,this.wmxSituation="新增"},wmxhandleClose(){this.$refs["sizeForm"].resource.disabled=!1,this.wmxdialogVisible=!1,this.setSizeForm(this.getFormOrginalData())},removeDomain(e){var t=this.sizeForm.struct.indexOf(e);-1!==t&&this.sizeForm.struct.splice(t,1)},addDomain(){this.sizeForm.struct.push({attribute:"",attributevalue:""})},deletewmx(e){this.productDetail.thing.properties.splice(e,1);let t={thing:{properties:this.productDetail.thing.properties}};Object(m["putProductTemplet"])(this.producttempId,t).then(e=>{e.updatedAt?this.$message({type:"success",showClose:!0,duration:2e3,message:"删除成功"}):this.$message({type:"warning",showClose:!0,duration:2e3,message:"删除失败"})}).catch(e=>{dgiotlog.log(e)})},wmxDataFill(e,t){this.modifyIndex=t,this.wmxdialogVisible=!0,this.wmxSituation="编辑";var a={},i=[];if(e.dataType.das.forEach(e=>{i.push({addr:e})}),-1!=["float","double","int","long"].indexOf(e.dataType.type))a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,daslist:i,endnumber:this.$objGet(e,"dataType.specs.max"),startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),precision:this.$objGet(e,"dataType.specs.precision"),dis:this.$objGet(e,"dataForm.address"),round:this.$objGet(e,"dataForm.round"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),slaveid:this.$objGet(e,"dataForm.slaveid"),collection:"",control:"",strategy:"",required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,editdatatype:!0},e.dataForm&&(a.collection=e.dataForm.collection,a.control=e.dataForm.control,a.strategy=e.dataForm.strategy);else if("bool"==e.dataType.type)a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,true:e.dataType.specs[1],false:e.dataType.specs[0],daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!1,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0};else if("image"==e.dataType.type)a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,imagevalue:e.dataType.imagevalue,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!1,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0};else if("enum"==e.dataType.type){var o=[];for(const t in e.dataType.specs)o.push({attribute:t,attributevalue:e.dataType.specs[t]});a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,specs:e.dataType.specs,struct:o,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0}}else"struct"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,struct:e.dataType.specs,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,identifier:void 0==e.dataForm?"":e.identifier,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0}:"text"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,string:e.dataType.size,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),order:this.$objGet(e,"dataForm.order"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,strategy:void 0==e.dataForm?"":e.dataForm.strategy,editdatatype:!0}:"date"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),order:this.$objGet(e,"dataForm.order"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,editdatatype:!0}:"geopoint"==e.dataType.type&&(a={name:e.name,devicetype:e.devicetype,type:e.dataType.type,gpstype:e.dataType.gpstype,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,daslist:i,startnumber:this.$objGet(e,"dataType.specs.min"),step:this.$objGet(e,"dataType.specs.step"),unit:this.$objGet(e,"dataType.specs.unit"),round:this.$objGet(e,"dataForm.round"),dis:this.$objGet(e,"dataForm.address"),order:this.$objGet(e,"dataForm.order"),dinumber:this.$objGet(e,"dataForm.data"),rate:this.$objGet(e,"dataForm.rate"),offset:this.$objGet(e,"dataForm.offset"),protocol:this.$objGet(e,"dataForm.protocol"),operatetype:this.$objGet(e,"dataForm.operatetype"),originaltype:this.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,ico:e.ico,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,editdatatype:!0});a.protocol=e.dataForm.protocol,this.setSizeForm(a),this.$nextTick(()=>j(this,null,(function*(){yield this.$refs["sizeForm"].queryResource(),this.$refs["sizeForm"].resource.value=e.dataForm.protocol,this.$refs["sizeForm"].resource.disabled=!!e.dataForm.protocol.length,this.$refs["sizeForm"].resource.arrlist=e.dataSource,this.$nextTick(()=>{this.$refs["sizeForm"].resource.data.forEach((t,a)=>{if(this.$refs["sizeForm"].resource.value===t.cType){for(var i in console.info(t,"success cType"),console.info(e.dataSource,"rowData.dataSource"),e.dataSource)for(var o in t.obj)i===o&&(t.obj[i]=e.dataSource[o]);console.info(t.obj,"set resource.obj"),this.$refs["sizeForm"].resource.addchannel=t.obj}this.$refs["sizeForm"].resource.changeData=e.dataSource,t.cType==e.dataForm.protocol&&console.log(t,"success")})}),console.log("refs sizeForm",this.$refs["sizeForm"])})))},addDas(){this.sizeForm.daslist.push({addr:""})},removeDas(e){var t=this.sizeForm.daslist.indexOf(e);-1!==t&&this.sizeForm.daslist.splice(t,1)},submitFormwmx(e){var t=[];e.daslist.map(e=>{var a=e["addr"];t.push(a)}),dgiotlog.log("sizeForm",e);var a={name:e.name,devicetype:e.devicetype,dataForm:{round:e.round,data:e.dinumber,address:e.dis,rate:e.rate,offset:e.offset,order:e.order,protocol:e.protocol,operatetype:e.operatetype,originaltype:e.originaltype,slaveid:e.slaveid,collection:e.collection,control:e.control,strategy:e.strategy,iscount:e.iscount,countstrategy:e.countstrategy,countround:e.countround,countcollection:e.countcollection},ico:e.ico,required:!0,accessMode:e.isread,isshow:e.isshow,identifier:e.identifier};if("float"==e.type||"double"==e.type||"int"==e.type||"long"==e.type){var i={dataType:{type:e.type.toLowerCase(),specs:{max:e.endnumber,min:e.startnumber,step:e.step,precision:Number(e.precision),unit:""==e.unit?"":e.unit},das:t}};Object.assign(a,i)}else if("image"==e.type)i={dataType:{das:t,type:e.type.toLowerCase(),imagevalue:e.imagevalue,specs:{}}},Object.assign(a,i);else if("bool"==e.type)i={dataType:{das:t,type:e.type.toLowerCase(),specs:{0:e.false,1:e.true}}},Object.assign(a,i);else if("enum"==e.type){var o={};e.struct.map(e=>{var t=e["attribute"];o[t]=e["attributevalue"]}),i={dataType:{das:t,type:e.type.toLowerCase(),specs:o}},Object.assign(a,i)}else"struct"==e.type?(i={dataType:{das:t,type:e.type.toLowerCase(),specs:e.struct}},Object.assign(a,i)):"text"==e.type?(i={dataType:{das:t,type:e.type.toLowerCase(),size:e.string,specs:{}}},Object.assign(a,i)):"date"==e.type?(i={dataType:{das:t,type:e.type.toLowerCase(),specs:{}}},Object.assign(a,i)):"geopoint"==e.type&&(i={dataType:{das:t,type:e.type.toLowerCase(),gpstype:e.gpstype,specs:{}}},Object.assign(a,i));delete a.index,dgiotlog.log("obj",a),"新增"==this.wmxSituation?this.productDetail.thing.properties.unshift(a):"编辑"==this.wmxSituation&&(this.productDetail.thing.properties[this.modifyIndex]=a,this.thingKey=moment(new Date).valueOf().toString()),dgiotlog.log(this.wmxSituation,this.productDetail.thing.properties);let r={thing:{properties:this.productDetail.thing.properties}};Object(m["putProductTemplet"])(this.producttempId,r).then(e=>{e.updatedAt?this.$message({type:"success",showClose:!0,duration:2e3,message:this.wmxSituation+"成功"}):this.$message({type:"warning",showClose:!0,duration:2e3,message:this.wmxSituation+"失败"})}),this.wmxdialogVisible=!1},checkschema(){this.schemadialogVisible=!0,Object(f["setTimeout"])(()=>{F=ace.edit("editor1"),F.session.setMode("ace/mode/json"),F.setTheme("ace/theme/eclipse"),F.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),F.setValue(JSON.stringify(this.productDetail.thing,null,4))},1)},preserve(){const e={thing:JSON.parse(F.getValue())};Object(m["putProductTemplet"])(this.producttempId,e).then(e=>{this.$message({type:"success",showClose:!0,duration:2e3,message:this.wmxSituation+"成功"})}),this.schemadialogVisible=!1},goKonva(e){this.$router.push({path:"/Topo?productid",query:{productid:e}})}})},q=O,z=(a("6b3d"),a("2877")),E=Object(z["a"])(q,i,o,!1,null,"6f7fc790",null);t["default"]=E.exports},4968:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devproduct devproduct-container"},[a("dgiot-input",{ref:"uploadFinish",on:{fileInfo:e.fileInfo}}),a("div",{staticClass:"prosecond"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},on:{change:e.handleCateSearch},model:{value:e.queryForm.category,callback:function(t){e.$set(e.queryForm,"category",t)},expression:"queryForm.category"}},e._l(e.categoryList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("product.searchproductname")},model:{value:e.formInline.productname,callback:function(t){e.$set(e.formInline,"productname",t)},expression:"formInline.productname"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.searchProduct(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",{staticStyle:{float:"right","text-align":"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.addproduct}},[e._v(" "+e._s(e.$translateTitle("product.createproduct"))+" ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.exportpro}},[e._v(" "+e._s(e.$translateTitle("product.exportpro"))+" ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleImport()}}},[e._v(" "+e._s(e.$translateTitle("product.importpro"))+" ")])],1)],1),a("div",{staticClass:"protable"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.tableData,"header-cell-style":{"text-align":"center"}}},[a("el-table-column",{attrs:{label:"ProductID",prop:"objectId","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("product.productname")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.productgrouping")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.netType))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.addingtime"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e.utc2beijing(i.createdAt)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"340"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,o=t.$index;return[a("el-button",{attrs:{size:"mini",type:"primary",underline:!1},on:{click:function(t){return e.deviceToDetail(i)}}},[e._v(" "+e._s(e.$translateTitle("product.config"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.goKonva(i.objectId)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.konva"))+" ")]),a("el-button",{attrs:{size:"mini",type:"success",underline:!1},on:{click:function(t){return e.editorProduct(i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.makeSure(e.scope,o)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])]}}])})],1)],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,20,30,50],total:e.total},on:{"current-change":e.productCurrentChange,"size-change":e.productSizeChange}})],1)],1),a("div",{staticClass:"devproduct-prodialog"},[a("el-drawer",{attrs:{"before-close":e.handleClose,"close-on-click-modal":!1,size:"60%",title:e.moduleTitle,top:"5vh",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticClass:"devproduct-prodialog-content"},[a("div",{staticClass:"contentone"},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(" "+e._s(e.$translateTitle("product.productinformation"))+" ")]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{ref:"form",attrs:{"label-width":"产品名称"==e.$translateTitle("product.productname")?"120px":"160px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.productgrouping"),prop:"devType"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.devType,callback:function(t){e.$set(e.form,"devType",t)},expression:"form.devType"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.classification"),prop:"category"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[a("el-option",{staticStyle:{height:"auto",padding:"0"},attrs:{value:e.treeDataValue}},[a("el-tree",{ref:"workGroup",attrs:{data:e.categoryTreeData,"default-expand-all":"","expand-on-click-node":!1,"node-key":"index"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,o=t.data;return a("div",{staticClass:"custom-tree-node"},[a("span",{class:{selected:!1},on:{click:function(t){return e.handleCateClick(i,o)}}},[e._v(" "+e._s(i.label)+" ")])])}}])})],1)],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.applicationtype"),prop:"relationApp"}},[a("el-input",{attrs:{disabled:"edit"==e.custom_status&&""!=e.form.relationApp,placeholder:e.$translateTitle("product.pleaseselectyourapp"),readonly:""},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}}),e.showTree?a("div",[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),a("el-form-item",{attrs:{label:e.$translateTitle("menu.icon"),prop:"icon"}},[e.imageUrl?a("div",[a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}),a("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.deleteImgsrc.apply(null,arguments)}}},[e._v(" 删除 ")])],1):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:e.uploadCkick}}),a("form",{ref:"uploadform",staticStyle:{position:"absolute",visibility:"hidden"},attrs:{enctype:"multipart/form-data",method:"POST"}},[a("input",{staticStyle:{position:"relative","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),a("br")]),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),a("div",{staticClass:"devproduct-prodialog-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),a("el-button",{on:{click:function(t){return e.handleCloseDialogForm()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)])],1)],1)},o=[],r=a("ed08"),s=a("5880"),l=a("7212"),n=a("e0e9"),c=a("1285"),d=a("5da9"),p=a("7497"),u=a("0af3"),m=a("ef68"),h=a("03b1"),g=a("d292"),b=Object.defineProperty,f=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,w=(e,t,a)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,T=(e,t)=>{for(var a in t||(t={}))v.call(t,a)&&w(e,a,t[a]);if(f)for(var a of f(t))y.call(t,a)&&w(e,a,t[a]);return e},C=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});const k=a("6818");let x={};k.keys().forEach(e=>{let t=k(e);x[e.replace(/^\.\/(.*)\.\w+$/,"$1")]=t.default});var S={components:{},data(){return{selectedRow:{},tableData:[],allTemp:[],category:[],descriptions:{tableType:"things",things:[],productId:"",dictTableList:[],decoderTableList:{},productDetail:{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],basedate:{params:[]}}},parserTableList:[],tableLoading:!1},queryForm:{name:"",category:"",productId:"",productFlag:!1,pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,total:0,order:"-createdAt",keys:"count(*)"},cascaderDrawer:!1,drawerWidth:Number($(window).width())-240,height:this.$baseTableHeight(0),config:{},dataList:[{}],parserView:!1,parserTable:!1,parserTableList:{parser:[]},parserFromId:"",dialogVisible:!1,moduleTitle:this.$translateTitle("product.createproduct"),allunit:[],productInfo:{},edit_dict_temp_dialog:!1,title_dict_edit_dialog:"新增字典数据",tempparams:{name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},unit:"",inactivevalue:"",activevalue:""},elactiveName:"Table",elactiveName1:"Table1",editDictTempId:"",title_temp_dialog:"",dictTempForm:"",rule:[],dictVisible:!1,listLoading:!1,custom_row:{},custom_status:"add",hashkey:"",defaultProps:{children:"children",label:"label"},length:10,total:0,start:0,activeName:"first",formInline:{productname:""},uploadHeaders:{sessionToken:Cookies.get("access_token")},uploadAction:"",uploadData:{},fileList:[],proTableData:[],dialogFormVisible:!1,importDialogShow:!1,cType:"",treeDataValue:"",categoryTreeData:[],curCatementId:"",form:{type:1,storageStrategy:"",name:"",category:"",nodeType:3,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},formPro:{name:"",url:""},rules:{name:[{required:!0,message:"请输入产品",trigger:"blur"}],devType:[{required:!0,message:"请输入产品标识，用于区分不同设备",trigger:"blur"}],category:[{required:!0,message:"请选择所属分类",trigger:"change"}],nodeType:[{required:!0,message:"请选择节点类型",trigger:"change"}],netType:[{required:!0,message:"请选择联网方式",trigger:"change"}],relationApp:[{required:!0,message:"请选择产品可见角色",trigger:"change"}]},option:[],ruleoptions:[],dialogProfile:!1,imageUrl:"",selectfromtype:"",productid:"",parserDict:[],formConfig:{},editIndex:0,Parserzh:"",parseren:"",loading:!1,allApps:[],categoryList:[],fileServer:"",access_token:"",projectid:"",projectName:"",allTableDate:[],showTree:!1,showcateTree:!1,multipleSelection:[]}},computed:T({},Object(s["mapGetters"])({token:"user/token",roleTree:"user/roleTree"})),mounted(){this.queryProdut({}),this.categorytree(),this.categorylist(),this.searchProduct(0)},beforeDestroy(){this.projectName=""},methods:{handleIconClick(e){return C(this,null,(function*(){this.dialogProfile=!this.dialogProfile,yield this.$refs.dialogProfile.StepsListRowClick(this.selectedRow)}))},handleCateClick(e,t){dgiotlog.log("node",e),dgiotlog.log("data",t),this.form.category=t.objectId,this.curCatementId=t.name},queryProdut(e){return C(this,null,(function*(){const t=e.categorys,a=this.$baseColorfullLoading();e.limit||(e=this.queryForm),dgiotlog.log("args",e);let i={limit:e.limit,order:e.order,skip:e.skip,keys:e.keys,where:{}};e.name&&(i.where.name={$regex:e.name}),t&&(i.where.category={$in:t}),dgiotlog.log("params",i);try{const{results:e=[],count:t=0}=yield Object(m["queryProductTemplet"])(i);a.close(),this.tableData=e,this.queryForm.total=t}catch(o){a.close(),dgiotlog.log(o),this.$baseMessage(o,"error","dgiot-hey-message-error")}}))},goKonva(e){this.$router.push({path:"/Topo?productid",query:{productid:e}})},uploadCkick(){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click"))},fileInfo(e){dgiotlog.log("info",e),this.imageUrl=e.url,this.loading=!1},getAllunit(){return C(this,null,(function*(){this.allunit=[];const{results:e}=yield Object(n["getAllunit"])("unit",200);this.allunit=e.concat([])}))},submitEnum(){"Enum"==this.tempparams.type&&this.tempparams.specs.map(e=>{var t=e["attribute"];this.tempparams.struct[t]=e["attributevalue"]})},addDomain(){this.tempparams.specs.push({attribute:"",attributevalue:""})},removeDomain(e){var t=this.tempparams.specs.indexOf(e);-1!==t&&this.tempparams.specs.splice(t,1)},delRow(e,t){t.splice(e,1)},editRow(e,t,a){this.editIndexId=t,this.title_dict_edit_dialog="修改字典数据",this.edit_dict_temp_dialog=!0,this.tempparams=e},closeDict(){this.edit_dict_temp_dialog=!this.edit_dict_temp_dialog},onJsonSave(e){this.$refs[e].validate(e=>{dgiotlog.log(this.editDictTempId),e&&this.put_Dict_temp(this.editDictTempId,this.dictTempForm)})},put_Dict_temp(e,t){return C(this,null,(function*(){dgiotlog.log(t);const{config:a={basedate:{}}}=this.productInfo;a.basedate=t;const i={config:a},{updatedAt:o}=yield Object(l["putProduct"])(e,i);void 0!=o?(this.dictVisible=!1,this.$message("字典数据更新成功")):this.$message("字典数据更新失败")}))},submitFormTempDict(){this.submitEnum(),this.edit_dict_temp_dialog=!1,void 0!=this.editIndexId?(this.dictTempForm.params[this.editIndexId]=this.tempparams,this.$message("编辑成功")):(this.dictTempForm.params.push(this.tempparams),this.$message("新增成功"))},opendialog(e){this.$nextTick(()=>{this.$refs[e].clearValidate()})},tempTypeChange(e){"bool"==e?(this.tempparams.default=!0,this.tempparams.default=!0):this.tempparams.default="int"==e?0:void 0},addRow(e){this.editIndexId=void 0,this.title_dict_edit_dialog="新增字典数据",this.edit_dict_temp_dialog=!0,this.tempparams={name:"",identifier:"",type:"",order:0,address:"",bytes:"",registersnumber:"",default:0,required:!1,readonly:!0,specs:[{attribute:"",attributevalue:""}],struct:{},collection:"%s",setting:"%s",unit:""}},onError(){this.$message("非Json数据类型")},handleNodeClick(e){dgiotlog.log(e,"data"),this.$set(this.form,"relationApp",e.name),this.showTree=!this.showTree},selectApp(e){e&&Object(d["getServer"])(e).then(e=>{e&&(this.fileServer=e.file,this.access_token=e.access_token)})},treeData(e){const t=JSON.parse(JSON.stringify(e));return t.filter(e=>{const a=t.filter(t=>e.objectId==t.parent.objectId);return a.length>0&&(e.children=a),0==e.parent.objectId})},deleteImgsrc(){this.imageUrl=""},dataURItoBlob(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);return new Blob([i],{type:a})},submitUpload(){this.uploadAction="/product",this.$nextTick(()=>{this.uploadData.appid=Cookies.get("appids"),this.$refs.fileUpload.submit()})},handleUploadSuccess(e,t,a){this.$message({showClose:!0,duration:2e3,type:"success",message:"产品导入成功"}),this.importDialogShow=!1,this.$refs["uploadProForm"].resetFields(),this.searchProduct()},handleUploadError(e,t,a){this.$message({showClose:!0,duration:2e3,showClose:!0,message:e})},handleChange(e,t){t.length>0&&(this.fileList=[t[t.length-1]])},utc2beijing(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},searchProduct(e){return C(this,null,(function*(){try{this.listLoading=!0,0==e&&(this.start=0);var t=[];const a={count:"objectId",order:"-updatedAt",limit:this.length,skip:this.start,where:{}};this.formInline.productname&&(a.where.name={$regex:this.formInline.productname});const{results:i=[],count:o=0}=yield this.$query_object("Product",a);i&&(i.map(e=>{""!=e.category&&e.category&&"report"!=e.devType&&t.push(e.category)}),this.listLoading=!1,this.proTableData=i,this.total=o),this.getApps()}catch(a){this.listLoading=!1,dgiotlog.log(a),this.$baseMessage(this.$translateTitle("alert.Data request error")+""+a,"error","dgiot-hey-message-error")}}))},getApps(){this.allApps=this.roleTree},handleClose(){this.dialogFormVisible=!1},chooseTemplate(e){dgiotlog.log("row",e),this.selectedRow=e,this.form.category=e.category,this.cascaderDrawer=!this.cascaderDrawer},handleCloseDialogForm(){this.dialogFormVisible=!1,this.$nextTick(()=>{this.$refs["form"].resetFields()})},properties(e,t="things"){this.descriptions.tableLoading=!0,dgiotlog.log(e),this.descriptions.things=e,this.descriptions.tableType=t,setTimeout(()=>this.descriptions.tableLoading=!1,1200)},addproduct(){this.custom_status="add",this.moduleTitle=this.$translateTitle("product.createproduct"),this.imageUrl="",this.handleNodeClick(this.allApps[0]),this.form={name:"",type:1,category:"",nodeType:3,desc:"",netType:" ",devType:"",productSecret:"",relationApp:this.allApps[0].name,roles:[]},this.dialogFormVisible=!0},getParent(e,t,a){return t.map(i=>{e==i.id?(a.unshift(i.value),this.getParent(i.parentid,t,a)):0==i.parentid&&i.id==e&&a.unshift(i.value)}),this.form.category=a[0],a},getIndustryParent(e,t){t.map(a=>{a.value==e&&this.getParent(a.id,t,[])})},editorParser(e){return C(this,null,(function*(){this.parserFromId=e;try{const{config:t={parser:[]},thing:a={}}=yield Object(l["getProduct"])(e);this.parserTableList=t,dgiotlog.log(this.parserTableList),this.parserDict=_.merge(a,t)}catch(t){this.parserTableList={parser:[]},dgiotlog.log("eeeeeeeeeeeee",t)}this.parserTable=!0}))},editParse(e,t){this.formConfig=t,this.editIndex=e,this.dialogVisible=!0},saveParse(e,t=-1){return C(this,null,(function*(){t+2>0&&(this.parserTableList.parser[t]=_.merge({},e));try{yield Object(l["putProduct"])(this.parserFromId,{config:t+2>0?this.parserTableList:e});this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"}),this.dialogVisible=!1,this.parserTable=!1}catch(a){this.$baseMessage(this.$translateTitle("user.Save the template error")+""+a,"error","dgiot-hey-message-error"),dgiotlog.log(a,"eeee")}dgiotlog.log(e)}))},previewParse(e){this.parserView=!0,this.formConfig=e,dgiotlog.log("previewParse",e)},addParse(e){e["parser"].push({name:Object(r["uuid"])(6),enname:Object(r["uuid"])(6),config:{}})},deleteParse(e,t){t.splice(e,1)},editorDict(e){return C(this,null,(function*(){this.getAllunit();const t=yield Object(l["getProduct"])(e),{config:a={basedate:{}}}=t;this.productInfo=t,dgiotlog.log(" this.parserDict",this.parserDict),this.editDictTempId=e,this.dictTempForm={name:"",cType:"",enable:"1",description:"",params:[]},this.title_temp_dialog="创建字典模板",dgiotlog.log(a),a.basedate&&a.basedate.name&&(this.title_temp_dialog="修改字典模板",this.dictTempForm=a.basedate),this.rule={name:[{required:!0,message:"请输入字典模板名称",trigger:"blur"}],cType:[{required:!0,message:"请输入字典模板类型",trigger:"blur"}],enable:[{required:!0,message:"请选择状态",trigger:"change"}]},dgiotlog.log(this.dictTempForm,"config"),this.dictVisible=!0}))},editorProduct(e){this.imageUrl="",this.moduleTitle=this.$translateTitle("product.editproduct"),this.custom_status="edit",this.custom_row=e,this.dialogFormVisible=!0,this.productid=e.objectId,this.getIndustryParent(e.category,this.categoryList),this.form.desc=e.desc,this.form.name=e.name,this.form.nodeType=e.nodeType,this.form.netType=e.netType,this.form.devType=e.devType,this.form.productSecret=e.productSecret,e.icon&&(this.imageUrl=e.icon);let t=[];for(var a in e.ACL)t.push(a),a.includes("role")&&(dgiotlog.log(a,"key"),this.form.relationApp=a?a.substr(5):"")},categorylist(){return C(this,null,(function*(){const e={order:"createdAt",keys:"count(*)",where:{level:{$in:[0,1]}}},{results:t}=yield Object(h["queryCategory"])(e);this.categoryList=t,dgiotlog.log("this",this.categoryList)}))},categorytree(){return C(this,null,(function*(){let e=this.queryForm.name.length?'{ "$regex": "'+this.queryForm.name+'"}':'{ "$ne": "null" }';this.listLoading=!0;let t={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level"],"where":{"level": {"$gte": 1}, "name":'+e+"}}",parent:"parent"};dgiotlog.log(t);const{results:a=[]}=yield Object(g["post_tree"])(t);this.categoryTreeData=a,this.listLoading=!1}))},handleCateSearch(e){if(this.queryForm.category=e,this.showcateTree=!this.showcateTree,"a60a85475a"==e)this.queryProdut({});else{let t={keys:"objectId",where:{parent:{className:"Category",objectId:e,__type:"Pointer"}}};Object(h["queryCategory"])(t).then(t=>{const a=[];a.push(e),t.results.forEach(e=>{a.push(e.objectId)}),dgiotlog.log("ids",a),this.queryProdut({categorys:a})})}},submitForm(){this.form.name,this.form.nodeType,this.form.netType,this.imageUrl,this.form.devType,this.form.desc;this.$refs.form.validate(e=>{e?this.custom_status:this.$message("必填项未填")})},doUpload(e){return C(this,null,(function*(){const t=e.target.files[0],a=this.$baseColorfullLoading(3);try{const e=yield Object(u["ImportParse"])("Product",t);a.close(),dgiotlog.log("eresresrror",e),this.$message({showClose:!0,duration:2e3,message:this.$translateTitle("user.Save the template successfully"),type:"success"})}catch(i){a.close(),dgiotlog.log("error",i),this.$baseMessage(i,"error","dgiot-hey-message-error")}this.$dgiotBus.$emit("reload-router-view")}))},createProduct(e){return C(this,null,(function*(){const t=yield this.$create_object("Product",e);t.objectId?this.initQuery("产品创建成功","success"):this.$message({type:"error",message:t.error,showClose:!0,duration:2e3})}))},editProduct(e){return C(this,null,(function*(){const t=yield this.$update_object("Product",this.custom_row.objectId,e);t.updatedAt?this.initQuery("产品修改成功","success"):this.$message({type:"error",message:t.error,showClose:!0,duration:2e3})}))},initQuery(e,t){this.$message({type:t||"info",message:e,showClose:!0,duration:2e3}),this.dialogFormVisible=!1,this.resetProductForm(),this.$refs["form"].resetFields(),this.searchProduct()},resetProductForm(){this.form={name:"",category:"",nodeType:3,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},this.imageUrl=""},deviceToDetail(e){this.$router.push({path:"/roles/detailproduct",query:{id:e.objectId}})},GoTodevices(e){this.$router.push({path:"/roles/thing",query:{productid:e.objectId}})},makeSure(e,t){const a={count:"objectId",skip:0,limit:1,where:{product:e.objectId}};this.$confirm(`此操作将永久删除${e.name}, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>C(this,null,(function*(){const{count:i=0}=Object(c["queryDevice"])(a);i>0?this.$message("请先删除该产品下设备"):(yield Object(l["delProduct"])(e.objectId),this.tableData.splice(t,1))}))).catch(()=>{})},productSizeChange(e){this.length=e,this.searchProduct()},productCurrentChange(e){this.start=(e-1)*this.length,this.searchProduct()},blackDict(e,t){return C(this,null,(function*(){const a={data:t,key:e,type:"Product"},i=yield Object(n["postDict"])(a);i?this.$message({type:"success",message:"备份成功",showClose:!0,duration:2e3}):this.$message({showClose:!0,duration:2e3,type:"error",message:"备份失败"})}))},CloneData(e){return C(this,null,(function*(){const t={category:e.attributes.category,devType:e.attributes.devType,name:e.attributes.name,thing:e.attributes.thing},{objectId:a,code:i}=yield Object(p["getHashClass"])("Product",t);200==i&&this.blackDict(a,t)}))},proudctClone(e){e.attributes.config.cloneState=!0,e.attributes.config.cloneState=!0;const t=e,a=Object(l["putProduct"])(e.id,t);a&&this.CloneData(e)},proudctEdit(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#?drawProudctid=${e.objectId}&proudctid=${e.objectId}`;localStorage.setItem("rowId",e.objectId),window.open(i,"__blank")},proudctView(e){var t=window.location.origin+"/spa";const{NODE_ENV:a}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i=`${t}/#/views/${e.objectId}`;window.open(i,"__blank")},goTopoview(){var e=window.location.origin+"/spa";const{NODE_ENV:t}=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});e="development"==t?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var a=e+"/#/view";window.open(a,"__blank")},handleImport(){return C(this,null,(function*(){yield this.$refs.uploader.click()}))},exportpro(){return C(this,null,(function*(){const e=this.$baseColorfullLoading(2);try{const t=yield Object(u["ExportParse"])("Product",{});e.close(),this.$convertRes2Blob(t)}catch(t){e.close(),this.$baseMessage(t,"error","dgiot-hey-message-error")}}))}}},I=S,P=(a("d13b"),a("e7b4"),a("2877")),j=Object(P["a"])(I,i,o,!1,null,"a96ef730",null);t["default"]=j.exports},"56f7":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"611d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"proddetail"},[i("dgiot-profile",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{"product-info":e.productInfo}}),i("div",[i("el-tabs",{ref:"_tabs",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:e.$translateTitle("product.productinformation"),name:"first"}},[i("div",{staticStyle:{"box-sizing":"border-box",padding:"10px",background:"#ffffff"}},[i("dgiot-query-form",[i("dgiot-query-form-left-panel",{attrs:{disabled:!e.productName.length}},[i("div",{staticClass:"addtopic"},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.exportProduct(e.productName)}}},[e._v(" "+e._s(e.$translateTitle("product.exportpro"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.setTemplate(e.productInfo)}}},[e._v(" "+e._s(e.$translateTitle("product.Set as template"))+" ")])],1)]),i("dgiot-query-form-right-panel",[i("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1)],1),i("div",[i("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:""==e.productName,expression:"productName == ''"}],attrs:{border:"",column:3,"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),height:e.$baseTableHeight(0)-60,size:"'medium'"}},[i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.productname")}},[e._v(" "+e._s(e.productdetail.name)+" ")]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.ProductSecret")}},[0==e.isshow?i("span",[e._v(" ******************** "),i("el-link",{staticStyle:{"margin-left":"5px",cursor:"pointer"},attrs:{type:"primary",underline:!1},on:{click:function(t){e.isshow=!0}}},[e._v(" "+e._s(e.$translateTitle("product.display"))+" ")])],1):i("span",[i("span",{directives:[{name:"copyText",rawName:"v-copyText",value:e.ProductSecret,expression:"ProductSecret"}]},[e._v(e._s(e.ProductSecret))]),i("el-link",{staticStyle:{"margin-left":"5px",cursor:"pointer"},attrs:{type:"primary",underline:!1},on:{click:function(t){e.isshow=!1}}},[e._v(" "+e._s(e.$translateTitle("product.hidden"))+" ")])],1)]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.numberofequipment")}},[i("el-link",{staticStyle:{"margin-left":"10px","font-size":"16px"},attrs:{type:"primary",underline:!1},nativeOn:{click:function(t){return e.goToDevices.apply(null,arguments)}}},[e._v(" "+e._s(e.form.ProductAll)+" ")])],1),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.nodetype")}},[1==e.productdetail.nodeType?i("td",{staticClass:"notbottom"},[e._v(" "+e._s(e.$translateTitle("product.gateway"))+" ")]):i("td",{staticClass:"notbottom"},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")])]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.addingtime")}},[e._v(" "+e._s(e.productdetail.createdAt)+" ")]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("deviceLog.productid")}},[e._v(" "+e._s(e.productdetail.objectId)+" ")]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.classification")}},[e._v(" "+e._s(e.productdetail.categoryname)+" ")]),i("el-descriptions-item",[i("template",{slot:"label"},[i("el-tooltip",{staticStyle:{"margin-left":"5px",color:"#cccccc"},attrs:{content:e.$translateTitle("product.text1"),effect:"light",placement:"top"}},[i("i",{staticClass:"el-icon-question"})]),e._v(" "+e._s(e.$translateTitle("product.dynamicregistration"))+" ")],1),0==e.dynamicReg?i("span",{staticStyle:{color:"#cccccc"}},[e._v(" "+e._s(e.$translateTitle("product.close"))+" ")]):i("span",[e._v(e._s(e.$translateTitle("product.open")))]),i("el-switch",{attrs:{"active-color":"#5eb058","active-value":!0,"inactive-color":"#cccccc","inactive-value":!1},on:{change:function(t){return e.handelUpdate(t,e.dynamicReg)}},model:{value:e.dynamicReg,callback:function(t){e.dynamicReg=t},expression:"dynamicReg"}})],2),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.networking")}},["CELLULAR"==e.productdetail.netType?i("td",[e._v(" "+e._s(e.$translateTitle("product.honeycomb"))+"(2G/3G/4G) ")]):"WIFI"==e.productdetail.netType?i("td",[e._v("WiFi")]):"ETHERNET"==e.productdetail.netType?i("td",[e._v(" "+e._s(e.$translateTitle("product.ethernet"))+" ")]):"LORA"==e.productdetail.netType?i("td",[e._v("LoRaWAN")]):i("td",[e._v(" "+e._s(e.productdetail.netType)+" ")])]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("developer.describe")}},[e._v(" "+e._s(e.productdetail.desc||"")+" ")]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.physicalmodel")}},[i("el-button",{attrs:{disabled:0==e.productInfo.thing.properties.length,type:"text"},on:{click:function(t){e.activeName="third"}}},[e._v(" "+e._s(e.productInfo.thing.properties.length||0)+" ")])],1),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.parser")}},[i("template",{slot:"label"},[i("el-link",{attrs:{type:"success"},nativeOn:{click:function(t){e.amisShow=!e.amisShow}}},[e._v(" "+e._s(e.$translateTitle("product.parser"))+" ")])],1),i("el-link",{attrs:{type:e.amisproductInfo.length?"success":"default"},nativeOn:{click:function(t){e.amisShow=!e.amisShow}}},[e._v(" "+e._s(e.amisproductInfo.length||0)+" ")])],2)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.amisShow,expression:"amisShow"}],staticClass:"amis"},[i("dgiot-views",{attrs:{"view-form":e.viewForm}})],1)],1)]),i("el-tab-pane",{attrs:{label:"Topic"+e.$translateTitle("product.list"),name:"second"}},[i("div",{staticClass:"card-container"},[i("a-tabs",{attrs:{type:"card"},on:{change:e.topicChange}},[i("a-tab-pane",{key:"basic",attrs:{tab:"基础通信Topic"}},[i("el-table",{ref:"basic",staticStyle:{width:"100%","margin-top":"20px"},attrs:{border:"",data:e.dlinkTopic.basic,"span-method":e.basicMethod}},[i("el-table-column",{attrs:{label:"功能",prop:"category",width:"180"}}),i("el-table-column",{attrs:{label:"topic",prop:"topic"}}),i("el-table-column",{attrs:{label:"描述",prop:"desc"}}),i("el-table-column",{attrs:{label:"唯一标识",prop:"id"}}),i("el-table-column",{attrs:{label:"发布者",prop:"publisher"}}),i("el-table-column",{attrs:{label:"订阅者",prop:"subscribe"}}),i("el-table-column",{attrs:{label:"类型",prop:"type"}})],1)],1),i("a-tab-pane",{key:"thing",attrs:{tab:"物模型通信Topic"}},[i("el-table",{ref:"thing",staticStyle:{width:"100%","margin-top":"20px"},attrs:{border:"",data:e.dlinkTopic.thing,"span-method":e.thingMethod}},[i("el-table-column",{attrs:{label:"功能",prop:"category",width:"180"}}),i("el-table-column",{attrs:{label:"topic",prop:"topic"}}),i("el-table-column",{attrs:{label:"描述",prop:"desc"}}),i("el-table-column",{attrs:{label:"描述",prop:"type"}})],1)],1),i("a-tab-pane",{key:"user",attrs:{tab:"自定义Topic"}},[i("div",{staticStyle:{"box-sizing":"border-box",padding:"10px",background:"#ffffff"}},[i("dgiot-query-form",[i("dgiot-query-form-left-panel",[i("div",{staticClass:"addtopic"},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){e.topicdialogVisible=!0}}},[e._v(" "+e._s(e.$translateTitle("product.customtopicclass"))+" ")])],1)]),i("dgiot-query-form-right-panel",[i("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1)],1),i("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.topicData,height:e.$baseTableHeight(0)-60},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{align:"center",label:"name",prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:"value",prop:"value","show-overflow-tooltip":"",sortable:"",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:"topic",prop:"topic","show-overflow-tooltip":"",sortable:"",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:"描述",prop:"desc","show-overflow-tooltip":"",sortable:"",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:"唯一标识",prop:"id","show-overflow-tooltip":"",sortable:"",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:"发布者",prop:"publisher","show-overflow-tooltip":"",sortable:"",width:"100"}}),i("el-table-column",{attrs:{align:"center",label:"订阅者",prop:"subscribe","show-overflow-tooltip":"",sortable:"",width:"100"}}),i("el-table-column",{attrs:{align:"center",label:"订阅类型",prop:"type","show-overflow-tooltip":"",sortable:"",width:"100"}}),i("el-table-column",{attrs:{align:"center",label:"所属类型",prop:"info","show-overflow-tooltip":"",sortable:"",width:"100"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,o=t.$index;return[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.updatetopic(a,o)}}},[e._v(" "+e._s(e.$translateTitle("developer.edit"))+" ")]),i("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletetopic(e.topicData,a,o)}},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1)],1)])],1)],1),i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.definetopicclass"),visible:e.topicdialogVisible,width:"40%"},on:{"update:visible":function(t){e.topicdialogVisible=t}}},[i("div",{staticClass:"topiccontent"},[i("div",{staticStyle:{"box-sizing":"border-box",padding:"10px","font-size":"16px",background:"#e6f9fc"}},[i("i",{staticClass:"el-icon-warning"}),e._v(" "+e._s(e.$translateTitle("product.text2"))+" ")]),i("div",{staticClass:"topicform"},[i("el-form",{ref:"topicform",attrs:{model:e.topicform,rules:e.topicrule}},[i("el-form-item",{attrs:{label:"所属类型：",prop:"info"}},[i("el-radio-group",{model:{value:e.topicform.info,callback:function(t){e.$set(e.topicform,"info",t)},expression:"topicform.info"}},[i("el-radio",{attrs:{label:"basic"}},[e._v("基础通信")]),i("el-radio",{attrs:{label:"thing"}},[e._v("物模型通信")])],1)],1),i("el-form-item",{attrs:{label:"官方 Topic：",prop:"topic"}},[i("el-select",{staticStyle:{float:"left",width:"91%"},attrs:{"allow-create":"",filterable:"",placeholder:"请选择活动区域"},model:{value:e.topicform.topic,callback:function(t){e.$set(e.topicform,"topic",t)},expression:"topicform.topic"}},e._l(e.dlinkTopic[e.topicform.info],(function(t,a){return i("el-option",{key:a,attrs:{label:t.topic,value:t.id}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.topic))]),i("span",{staticStyle:{float:"right","font-size":"13px",color:"#8492a6"}},[e._v(" "+e._s(t.id)+" ")])])})),1),i("dgiot-help",{staticStyle:{width:"60px","margin-top":"24px"},attrs:{src:"https://gitee.com/dgiiot/dgiot_dlink",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1),i("el-form-item",{attrs:{label:"Topic value：",prop:"topic"}},[i("el-input",{staticStyle:{float:"left",width:"100%"},model:{value:e.topicform.value,callback:function(t){e.$set(e.topicform,"value",t)},expression:"topicform.value"}})],1)],1)],1)]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.topicdialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.subTopic("topicform",e.topicform.isupdated)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1),i("el-tab-pane",{attrs:{label:e.$translateTitle("product.physicalmodel"),name:"third"}},[i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.addMachine"),visible:e.machine,width:"30%"},on:{"update:visible":function(t){e.machine=t}}},[i("div",[i("el-form",{ref:"sizeForm",attrs:{"label-position":"left","label-width":"80px",model:e.machineForm,size:"mini"}},[i("el-row",{attrs:{gutter:24}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:e.$translateTitle("product.devicetype"),prop:"devicetype"}},[i("el-input",{model:{value:e.machineForm.name,callback:function(t){e.$set(e.machineForm,"name",t)},expression:"machineForm.name"}})],1)],1)],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){e.machine=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),i("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.savemachine(e.machineForm)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),i("div",[i("a-drawer",{attrs:{closable:!1,title:e.wmxSituation+"物模型事件",visible:e.atbas.visible&&"events"===e.modules.type,width:"620"},on:{close:e.onClose}},[i("el-form",{directives:[{name:"show",rawName:"v-show",value:"services"==e.modules.type,expression:"modules.type == 'services'"}],ref:"services",attrs:{"label-position":"right","label-width":"80px",model:e.modules.services.data,rules:e.modules.services.rules,size:"mini"}},[i("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[i("el-input",{model:{value:e.modules.services.data.name,callback:function(t){e.$set(e.modules.services.data,"name",t)},expression:"modules.services.data.name"}})],1),i("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[i("el-input",{model:{value:e.modules.services.data.identifier,callback:function(t){e.$set(e.modules.services.data,"identifier",t)},expression:"modules.services.data.identifier"}})],1),i("el-form-item",{attrs:{label:"调用方式",prop:"transfer"}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.services.data.transfer,callback:function(t){e.$set(e.modules.services.data,"transfer",t)},expression:"modules.services.data.transfer"}},[i("el-radio",{attrs:{border:"",label:"sync"}},[e._v("同步")]),i("el-radio",{attrs:{border:"",label:"async"}},[e._v("异步")])],1)],1),i("el-form-item",{attrs:{label:"输入参数",prop:"enter"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择输出参数"},model:{value:e.modules.services.data.enter,callback:function(t){e.$set(e.modules.services.data,"enter",t)},expression:"modules.services.data.enter"}},e._l(e.wmxDataBk,(function(t){return i("el-option",{key:t.name,attrs:{label:t.name,value:t.identifier}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),i("span",{staticStyle:{float:"right","font-size":"13px",color:"#8492a6"}},[e._v(" "+e._s(t.name)+" ")])])})),1)],1),i("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择输出参数"},model:{value:e.modules.services.data.output,callback:function(t){e.$set(e.modules.services.data,"output",t)},expression:"modules.services.data.output"}},e._l(e.wmxDataBk,(function(t){return i("el-option",{key:t.name,attrs:{label:t.identifier,value:t.identifier}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),i("span",{staticStyle:{float:"right","font-size":"13px",color:"#8492a6"}},[e._v(" "+e._s(t.identifier)+" ")])])})),1)],1),i("el-form-item",{attrs:{label:"描述",prop:"describe"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.modules.services.data.describe,callback:function(t){e.$set(e.modules.services.data,"describe",t)},expression:"modules.services.data.describe"}})],1),i("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("services",e.modules.services)}}},[e._v(" 确认 ")]),i("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:"events"==e.modules.type,expression:"modules.type == 'events'"}],ref:"events",attrs:{"label-position":"right","label-width":"80px",model:e.modules.events.data,rules:e.modules.events.rules,size:"mini"}},[i("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[i("el-input",{model:{value:e.modules.events.data.name,callback:function(t){e.$set(e.modules.events.data,"name",t)},expression:"modules.events.data.name"}})],1),i("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[i("el-input",{model:{value:e.modules.events.data.identifier,callback:function(t){e.$set(e.modules.events.data,"identifier",t)},expression:"modules.events.data.identifier"}})],1),i("el-form-item",{attrs:{label:"事件类型",prop:"types"}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.events.data.types,callback:function(t){e.$set(e.modules.events.data,"types",t)},expression:"modules.events.data.types"}},[i("el-radio",{attrs:{label:"info"}},[e._v("信息")]),i("el-radio",{attrs:{label:"warning"}},[e._v("告警")]),i("el-radio",{attrs:{label:"error"}},[e._v("故障")])],1)],1),i("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[i("a-list",{attrs:{"data-source":e.modules.events.data.output,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(t,a){return i("a-list-item",{},[i("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(i){return e.editEvent(t,a,"output")}},slot:"actions"},[e._v(" 编辑 ")]),i("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.events.data.output.splice(a,1)}},slot:"actions"},[e._v(" 删除 ")]),i("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[i("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(t.identifier)+" ")])],1)],1)}}])}),i("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[i("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),i("el-form-item",{attrs:{label:"描述",prop:"describe"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.modules.events.data.describe,callback:function(t){e.$set(e.modules.events.data,"describe",t)},expression:"modules.events.data.describe"}})],1),i("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("events",e.modules.events)}}},[e._v(" 确认 ")]),i("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),i("a-drawer",{attrs:{closable:!1,title:"add"==e.eventType?"新增":"修改"+e.thingType=="events"?"事件定义":"服务定义",visible:e.atbas.childrenDrawer,width:"550"},on:{close:e.onChildrenDrawerClose}},[i("thing-form",{ref:"thingForm",attrs:{"dlink-unit":e.dlinkUnit,"event-type":e.eventType,"form-type":e.formType,"rule-form":e.eventForm},on:{OutputParameters:e.thingParameters,editParameters:e.editParameters}})],1),i("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}})],1),i("a-drawer",{attrs:{closable:!1,title:e.wmxSituation+"物模型服务",visible:e.atbas.visible&&"services"===e.modules.type,width:"620"},on:{close:e.onClose}},[i("el-form",{directives:[{name:"show",rawName:"v-show",value:"services"==e.modules.type,expression:"modules.type == 'services'"}],ref:"services",attrs:{"label-position":"right","label-width":"80px",model:e.modules.services.data,rules:e.modules.services.rules,size:"mini"}},[i("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[i("el-input",{model:{value:e.modules.services.data.name,callback:function(t){e.$set(e.modules.services.data,"name",t)},expression:"modules.services.data.name"}})],1),i("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[i("el-input",{model:{value:e.modules.services.data.identifier,callback:function(t){e.$set(e.modules.services.data,"identifier",t)},expression:"modules.services.data.identifier"}})],1),i("el-form-item",{attrs:{label:"调用方式",prop:"transfer"}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.services.data.transfer,callback:function(t){e.$set(e.modules.services.data,"transfer",t)},expression:"modules.services.data.transfer"}},[i("el-radio",{attrs:{border:"",label:"sync"}},[e._v("同步")]),i("el-radio",{attrs:{border:"",label:"async"}},[e._v("异步")])],1)],1),i("el-form-item",{attrs:{label:"输入参数",prop:"enter"}},[i("a-list",{attrs:{"data-source":e.modules.services.data.enter,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(t,a){return i("a-list-item",{},[i("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(i){return e.editEvent(t,a,"enter")}},slot:"actions"},[e._v(" 编辑 ")]),i("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.services.data.enter.splice(a,1)}},slot:"actions"},[e._v(" 删除 ")]),i("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[i("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(t.identifier)+" ")])],1)],1)}}])}),i("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[i("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),i("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[i("a-list",{attrs:{"data-source":e.modules.services.data.output,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(t,a){return i("a-list-item",{},[i("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(i){return e.editEvent(t,a,"output")}},slot:"actions"},[e._v(" 编辑 ")]),i("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.services.data.output.splice(a,1)}},slot:"actions"},[e._v(" 删除 ")]),i("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[i("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(t.identifier)+" ")])],1)],1)}}])}),i("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[i("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),i("el-form-item",{attrs:{label:"描述",prop:"describe"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.modules.services.data.describe,callback:function(t){e.$set(e.modules.services.data,"describe",t)},expression:"modules.services.data.describe"}})],1),i("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("services",e.modules.services)}}},[e._v(" 确认 ")]),i("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),i("el-form",{directives:[{name:"show",rawName:"v-show",value:"events"==e.modules.type,expression:"modules.type == 'events'"}],ref:"events",attrs:{"label-position":"right","label-width":"80px",model:e.modules.events.data,rules:e.modules.events.rules,size:"mini"}},[i("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[i("el-input",{model:{value:e.modules.events.data.name,callback:function(t){e.$set(e.modules.events.data,"name",t)},expression:"modules.events.data.name"}})],1),i("el-form-item",{attrs:{label:"标识符",prop:"identifier"}},[i("el-input",{model:{value:e.modules.events.data.identifier,callback:function(t){e.$set(e.modules.events.data,"identifier",t)},expression:"modules.events.data.identifier"}})],1),i("el-form-item",{attrs:{label:"事件类型",prop:"types"}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:e.modules.events.data.types,callback:function(t){e.$set(e.modules.events.data,"types",t)},expression:"modules.events.data.types"}},[i("el-radio",{attrs:{label:"info"}},[e._v("信息")]),i("el-radio",{attrs:{label:"warning"}},[e._v("告警")]),i("el-radio",{attrs:{label:"error"}},[e._v("故障")])],1)],1),i("el-form-item",{attrs:{label:"输出参数",prop:"output"}},[i("a-list",{attrs:{"data-source":e.modules.events.data.output,"item-layout":"horizontal"},scopedSlots:e._u([{key:"renderItem",fn:function(t,a){return i("a-list-item",{},[i("el-button",{attrs:{slot:"actions",type:"info"},nativeOn:{click:function(i){return e.editEvent(t,a,"output")}},slot:"actions"},[e._v(" 编辑 ")]),i("el-button",{attrs:{slot:"actions",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.modules.events.data.output.splice(a,1)}},slot:"actions"},[e._v(" 删除 ")]),i("a-list-item-meta",{staticStyle:{border:"1px solid #e1e2e5"}},[i("el-tag",{attrs:{slot:"title",type:"success"},slot:"title"},[e._v(" 参数名称:"+e._s(t.identifier)+" ")])],1)],1)}}])}),i("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.showChildrenDrawer.apply(null,arguments)}}},[i("a-icon",{attrs:{type:"plus"}}),e._v(" 增加参数 ")],1)],1),i("el-form-item",{attrs:{label:"描述",prop:"describe"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.modules.events.data.describe,callback:function(t){e.$set(e.modules.events.data,"describe",t)},expression:"modules.events.data.describe"}})],1),i("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"large"}},[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.submitModules("events",e.modules.events)}}},[e._v(" 确认 ")]),i("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.handleClose.apply(null,arguments)}}},[e._v(" 取消 ")])],1)],1),i("a-drawer",{attrs:{closable:!1,title:(e.eventType,"events"==e.thingType?"事件定义":"服务定义"),visible:e.atbas.childrenDrawer,width:"550"},on:{close:e.onChildrenDrawerClose}},[i("thing-form",{ref:"thingForm",attrs:{"dlink-unit":e.dlinkUnit,"event-type":e.eventType,"rule-form":e.eventForm},on:{OutputParameters:e.thingParameters,editParameters:e.editParameters}})],1),i("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}})],1)],1),i("el-tabs",{on:{"tab-click":e.handleChildClick},model:{value:e.tabsChild,callback:function(t){e.tabsChild=t},expression:"tabsChild"}},[i("el-tab-pane",{attrs:{label:"属性定义",name:"properties"}},[i("div",[i("el-row",{attrs:{gutter:24}},[i("el-col",{attrs:{lg:4,md:5,sm:6,xl:3,xs:24}},[i("dgiot-query-form",{staticClass:"query-form"},[i("dgiot-query-form-top-panel",[i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addMachine.apply(null,arguments)}}},[e._v(" 添加类型 ")])],1)],1),i("el-table",{staticStyle:{width:"60vh",overflow:"auto"},attrs:{border:"",data:e.FromMachine,height:e.$baseTableHeight(0)-60,"row-class-name":e.tableRowClassName},on:{"row-click":e.clickmachine},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{align:"center",label:"序号",prop:"sort",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[i("span",[e._v(" "+e._s(a+1)+" ")])]}}])}),i("el-table-column",{attrs:{align:"center",label:"设备类型",prop:"name"}})],1)],1),i("el-col",{attrs:{lg:20,md:19,sm:18,xl:21,xs:24}},[i("dgiot-query-form",{staticClass:"query-form"},[i("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[i("div",{staticClass:"stripe-panel"},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkAddTest.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.collectionformulaofobjectmodel"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("properties")}}},[e._v(" "+e._s(e.$translateTitle("product.newcustomattribute"))+" ")])],1)])],1),i("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.wmxData.slice((e.wmxstart-1)*e.wmxPageSize,e.wmxstart*e.wmxPageSize),"default-expand-all":!1,"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-descriptions",{attrs:{border:"",column:4,direction:"vertical"}},[i("el-descriptions-item",{attrs:{label:"采集轮次"}},[e._v(" "+e._s(t.row.dataForm.round)+" ")]),i("el-descriptions-item",{attrs:{label:e.$translateTitle("product.functionaltypes")}},[e._v(" "+e._s(e.$translateTitle("product.attribute"))+" ")])],1)]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.dataForm.order)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.devicetype"),prop:"devicetype"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.Strategy")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.dataForm.strategy)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocol")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.dataForm.protocol)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier"),prop:"identifier"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionname"),prop:"name"}}),i("el-table-column",{attrs:{align:"center",label:"是否存储",prop:"name",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("a-switch",{attrs:{checked:a.isshow,"checked-children":"存储","un-checked-children":"不存储"},on:{click:function(t){return e.toggleSwitch(a)}}})]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datatype"),width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.dataType.type))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datadefinition")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[!a.dataType.specs||"double"!=a.dataType.type&&"float"!=a.dataType.type&&"int"!=a.dataType.type?"string"==a.dataType.type?i("span",[e._v(" "+e._s(e.$translateTitle("product.datalength")+":"+a.dataType.size+e.$translateTitle("product.byte"))+" ")]):"date"==a.dataType.type?i("span"):"struct"!=a.dataType.type?i("span",[e._v(" "+e._s(a.dataType.specs)+" ")]):i("span"):i("span",[e._v(" "+e._s(e.$translateTitle("product.rangeofvalues")+a.dataType.specs.min+"~"+a.dataType.specs.max)+" ")])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,o=t.$index;return[i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,o)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,o,"properties")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),i("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.wmxPageSize,"page-sizes":[10,20,30,50],total:e.wmxData.length},on:{"current-change":e.wmxCurrentChange,"size-change":e.wmxSizeChange}})],1)],1)],1)]),i("el-tab-pane",{attrs:{label:"事件定义",name:"events"}},[i("dgiot-query-form",{staticClass:"query-form"},[i("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[i("div",{staticClass:"stripe-panel"},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("events")}}},[e._v(" 新增事件 ")])],1)])],1),i("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.modules.data.events.slice((e.eventsStart-1)*e.eventsPageSize,e.eventsStart*e.eventsPageSize),"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{prop:"输出参数",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{staticClass:"demo-table-expand",attrs:{inline:"","label-position":"left"}},e._l(t.row.output,(function(t,a){return i("a-descriptions",{key:a,attrs:{bordered:"",title:"输出参数:"+t.name}},[i("a-descriptions-item",{attrs:{label:"标识符"}},[e._v(" "+e._s(t.identifier)+" ")]),i("a-descriptions-item",{attrs:{label:"数据类型"}},[e._v(" "+e._s(t.dataType)+" ")]),i("a-descriptions-item",{attrs:{label:"取值范围"}},[e._v(" 最小值:"+e._s(t.min)+" 最大值:"+e._s(t.max)+" ")]),i("a-descriptions-item",{attrs:{label:"步长"}},[e._v(" "+e._s(t.step)+" ")]),i("a-descriptions-item",{attrs:{label:"单位"}},e._l(e.dlinkUnit,(function(a,o){return i("el-tag",{directives:[{name:"show",rawName:"v-show",value:a.Symbol==t.unit,expression:"Unit.Symbol == item.unit"}],key:o,attrs:{type:"success"}},[i("span",[e._v(" "+e._s(a.Name)+" ")])])})),1),i("a-descriptions-item",{attrs:{label:"读写类型"}},[e._v(" "+e._s("rw"==t.isread?"读写":"只读")+" ")])],1)})),1)]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),prop:"dataForm.order",sortable:"",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier"),prop:"identifier",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionname"),prop:"name"}}),i("el-table-column",{attrs:{align:"center",label:"事件类型",prop:"types",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(" "+e._s(["信息","告警","故障"][["info","warning","error"].indexOf(a.types)])+" ")])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,o=t.$index;return[i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,o)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,o,"events")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),i("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.eventsPageSize,"page-sizes":[10,20,30,50],total:e.modules.data.events.length},on:{"current-change":e.eventsCurrentChange,"size-change":e.eventsChange}})],1),i("el-tab-pane",{attrs:{label:"服务定义",name:"services"}},[i("dgiot-query-form",{staticClass:"query-form"},[i("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[i("div",{staticClass:"stripe-panel"},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("services")}}},[e._v(" 新增服务 ")])],1)])],1),i("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.modules.data.services.slice((e.servicesStart-1)*e.servicesPageSize,e.servicesStart*e.servicesPageSize),"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{prop:"输出参数",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{staticClass:"demo-table-expand",attrs:{inline:"","label-position":"left"}},e._l(t.row.enter,(function(t,a){return i("a-descriptions",{key:a,attrs:{bordered:"",title:"输入参数:"+t.name}},[i("a-descriptions-item",{attrs:{label:"标识符"}},[e._v(" "+e._s(t.identifier)+" ")]),i("a-descriptions-item",{attrs:{label:"数据类型"}},[e._v(" "+e._s(t.dataType)+" ")]),i("a-descriptions-item",{attrs:{label:"取值范围"}},[e._v(" 最小值:"+e._s(t.min)+" 最大值:"+e._s(t.max)+" ")]),i("a-descriptions-item",{attrs:{label:"步长"}},[e._v(" "+e._s(t.step)+" ")]),i("a-descriptions-item",{attrs:{label:"单位"}},e._l(e.dlinkUnit,(function(a,o){return i("el-tag",{directives:[{name:"show",rawName:"v-show",value:a.Symbol==t.unit,expression:"Unit.Symbol == item.unit"}],key:o,attrs:{type:"success"}},[i("span",[e._v(" "+e._s(a.Name)+" ")])])})),1),i("a-descriptions-item",{attrs:{label:"读写类型"}},[e._v(" "+e._s("rw"==t.isread?"读写":"只读")+" ")])],1)})),1),i("el-form",{staticClass:"demo-table-expand",attrs:{inline:"","label-position":"left"}},e._l(t.row.output,(function(t,a){return i("a-descriptions",{key:a,attrs:{bordered:"",title:"输出参数:"+t.name}},[i("a-descriptions-item",{attrs:{label:"标识符"}},[e._v(" "+e._s(t.identifier)+" ")]),i("a-descriptions-item",{attrs:{label:"数据类型"}},[e._v(" "+e._s(t.dataType)+" ")]),i("a-descriptions-item",{attrs:{label:"取值范围"}},[e._v(" 最小值:"+e._s(t.min)+" 最大值:"+e._s(t.max)+" ")]),i("a-descriptions-item",{attrs:{label:"步长"}},[e._v(" "+e._s(t.step)+" ")]),i("a-descriptions-item",{attrs:{label:"单位"}},e._l(e.dlinkUnit,(function(a,o){return i("el-tag",{directives:[{name:"show",rawName:"v-show",value:a.Symbol==t.unit,expression:"Unit.Symbol == item.unit"}],key:o,attrs:{type:"success"}},[i("span",[e._v(" "+e._s(a.Name)+" ")])])})),1),i("a-descriptions-item",{attrs:{label:"读写类型"}},[e._v(" "+e._s("rw"==t.isread?"读写":"只读")+" ")])],1)})),1)]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.dataForm.order)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:"标识符",prop:"identifier",width:"auto"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datatype"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.dataType.type))])]}}])}),i("el-table-column",{attrs:{align:"center",label:"调用方式",prop:"types",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(" "+e._s(["同步","异步"][["sync","async"].indexOf(a.transfer)])+" ")])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,o=t.$index;return[i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,o)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,o,"services")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),i("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.servicesPageSize,"page-sizes":[10,20,30,50],total:e.modules.data.services.length},on:{"current-change":e.serverCurrentChange,"size-change":e.serverSizeChange}})],1),i("el-tab-pane",{attrs:{label:"标签定义",name:"tags"}},[i("dgiot-query-form",{staticClass:"query-form"},[i("dgiot-query-form-right-panel",{staticStyle:{width:"100%"}},[i("div",{staticClass:"stripe-panel"},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createThing("tags")}}},[e._v(" 新增标签 ")])],1)])],1),i("el-table",{key:"tabsChild",staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.modules.data.tags.slice((e.tagsStart-1)*e.tagsPageSize,e.tagsStart*e.tagsPageSize),"default-sort":{prop:"date",order:"descending"},height:e.$baseTableHeight(0)-60,"row-key":"identifier"},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.dataForm.order)+" ")]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier"),prop:"identifier",width:"100"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionname"),prop:"name"}}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datatype"),width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.dataType.type))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datadefinition")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[!a.dataType.specs||"double"!=a.dataType.type&&"float"!=a.dataType.type&&"int"!=a.dataType.type?"string"==a.dataType.type?i("span",[e._v(" "+e._s(e.$translateTitle("product.datalength")+":"+a.dataType.size+e.$translateTitle("product.byte"))+" ")]):"date"==a.dataType.type?i("span"):"struct"!=a.dataType.type?i("span",[e._v(" "+e._s(a.dataType.specs)+" ")]):i("span"):i("span",[e._v(" "+e._s(e.$translateTitle("product.rangeofvalues")+a.dataType.specs.min+"~"+a.dataType.specs.max)+" ")])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,o=t.$index;return[i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(a,o)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(a,o,"tags")}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1),i("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.tagsPageSize,"page-sizes":[10,20,30,50],total:e.modules.data.tags.length},on:{"current-change":e.tagsCurrentChange,"size-change":e.tagsSizeChange}})],1)],1),i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.addfunction"),visible:e.originwmx,width:"50%"},on:{"update:visible":function(t){e.originwmx=t}}},[i("div",[i("div",{staticStyle:{margin:"20px 0"}},[i("label",{attrs:{for:""}},[e._v(" "+e._s(e.$translateTitle("product.classification"))+" ")]),i("el-cascader",{attrs:{options:e.treeData},on:{change:e.handleChange},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}}),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.getPropData(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),i("div",{staticStyle:{"margin-top":"10px","text-align":"center"}},[i("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.PropData},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.data.SuperId))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.type))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.applicabletype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.data.CategoryName))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addProCategory(a)}}},[e._v(" "+e._s(e.$translateTitle("product.add"))+" ")])]}}])})],1)],1),i("div",[i("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.productlength,"page-sizes":[10,20,30,50],small:"",total:e.producttotal},on:{"current-change":e.productCurrentChange,"size-change":e.productSizeChange}})],1)]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){e.originwmx=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){e.originwmx=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),i("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.wmxhandleClose,"close-on-click-modal":!1,fullscreen:"properties"==e.moduletype,title:e.wmxSituation+"自定义属性",top:"properties"==e.moduletype?"0vh":"10vh",visible:e.wmxdialogVisible,width:"properties"==e.moduletype?"100%":"80%"},on:{"update:visible":function(t){e.wmxdialogVisible=t}}},[e.wmxdialogVisible?i("dgiot-wmx",{key:e.upKey,ref:"sizeForm",attrs:{moduletype:e.moduletype,"size-form1":e.sizeForm},on:{addDas:e.addDas,addDomain:e.addDomain,removeDas:e.removeDas,removeDomain:e.removeDomain,submitForm:e.submitForm,wmxhandleClose:function(t){return e.wmxhandleClose("close")}}}):e._e()],1),i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.addparameter"),top:"15vh",visible:e.structdialog,width:"40%"},on:{"update:visible":function(t){e.structdialog=t}}},[i("div",{staticClass:"structheader"},[i("el-form",{ref:"structform",attrs:{model:e.structform,rules:e.structrule,size:"small"}},[i("el-row",{attrs:{gutter:30}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:e.$translateTitle("product.functionname"),prop:"name"}},[i("el-input",{model:{value:e.structform.name,callback:function(t){e.$set(e.structform,"name",t)},expression:"structform.name"}})],1),i("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[i("el-input",{model:{value:e.structform.identifier,callback:function(t){e.$set(e.structform,"identifier",t)},expression:"structform.identifier"}})],1)],1),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:e.$translateTitle("product.datatype"),prop:"type"}},[i("el-select",{model:{value:e.structform.type,callback:function(t){e.$set(e.structform,"type",t)},expression:"structform.type"}},[i("el-option",{attrs:{label:e.$translateTitle("product.init"),value:"int"}}),i("el-option",{attrs:{label:e.$translateTitle("product.float"),value:"float"}}),i("el-option",{attrs:{label:e.$translateTitle("product.double"),value:"double"}}),i("el-option",{attrs:{label:e.$translateTitle("product.bool"),value:"bool"}}),i("el-option",{attrs:{label:e.$translateTitle("product.enum"),value:"enum"}}),i("el-option",{attrs:{label:e.$translateTitle("product.string"),value:"string"}}),i("el-option",{attrs:{label:e.$translateTitle("product.date"),value:"date"}})],1)],1)],1)],1),i("div",[i("el-form-item",{attrs:{label:"数据标识",required:""}},[i("el-col",{attrs:{span:11}},[i("el-form-item",{attrs:{prop:"dis"}},[i("el-input",{attrs:{placeholder:"数据标识"},model:{value:e.structform.dis,callback:function(t){e.$set(e.structform,"dis",t)},expression:"structform.dis"}})],1)],1),i("el-col",{attrs:{span:2}},[e._v("-")]),i("el-col",{attrs:{span:11}},[i("el-form-item",[i("el-input",{attrs:{placeholder:"数据长度(字节)"},model:{value:e.structform.dinumber,callback:function(t){e.$set(e.structform,"dinumber",e._n(t))},expression:"structform.dinumber"}})],1)],1)],1)],1),i("div",[i("el-form-item",{attrs:{label:"取值范围",required:""}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{prop:"startnumber"}},[i("el-input",{attrs:{placeholder:e.$translateTitle("product.minimumvalue"),type:"number"},on:{input:function(t){return e.changeStructValue("structform")}},model:{value:e.structform.startnumber,callback:function(t){e.$set(e.structform,"startnumber",e._n(t))},expression:"structform.startnumber"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{prop:"endnumber"}},[i("el-input",{attrs:{placeholder:e.$translateTitle("product.maximumvalue"),type:"number"},model:{value:e.structform.endnumber,callback:function(t){e.$set(e.structform,"endnumber",e._n(t))},expression:"structform.endnumber"}})],1)],1)],1),i("el-form-item",{attrs:{label:"步长",prop:"step"}},[i("el-input",{attrs:{"controls-position":"right",min:0,precision:2,step:.01},model:{value:e.structform.step,callback:function(t){e.$set(e.structform,"step",t)},expression:"structform.step"}})],1),i("el-form-item",{attrs:{label:e.$translateTitle("product.unit")}},[i("el-select",{attrs:{filterable:"",placeholder:e.$translateTitle("product.unit")},model:{value:e.structform.unit,callback:function(t){e.$set(e.structform,"unit",t)},expression:"structform.unit"}},e._l(e.allunit,(function(e,t){return i("el-option",{key:t,attrs:{label:e.Name+"/"+e.Symbol,value:e.Symbol}})})),1)],1)],1),"bool"==e.structform.type?i("div",[i("el-form-item",{attrs:{label:e.$translateTitle("product.attribute"),required:""}},[i("div",{staticStyle:{height:"40px"}},[i("el-col",{attrs:{span:11}},[i("el-form-item",[i("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.attributevalue"),readonly:"",type:"number"},model:{value:e.structform.truevalue,callback:function(t){e.$set(e.structform,"truevalue",t)},expression:"structform.truevalue"}})],1)],1),i("el-col",{attrs:{span:2}},[e._v("-")]),i("el-col",{attrs:{span:11}},[i("el-form-item",{attrs:{prop:"true"}},[i("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.egopen")},model:{value:e.structform.true,callback:function(t){e.$set(e.structform,"true",t)},expression:"structform.true"}})],1)],1)],1),i("div",{staticStyle:{"margin-top":"20px"}},[i("el-col",{attrs:{span:11}},[i("el-form-item",[i("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.attributevalue"),readonly:"",type:"number"},model:{value:e.structform.falsevalue,callback:function(t){e.$set(e.structform,"falsevalue",t)},expression:"structform.falsevalue"}})],1)],1),i("el-col",{attrs:{span:2}},[e._v("-")]),i("el-col",{attrs:{span:11}},[i("el-form-item",{attrs:{prop:"true"}},[i("el-input",{staticClass:"inputnumber",attrs:{placeholder:e.$translateTitle("product.egclost")},model:{value:e.structform.false,callback:function(t){e.$set(e.structform,"false",t)},expression:"structform.false"}})],1)],1)],1)])],1):e._e(),"enum"==e.structform.type?i("div",[e._l(e.structform.specs,(function(t,a){return i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.structform.specs.length,expression:"structform.specs.length"}],key:a,attrs:{required:""}},[i("el-col",{attrs:{span:9}},[i("el-form-item",{attrs:{label:e.$translateTitle("product.attribute")+a,prop:"specs."+a+".attribute",rules:[{required:!0,message:"输入属性"}]}},[i("el-input",{attrs:{placeholder:e.$translateTitle("product.egnumber0")},model:{value:t.attribute,callback:function(a){e.$set(t,"attribute",a)},expression:"item.attribute"}})],1)],1),i("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),i("el-col",{attrs:{span:9}},[i("el-form-item",{attrs:{label:e.$translateTitle("product.attribute")+a,prop:"specs."+a+".attributevalue",rules:[{required:!0,message:"输入属性值"}]}},[i("el-input",{attrs:{placeholder:e.$translateTitle("developer.describe")},model:{value:t.attributevalue,callback:function(a){e.$set(t,"attributevalue",a)},expression:"item.attributevalue"}})],1)],1),i("el-col",{staticClass:"line",attrs:{span:2}}),i("el-col",{staticClass:"line",attrs:{span:4}},[i("el-link",{staticStyle:{"margin-top":"30px","margin-left":"5px"},attrs:{icon:"el-icon-minus",type:"primary",underline:!1},on:{click:function(a){return a.preventDefault(),e.removeDomain1(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1)],1)})),i("el-link",{attrs:{icon:"el-icon-plus",type:"primary",underline:!1},nativeOn:{click:function(t){return e.addDomain1.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.add"))+" ")])],2):e._e(),"string"==e.structform.type?i("div",[i("el-form-item",{attrs:{label:e.$translateTitle("product.datalength"),prop:"string"}},[i("el-input",{attrs:{type:"number"},model:{value:e.structform.string,callback:function(t){e.$set(e.structform,"string",e._n(t))},expression:"structform.string"}},[i("template",{slot:"append"},[e._v(" "+e._s(e.$translateTitle("product.byte"))+" ")])],2)],1)],1):e._e(),"date"==e.structform.type?i("div",[i("el-form-item",{attrs:{label:e.$translateTitle("product.timeformat")}},[i("el-input",{attrs:{readonly:""},model:{value:e.structform.date,callback:function(t){e.$set(e.structform,"date",t)},expression:"structform.date"}})],1)],1):e._e(),i("el-form-item",{attrs:{label:e.$translateTitle("product.readandwritetype"),prop:"isread"}},[i("el-radio-group",{attrs:{size:"medium"},model:{value:e.structform.isread,callback:function(t){e.$set(e.structform,"isread",t)},expression:"structform.isread"}},[i("el-radio",{attrs:{label:"rw"}},[e._v(" "+e._s(e.$translateTitle("product.readandwrite"))+" ")]),i("el-radio",{attrs:{label:"r"}},[e._v(" "+e._s(e.$translateTitle("product.onlyread"))+" ")])],1)],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.structdialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitStruct("structform")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1),i("el-tab-pane",{staticStyle:{diaplay:"none"},attrs:{disabled:!0,label:e.$translateTitle("product.matteranalysis"),name:"fourth"}},[i("div",{staticClass:"protolheader"},[i("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,rules:e.addRules}},[i("el-form-item",{attrs:{label:e.$translateTitle("product.protocolname"),prop:"name"}},[i("el-input",{attrs:{placeholder:e.$translateTitle("product.protocolname")},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),i("el-form-item",{attrs:{label:e.$translateTitle("plugins.version")}},[i("el-input",{attrs:{placeholder:e.$translateTitle("plugins.version")},model:{value:e.formInline.version,callback:function(t){e.$set(e.formInline,"version",t)},expression:"formInline.version"}})],1),i("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[i("el-input",{attrs:{placeholder:e.$translateTitle("developer.describe")},model:{value:e.formInline.desc,callback:function(t){e.$set(e.formInline,"desc",t)},expression:"formInline.desc"}})],1),i("el-form-item",[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.subAce("formInline",!0)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.subAce1("formInline")}}},[e._v(" "+e._s(e.$translateTitle("product.setaspublic"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.chaxun.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.publicagreementlibrary"))+" ")])],1),i("el-form-item",{staticStyle:{display:"block"}},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.protol.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.compile"))+" ")]),i("el-button",{attrs:{size:"small",type:"success"},nativeOn:{click:function(t){return e.updatesubdialog.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.thermalloading"))+" ")])],1)],1)],1),i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.tdthermalloading"),visible:e.protoldialog,width:"50%"},on:{"update:visible":function(t){e.protoldialog=t}}},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.protolchannel,"row-class-name":e.getChannelEnable},on:{"selection-change":e.handleSelectionChange},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.name))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==a.type?i("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):i("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.cType))])]}}])})],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updateAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.publicagreementlibrary"),visible:e.dialogTableVisible,width:"50%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[i("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.gridData},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocolname")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.data.name))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.data.version))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.data.desc))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.createdAt")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(e.utc2beijing(a.createdAt)))])]}}])}),i("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.editordata(a)}}},[e._v(" "+e._s(e.$translateTitle("product.clone"))+" ")]),i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletedata(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),i("div",{staticClass:"elpagination",staticStyle:{padding:"20px 0"}},[i("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.decoderlength,"page-sizes":[10,20,30,50],total:e.decodertotal},on:{"current-change":e.devicerCurrentChange,"size-change":e.decoderSizeChange}})],1)],1),i("div",[i("div",{staticStyle:{background:"#ffffff"}},[i("label",{attrs:{id:"plug-name1"}})]),i("pre",{staticClass:"ace_editor ace-monokai ace_dark",staticStyle:{"min-height":"600px","margin-bottom":"0"},attrs:{id:"editor"}},[i("textarea",{staticClass:"ace_text-input"})]),i("div",{staticStyle:{background:"#ffffff"}},[i("label",{attrs:{id:"plug-name2"}})]),i("div",{staticStyle:{padding:"5px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[i("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),i("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[i("textarea",{staticClass:"ace_text-input"})])])],1),i("el-tab-pane",{attrs:{label:e.$translateTitle("product.physicalaccess"),name:"fiveth"}},[i("dgiot-query-form",[i("dgiot-query-form-left-panel",[i("div",{staticClass:"productchannel",staticStyle:{padding:"10px","text-align":"right"}},[i("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.showAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.createchannel"))+" ")])],1)]),i("dgiot-query-form-right-panel",[i("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"click"}})],1)],1),i("div",[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.channelData,height:e.$baseTableHeight(0)-60,"row-class-name":e.getChannelEnable},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.name))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==a.type?i("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):3==a.type?i("span",[e._v(" "+e._s(e.$translateTitle("developer.missionchannel"))+" ")]):e._e()]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.cType))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deleteRelation(a)}}},[e._v(" "+e._s(e.$translateTitle("developer.remove"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.subProTopic(a)}}},[e._v(" "+e._s(e.$translateTitle("product.subscriptionlog"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.updatesub(a)}}},[e._v(" "+e._s(e.$translateTitle("product.overloadconfiguration"))+" ")])]}}])})],1),i("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[i("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.channellength,"page-sizes":[10,20,30,50],total:e.channeltotal},on:{"current-change":e.channelCurrentChange,"size-change":e.channelSizeChange}})],1)],1)],1),i("el-tab-pane",{attrs:{label:e.$translateTitle("product.materialstorage"),name:"seven"}},[i("dgiot-query-form",[i("dgiot-query-form-left-panel",[i("div",{staticClass:"productchannel",staticStyle:{padding:"10px","text-align":"right"}},[i("el-popover",{attrs:{placement:"right",title:e.$translateTitle("developer.tipsforcustomdatamodel"),trigger:"hover",width:"600"},on:{show:e.questionModel}},[i("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"400px"},attrs:{id:"editorinsert"}},[i("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"}})],1),i("el-button",{attrs:{slot:"reference",icon:"el-icon-question",size:"mini",type:"primary"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.customizedatamodelhelp"))+" ")])],1),i("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.resourceShowAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.createchannel"))+" ")])],1)]),i("dgiot-query-form-right-panel",[i("dgiot-help",{attrs:{src:"https://tech.iotn2n.com/w/docs/details?id=6",title:"产品下的所有设备都会继承该产品的 Topic 类",trigger:"manual"}})],1)],1),i("div",[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.resourcechannelData,height:e.$baseTableHeight(0)-60,"row-class-name":e.getChannelEnable},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.name))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==a.type?i("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):i("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.cType))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deleteRelation(a)}}},[e._v(" "+e._s(e.$translateTitle("developer.remove"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.subProTopic(a)}}},[e._v(" "+e._s(e.$translateTitle("product.subscriptionlog"))+" ")]),i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.customize(a)}}},[e._v(" "+e._s(e.$translateTitle("product.custommodel"))+" ")])]}}])})],1),i("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[i("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.resourcelength,"page-sizes":[10,20,30,50],total:e.resourcetotal},on:{"current-change":e.resourcechannelCurrentChange,"size-change":e.resourcechannelSizeChange}})],1)],1)],1),i("el-tab-pane",{attrs:{label:"可视化",name:"view"}},[i("dgiot-views",{key:e.activeName,attrs:{"view-form":e.viewForm}})],1)],1)],1),i("el-dialog",{attrs:{"append-to-body":"","before-close":e.handleClose,center:!0,"close-on-click-modal":!0,"close-on-press-escape":!0,"destroy-on-close":!0,modal:!0,title:"events"==e.modules.type?"自定义事件":"自定义服务",visible:e.modules.visible,width:"30%"},on:{"update:visible":function(t){return e.$set(e.modules,"visible",t)}}}),i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.viewobjectmodel"),visible:e.schemadialogVisible},on:{"update:visible":function(t){e.schemadialogVisible=t}}},[i("div",[i("div",{staticStyle:{background:"#ffffff"}},[i("label",{attrs:{id:"plug-name"}})]),i("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"400px"},attrs:{id:"editor1"}},[i("textarea",{staticClass:"ace_text-input",staticStyle:{overflow:"scroll"}})])]),i("span",{staticClass:"dialog-footer",staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.preserve("json")}}},[e._v(" "+e._s(e.$translateTitle("equipment.update"))+" ")])],1)]),i("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("equipment.addchannel"),visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[i("div",{staticClass:"addchannel"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.allchannelData,height:"400"},scopedSlots:e._u([{key:"empty",fn:function(){return[i("el-image",{staticClass:"dgiot-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.name))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s("channel/"+a.objectId))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==a.type?i("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):2==a.type?i("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")]):i("span",[e._v(" "+e._s(e.$translateTitle("developer.missionchannel"))+" ")])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",[e._v(e._s(a.cType))])]}}])}),i("el-table-column",{attrs:{label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addProductChannel(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.add"))+" ")])]}}])})],1),i("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[i("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.allChannellength,"page-sizes":[10,20,30,50],total:e.allChanneltotal},on:{"current-change":e.allChannelCurrentChange,"size-change":e.allChannelSizeChange}})],1)],1)]),i("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleCloseSubdialog,"close-on-click-modal":!1,title:e.channelname+"日志",visible:e.subdialog,width:"85%"},on:{"update:visible":function(t){e.subdialog=t}}},[i("mqtt-log",{attrs:{"channel-id":e.channelname,list:e.msgList,msg:e.submessage,product:e.channelInfo,"refresh-key":e.refreshFlag}})],1),i("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.closeWuDialog,"close-on-click-modal":!1,"show-close":!1,top:"1vh",visible:e.resourcedialogFormVisible,width:"90%"},on:{"update:visible":function(t){e.resourcedialogFormVisible=t}}},[i("el-form",{ref:"resourceform",attrs:{model:e.resourceform}},[i("div",{staticClass:"wumoxing"},[i("el-row",[i("el-col",{attrs:{span:8}},[i("div",{staticClass:"grid-content bg-purple"},[i("el-form-item",{attrs:{label:e.$translateTitle("product.physicalmodel")}},[i("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"600px"},attrs:{id:"editormodel"}},[i("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"}})],1)])],1)]),i("el-col",{attrs:{span:16}},[i("div",{staticClass:"grid-content bg-purple-light"},[i("el-form-item",{attrs:{label:e.$translateTitle("product.customizedatamodel")}},[i("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"600px"},attrs:{id:"editorcreate"}},[i("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"}})],1)])],1)])],1)],1)]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){return e.closeWuDialog.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.quit"))+" ")]),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addData.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1)],1),i("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("product.export"),visible:e.exportDialogShow,width:"25%"},on:{"update:visible":function(t){e.exportDialogShow=t}}},[i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"btn-right",attrs:{size:"small"},nativeOn:{click:function(t){e.exportDialogShow=!1}}},[e._v(" "+e._s(e.$translateTitle("tagsView.close"))+" ")])],1)]),i("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleCloseCollecttion,"close-on-click-modal":!1,fullscreen:!0,title:e.$translateTitle("product.viewcollectionformula"),visible:e.collectionDialogVisible,width:"100%"},on:{"update:visible":function(t){e.collectionDialogVisible=t}}},[i("el-row",[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"diaCollLeftCls"},[i("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeIndex}},[e._l(e.wmxData,(function(t,a){return[i("el-menu-item",{key:a+"",attrs:{index:t.identifier},nativeOn:{click:function(i){return e.menuTabClick(t,a)}}},[t.dataType.specs?i("ol",[e._v(" "+e._s(t.identifier+"        "+t.name+"        取值范围"+t.dataType.specs.min+"~"+t.dataType.specs.max)+" ")]):i("ol",[e._v(" "+e._s(t.identifier+"        "+t.name)+" ")])])]}))],2)],1)]),i("el-col",{attrs:{span:18}},[i("el-tabs",{attrs:{closable:"",type:"card"},on:{"tab-click":e.handleRightTopTabClick,"tab-remove":e.removeTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,(function(t,a){return i("el-tab-pane",{key:t.name,attrs:{label:t.title,name:t.name}},[i("div",{staticClass:"diaCollRightCls"},[i("el-row",{staticStyle:{margin:"10px"}},[i("el-button",{attrs:{type:"success"}},[e._v(" "+e._s(e.$translateTitle("rule.Test"))+" ")]),i("el-button",{attrs:{type:"info"},nativeOn:{click:function(t){return e.onReductionTap(a)}}},[e._v(" "+e._s(e.$translateTitle("product.reduction"))+" ")]),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.onSaveTap(a)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1),i("pre",{staticClass:"ace_editor3",staticStyle:{"min-height":"300px","margin-top":"0","margin-bottom":"0"},attrs:{id:t.name}},[i("textarea",{staticClass:"ace_text-input"})])],1)])})),1)],1)],1)],1)],1)},o=[],r=a("fe51"),s=(a("20fc"),a("2877")),l=Object(s["a"])(r["a"],i,o,!1,null,"f5110e4e",null);t["default"]=l.exports},"6b3d":function(e,t,a){"use strict";a("a490")},78425:function(e,t,a){"use strict";a("9080")},8199:function(e,t,a){"use strict";a.r(t);var i,o,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"things-parse"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:4}},[a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.AllDict,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{label:"ID",prop:"objectId"}}),a("el-table-column",{attrs:{label:e.$translateTitle("task.productname"),prop:"name"}})],1)],1),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"protolheader"},[a("el-form",{ref:"thingsParseModel",attrs:{inline:!0,model:e.thingsParseModel,rules:e.thingsParseRules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.protocolname"),prop:"name"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.protocolname")},model:{value:e.thingsParseModel.name,callback:function(t){e.$set(e.thingsParseModel,"name",t)},expression:"thingsParseModel.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("plugins.version")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("plugins.version")},model:{value:e.thingsParseModel.version,callback:function(t){e.$set(e.thingsParseModel,"version",t)},expression:"thingsParseModel.version"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("developer.describe")},model:{value:e.thingsParseModel.desc,callback:function(t){e.$set(e.thingsParseModel,"desc",t)},expression:"thingsParseModel.desc"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.subAce("thingsParseModel",!0)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.subAce1("thingsParseModel")}}},[e._v(" "+e._s(e.$translateTitle("product.setaspublic"))+" ")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.chaxun}},[e._v(" "+e._s(e.$translateTitle("product.publicagreementlibrary"))+" ")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.protol}},[e._v(" "+e._s(e.$translateTitle("product.compile"))+" ")]),a("el-button",{attrs:{size:"small",type:"success"},on:{click:e.updatesubdialog}},[e._v(" "+e._s(e.$translateTitle("product.thermalloading"))+" ")])],1)],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.tdthermalloading"),visible:e.protoldialog,width:"50%"},on:{"update:visible":function(t){e.protoldialog=t}}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.protolchannel,"row-class-name":e.getChannelEnable},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s("channel/"+i.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[1==i.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.cType))])]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updateAllChannel.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.publicagreementlibrary"),visible:e.dialogTableVisible,width:"50%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.gridData}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocolname")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.data.name))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.data.version))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.data.desc))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("application.createtime")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e.utc2beijing(i.createdAt)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.editordata(i)}}},[e._v(" "+e._s(e.$translateTitle("product.clone"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deletedata(i.ObjectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),a("div",{staticClass:"elpagination",staticStyle:{padding:"20px 0"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.decoderlength,"page-sizes":[10,20,30,50],total:e.decodertotal},on:{"current-change":e.devicerCurrentChange,"size-change":e.decoderSizeChange}})],1)],1),e.AllDict?a("div",[a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name1"}})]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"600px","margin-bottom":"0"},attrs:{id:"editor"}},[a("textarea",{staticClass:"ace_text-input"})]),a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("div",{staticStyle:{padding:"5px","margin-right":"80px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[a("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[a("textarea",{staticClass:"ace_text-input"})])]):e._e()],1)],1)],1)},s=[],l=a("1285"),n=a("89e8"),c=a("e0e9"),d=a("7212"),p=a("bb22"),u=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())}),m="",h="",g={name:"ThingsParse",props:{},data(){var e=(e,t,a)=>{const i=/[0-9a-zA-Z]/;i.test(t)?a():a(new Error("协议名称由数字和字母组合"))};return{currentRow:null,AllDict:[],productName:"",form:{Productname:"",ProductKey:"",ProductAll:0},decoderstart:0,decodertotal:0,decoderlength:10,protolchannel:[],productdetail:{},thingsParseModel:{name:"",version:"",desc:"",resource:!1},thingsParseRules:{name:[{required:!0,message:"请输入协议名称",trigger:"blur"},{validator:e,trigger:"blur"}]},dialogTableVisible:!1,gridData:[],protoldialog:!1}},computed:{tableFilterData(){return null}},mounted(){o=ace.edit("editor2"),o.session.setMode("ace/mode/text"),o.setTheme("ace/theme/monokai"),o.setReadOnly(!0),o.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.Industry(),this.getAllunit(),this.getAllDict(),this.$route.query.activeName&&(this.activeName=this.$route.query.activeName)},methods:{handleCurrentChange(e){this.currentRow=e,this.$refs.singleTable.setCurrentRow(e),this.getProDetail(e.objectId)},getAllDict(){return u(this,null,(function*(){const e={where:{category:{$nin:["Evidence"]}},order:"updatedAt"},{results:t}=yield Object(d["queryProduct"])(e);t&&(this.AllDict=t,this.handleCurrentChange(t[0]))}))},Industry(){return u(this,null,(function*(){this.option=[];const{results:e}=yield this.$getIndustry("category",100);e.map(e=>{var t={};t.value=e.type,t.label=e.data.CategoryName,t.id=e.data.Id,t.parentid=e.data.SuperId,this.option.push(t)})}))},getProDetail(e){this.productId=e,i=ace.edit("editor"),i.session.setMode("ace/mode/erlang"),i.setTheme("ace/theme/monokai"),i.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.$get_object("Product",e).then(e=>{if(e){for(var t in dgiotlog.log("response",e.decoder),this.productName=e.name,e)this.productdetail[t]=e[t];this.option.map(e=>{this.productdetail.category==e.value&&(this.productdetail.category=e.label)}),this.productdetail.createdAt=this.utc2beijing(e.createdAt),this.productdetail.id=e.id,this.dynamicReg=e.dynamicReg,this.productdetail.isshow=0,this.form.Productname=e.name,this.ProductSecret=e.productSecret,this.form.Productkey=this.productId,this.productimg=e.icon,e.decoder?(h=e.decoder.code,this.thingsParseModel.name=e.decoder.name,this.thingsParseModel.version=e.decoder.version,this.thingsParseModel.desc=e.decoder.desc):(this.$baseMessage("暂无decoder,将显示默认值","warning",!1),h="JSUlLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQolJSUgQGNvcHlyaWdodCAoQykgMjAxOCwgPHNodXdhPgolJSUgQGRvYwolJSUg5Y2P6K6u6Kej5p6QRGVtbwolJSUgQGVuZAolJSUgQ3JlYXRlZCA6IDA4LiDljYHkuIDmnIggMjAxOCAxNDo0OQolJSUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi1tb2R1bGUoc2h1d2FfZGVtb19kZWNvZGVyKS4KLWF1dGhvcigic2h1d2EiKS4KLWRlZmluZShNU0dfVFlQRSwgPDwiREVNTyI+PikuCi1wcm90b2NvbChbPDwiREVNTyI+Pl0pLgoKLWV4cG9ydChbcGFyc2VfZnJhbWUvMiwgdG9fZnJhbWUvMV0pLgoKCnBhcnNlX2ZyYW1lKEJ1ZmYsIE9wdHMpIC0+CiAgICBwYXJzZV9mcmFtZShCdWZmLCBbXSwgT3B0cykuCgoKcGFyc2VfZnJhbWUoPDw+PiwgQWNjLCBfT3B0cykgLT4KICAgIHs8PD4+LCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBSZXN0L2JpbmFyeT4+ID0gQmluLCBBY2MsIF9PcHRzKSB3aGVuIGJ5dGVfc2l6ZShSZXN0KSA9PCA2IC0+CiAgICB7QmluLCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBMZW46MTYvbGl0dGxlLWludGVnZXIsIExlbjoxNi9saXR0bGUtaW50ZWdlciwgMTYjNjgsIFJlc3QvYmluYXJ5Pj4gPSBCaW4sIEFjYywgT3B0cykgLT4KICAgIGNhc2UgYnl0ZV9zaXplKFJlc3QpIC0gMiA+PSBMZW4gb2YKICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgIGNhc2UgUmVzdCBvZgogICAgICAgICAgICAgICAgPDxVc2VyWm9uZTpMZW4vYnl0ZXMsIENyYzo4LCAxNiMxNiwgUmVzdDEvYmluYXJ5Pj4gLT4KICAgICAgICAgICAgICAgICAgICBBY2MxID0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBzaHV3YV91dGlsczpnZXRfcGFyaXR5KFVzZXJab25lKSA9Oj0gQ3JjIG9mCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJhbWUgPSAjewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8PCJtc2d0eXBlIj4+ID0+ID9NU0dfVFlQRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPDwiZGF0YSI+PiA9PiBVc2VyWm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWNjICsrIFtGcmFtZV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFjYwogICAgICAgICAgICAgICAgICAgICAgICBlbmQsCiAgICAgICAgICAgICAgICAgICAgcGFyc2VfZnJhbWUoUmVzdDEsIEFjYzEsIE9wdHMpOwogICAgICAgICAgICAgICAgXyAtPgogICAgICAgICAgICAgICAgICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykKICAgICAgICAgICAgZW5kOwogICAgICAgIGZhbHNlIC0+CiAgICAgICAgICAgIHtCaW4sIEFjY30KICAgIGVuZDsKcGFyc2VfZnJhbWUoPDxfOjgsIFJlc3QvYmluYXJ5Pj4sIEFjYywgT3B0cykgLT4KICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykuCgoKJSUg57uE6KOF5oiQ5bCB5YyFLCDlj4LmlbDkuLpNYXDlvaLlvI8KdG9fZnJhbWUoI3s8PCJtc2d0eXBlIj4+IDo9ID9NU0dfVFlQRX0gPSBGcmFtZSkgLT4KICAgIFBheWxvYWQgPSB0ZXJtX3RvX2JpbmFyeShGcmFtZSksCiAgICA8PDE2IzAzLCBQYXlsb2FkL2JpbmFyeSwgMTYjMjM+Pi4="),this.productdetail.thing||(this.productdetail.thing={properties:[]}),this.wmxData=this.productdetail.thing.properties.filter(e=>e.name&&e.dataType),i.setValue(Base64.decode(h)),i.gotoLine(i.session.getLength()),this.queryDeviceCount(this.productId)}})},queryDeviceCount(e){return u(this,null,(function*(){this.form.ProductAll=yield Object(l["getDeviceCountByProduct"])(e)}))},editordata(e){this.thingsParseModel.name=e.data.name,this.thingsParseModel.version=e.data.version,this.thingsParseModel.desc=e.data.desc,this.thingsParseModel.resource=e.data.enable,i.setValue(Base64.decode(e.data.code)),this.dialogTableVisible=!1},getAllunit(){return u(this,null,(function*(){this.allunit=[];const{results:e}=yield Object(c["getAllunit"])("unit",100);this.allunit=e.concat([]),this.allunit.unshift({data:{Name:"无",Symbol:""}})}))},subAce(e,t){this.$refs[e].validate(a=>{if(a){var r={name:e.name,version:e.version,code:Base64.encode(i.getValue()),desc:e.desc};const a={decoder:r};this.$update_object("Product",this.productId,a).then(e=>{0==this.issub&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"保存成功"}),1==t&&(m+="保存成功",o.setValue(m))),this.issub=!0})}else this.$message({showClose:!0,duration:2e3,type:"warning",message:"输入格式有误"})})},subAce1(e){this.$refs[e].validate(e=>{if(e){const e={where:{"data.name":this.thingsParseModel.name,"data.version":this.thingsParseModel.version}};this.$query_object("Dict",e).then(e=>{e.results&&e.results.length>=1?this.$message("此协议版本已存在"):this.$get_object("Product",this.productId).then(e=>{if(e){var t={name:this.thingsParseModel.name,version:this.thingsParseModel.version,code:Base64.encode(i.getValue()),desc:this.thingsParseModel.desc};const a={type:"decoder",data:t,ACL:e.ACL};this.$create_object("Dict",a).then(e=>{e.error?this.$message({showClose:!0,duration:2e3,type:"error",message:e.error}):this.$message({showClose:!0,duration:2e3,type:"success",message:"保存到公共协议库成功"})}).catch(e=>{dgiotlog.log(e)})}})})}else this.$message({showClose:!0,duration:2e3,type:"warning",message:"输入格式有误"})})},decoderSizeChange(e){this.decoder.length=e,this.chaxun()},devicerCurrentChange(e){this.decoderstart=(e-1)*this.decoderlength,this.chaxun()},updateAllChannel(){if(0==this.multipleSelection.length)this.protoldialog=!1;else{var e=[];this.multipleSelection.map(t=>{e.push(new Promise((e,a)=>Object(p["subupadte"])(t.id,"update").then(t=>{t&&e(t)}).catch(e=>{a(e)})))}),Promise.all(e).then(e=>{this.$message({showClose:!0,duration:2e3,message:"热加载成功",type:"success"}),e.length==this.multipleSelection.length&&(this.protoldialog=!1)}).catch(e=>{this.$message({showClose:!0,duration:2e3,message:e,type:"error"})})}},handleSelectionChange(e){this.multipleSelection=e},utc2beijing(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},getChannelEnable(e,t){return 1==e.isEnable?"green_active":"red_active"},deletedata(e){this.$del_object("Dict",e).then(e=>{e&&(this.$message("成功删除"),this.chaxun())})},updatesubdialog(){this.protoldialog=!0;const e="1",t={__type:"Pointer",className:"Product",objectId:this.productId};Object(n["getChannelCountByProduct"])(10,0,t,e).then(e=>{e.count>0?(this.protolchannel=e.results,this.$refs.multipleTable.toggleAllSelection()):(this.protolchannel={},this.$refs.multipleTable.toggleAllSelection())}).catch(e=>{dgiotlog.log(e),this.$baseMessage("请求出错",e.error,3e3)})},chaxun(){const e={skip:this.decoderstart,limit:this.decoderlength,order:"-createdAt",where:{type:"decoder"}};this.$query_object("Dict",e).then(e=>{e&&(this.decodertotal=e.count,this.dialogTableVisible=!0,this.gridData=e.results)})},protol(){var e="";Object(p["Compile"])(Base64.encode(i.getValue())).then(t=>{t&&(this.$message({showClose:!0,duration:2e3,type:"success",message:"编译成功"}),e="编译成功"+t.mod+"\r\n",this.warningeditror=t.warnings,this.warningeditror.map(t=>{e+=t+"\r\n"}),m+=e,o.setValue(m))}).catch(t=>{this.warningeditror=t.error,this.warningeditror.map(t=>{e+=t+"\r\n"}),m+=e,o.setValue(m)})}}},b=g,f=(a("b973"),a("2877")),v=Object(f["a"])(b,r,s,!1,null,null,null);t["default"]=v.exports},"82e9":function(e,t,a){},9080:function(e,t,a){},9715:function(e,t,a){"use strict";a("56f7")},"99a4":function(e,t,a){},a490:function(e,t,a){},b2d2:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{ref:"platform",staticClass:"platform"},[a("div",{staticClass:"home_dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.deviceInfo.name,visible:e.deviceFlag,width:"100vh"},on:{"update:visible":function(t){e.deviceFlag=t}}},[a("info",{attrs:{devicedetail:e.deviceInfo}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.deviceFlag=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1),a("div",{staticClass:"map_header",style:{height:e.queryForm.workGroupTreeShow?"160px":"auto"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"0px"!=e.cardHeight,expression:"cardHeight != '0px'"}],staticClass:"map_card"},[a("el-row",[a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["product_count"],expression:"loadingConfig['product_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"projector-fill"}})],1),a("el-col",{staticClass:"card-right",attrs:{span:12}},[a("router-link",{attrs:{to:"/dashboard/productlist"}},[a("p",[e._v(e._s(e.$translateTitle("home.pro_count")))]),a("p",[e._v(e._s(e._product_count))])])],1)],1)],1),a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["app_count"],expression:"loadingConfig['app_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"apps-fill"}})],1),a("el-col",{staticClass:"card-right",attrs:{span:12}},[a("router-link",{attrs:{to:"/roles/applicationManagement"}},[a("p",[e._v(e._s(e.$translateTitle("home.app_count")))]),a("p",[e._v(e._s(e._app_count))])])],1)],1)],1),a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["device_count"],expression:"loadingConfig['device_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"device-recover-fill"}})],1),a("el-col",{staticClass:"card-right",staticStyle:{cursor:"pointer"},attrs:{span:12},nativeOn:{click:function(t){return e.goDevice()}}},[a("p",[e._v(e._s(e.$translateTitle("home.dev_count")))]),a("p",[e._v(e._s(e._dev_count))])])],1)],1),a("el-col",{staticClass:"card-panel-col",attrs:{lg:6,md:6,sm:12,xl:6,xs:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:0==e.loadingConfig["warn_count"],expression:"loadingConfig['warn_count'] == false"}],staticClass:"box-card",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-col",{staticClass:"card-left",attrs:{span:12}},[a("dgiot-icon",{attrs:{icon:"projector-2-fill"}})],1),a("el-col",{staticClass:"card-right",attrs:{span:12}},[a("router-link",{attrs:{to:"/CloudOt/alarm"}},[a("p",[e._v(" "+e._s(e.$translateTitle("equipment.Total number of alarms"))+" ")]),a("p",[e._v(e._s(e.warnCount))])])],1)],1)],1)],1)],1)]),a("el-card",{attrs:{shadow:"hover"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:"baidu"==e.mapType,expression:"mapType == 'baidu'"}],attrs:{row:24}},[a("el-col",{attrs:{span:e.leftRow,xs:24}},[a("el-row",{attrs:{span:24}},[a("div",{staticClass:"chart_map",staticStyle:{position:"relative",width:"100%"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"card_left"},[a("el-row",{staticClass:"card_left-row",attrs:{gutter:24}},[a("el-col",{staticClass:"card_left-row-col",attrs:{span:6}},[a("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#ffad33","border-color":"#ffad33"}},[a("div",{staticStyle:{"text-align":"center"}},[a("Tag",{staticStyle:{background:"rgb(255, 173, 51)"},attrs:{checkable:"",color:"warning"}},[e._v(" "+e._s(e.offlineData.length||0)+" ")]),a("p",[e._v(e._s(e.$translateTitle("zetadevices.offline")))])],1)])],1),a("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[a("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#19be6b","border-color":"#19be6b"}},[a("div",{staticStyle:{"text-align":"center"}},[a("Tag",{staticStyle:{background:"rgb(25, 190, 107)"},attrs:{checkable:"",color:"success"}},[e._v(" "+e._s(e.dev_online_count||0)+" ")]),a("p",[e._v(e._s(e.$translateTitle("zetadevices.online")))])],1)])],1),a("el-col",{staticClass:"card_left-row-col",attrs:{offset:2,span:6}},[a("Card",{staticClass:"card_left-row-col-card",staticStyle:{"background-color":"#f16643","border-color":"#f16643"}},[a("div",{staticStyle:{"text-align":"center"}},[a("Tag",{staticStyle:{background:"rgb(241, 102, 67)"},attrs:{checkable:"",color:"error"}},[e._v(" "+e._s(e.warnCount)+" ")])],1),a("p",[e._v(" "+e._s(e.$translateTitle("leftbar.alarms"))+" ")])])],1)],1)],1),a("div",{staticClass:"card",staticStyle:{position:"absolute",right:"100px","z-index":"1000"}},[a("p",{staticStyle:{margin:"0","font-size":"18px",color:"#f16643","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("zetadevices.offline"))+" ")]),a("Card",{staticStyle:{width:"80px",height:"80px",color:"#fff","background-color":"#ffad33","border-color":"#ffad33","border-radius":"50%",opacity:"0.89"}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v(e._s(e.offlineData.length||0))])])]),a("p",{staticStyle:{margin:"0","font-size":"18px",color:"rgb(25, 190, 107)","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("zetadevices.online"))+" ")]),a("Card",{staticStyle:{width:"80px",height:"80px",margin:"5px 0",color:"#fff","background-color":"#19be6b","border-color":"#19be6b","border-radius":"50%",opacity:"0.89"}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v(e._s(e.dev_online_count||0))])])]),a("p",{staticStyle:{margin:"0","font-size":"18px",color:"rgb(241, 102, 67)","text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("leftbar.alarms"))+" ")]),a("Card",{staticStyle:{width:"80px",height:"80px",color:"#fff","background-color":"#f16643","border-color":"#f16643","border-radius":"50%",opacity:"0.89"}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v(e._s(e.warnCount))])])])],1),a("baidu-map",{staticClass:"baidu_map",attrs:{id:"baidu_map",ak:e.ak,center:e.center,"scroll-wheel-zoom":!0,zoom:e.sizeZoom}},[a("bm-control",[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=19}}},[e._v(" "+e._s(e.$translateTitle("home.max"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=10}}},[e._v(" "+e._s(e.$translateTitle("home.restore"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=3}}},[e._v(" "+e._s(e.$translateTitle("home.min"))+" ")]),a("el-button",{staticClass:"ri-fullscreen-fill",attrs:{size:"mini"},on:{click:function(t){return e.toggleFull()}}}),a("bm-overview-map",{attrs:{"is-open":!0}}),a("bm-scale",{attrs:{offset:{width:260,height:0}}}),a("bm-city-list",{attrs:{offset:{width:330,height:0}}})],1),a("bml-marker-clusterer",{attrs:{"average-center":!0}},e._l(e._tableData,(function(t,i){return a("div",{key:i},[a("bm-marker",{attrs:{animation:"BMAP_ANIMATION_BOUNCE",dragging:!0,icon:{url:1==t.icon?e.icoPath.icoPath1:e.icoPath.icoPath2,size:{width:70,height:70}},position:{lng:t.location.longitude,lat:t.location.latitude}}},[a("bm-label",{attrs:{content:t.name,"label-style":{color:"red",fontSize:"12px"},offset:{width:15,height:6}},on:{click:function(a){return e._goDevice(t,i)}}})],1)],1)})),0),a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),a("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","auto-location":!0,"show-address-bar":!0,"show-zoom-info":!0}})],1)],1)])],1),a("el-col",{attrs:{span:24-e.leftRow,xs:24}},[a("div",{staticClass:"home_card"},[a("el-tabs",{on:{"tab-click":e.resizeTheChart},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("home.info"),name:"first"}},[a("div",{staticClass:"box-card"},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-button",[e._v(" "+e._s(e.$translateTitle("home.info"))+" ")])],1),a("div",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple"},[e.Product?a("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.Product,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("menu.icon"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-image",{staticStyle:{width:"26px",height:"26px"},attrs:{"preview-src-list":[""+t.icon],src:t.icon}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])]}}],null,!1,3281234111)}),a("el-table-column",{attrs:{label:e.$translateTitle("task.productname"),prop:"name","show-overflow-tooltip":!0,width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{on:{click:function(t){return e.goDevice(i.name)}}},[e._v(" "+e._s(i.name)+" ")])]}}],null,!1,699248853)}),a("el-table-column",{attrs:{label:e.$translateTitle("home.dev_count")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{on:{click:function(t){return e.goDevice(i.name)}}},[e._v(" "+e._s(i.deviceChild.length)+" ")])]}}],null,!1,100581394)})],1):e._e()],1)])],1)],1)])],1),a("el-col",{attrs:{md:24,sm:24,xl:24,xs:24}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(" "+e._s(e.$translateTitle("equipment.Equipment Overview"))+" ")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{icon:"el-icon-refresh",type:"text"},on:{click:function(t){return e.resizeTheChart()}}})],1),a("div",{staticClass:"text item"},[a("dgiot-chart",{ref:"charts",attrs:{data:e._ChartStatus,"data-empty":!e.ChartStatus.rows,extend:e.chartExtend,height:"160px",loading:e.loading,settings:e.chartSettings,type:"ring"}})],1)])],1)],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_unline"),name:"second"}},[a("div",{staticClass:"box-card"},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-badge",{staticClass:"item",attrs:{value:e._dev_off_count}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_unline")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_unline"))+" ")])],1)],1),a("div",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._offlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{attrs:{title:i.name+e.$translateTitle("home.Last online Time")+i.updatedAt},on:{click:function(t){return e.showInfo(i.objectId)}}},[e._v(" "+e._s(i.name)+" ")])]}}])})],1)],1)])],1)],1)])],1)]),a("el-tab-pane",{attrs:{label:e.$translateTitle("home.dev_online"),name:"third"}},[a("div",{staticClass:"box-card"},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-badge",{staticClass:"item",attrs:{value:e._dev_online_count}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e._goDevice("dev_online")}}},[e._v(" "+e._s(e.$translateTitle("home.dev_online"))+" ")])],1)],1),a("div",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-table",{staticClass:"_el-table",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e._onlineData,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{attrs:{title:i.name+e.$translateTitle("home.Last online Time")+i.updatedAt},on:{click:function(t){return e.showInfo(i.objectId)}}},[e._v(" "+e._s(i.name)+" ")])]}}])})],1)],1)])],1)],1)])],1)])],1)],1)])],1)],1)],1)])},o=[],r=a("fdeb"),s=a.n(r),l=a("327b"),n=a.n(l),c=a("1285"),d=a("5880"),p=a("bc35"),u=a("bb22"),m=a("ed08"),h=a("c4e6"),g=a("22f9"),b=a("cb88"),f=Object.defineProperty,v=Object.defineProperties,y=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,C=(e,t,a)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,k=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&C(e,a,t[a]);if(_)for(var a of _(t))T.call(t,a)&&C(e,a,t[a]);return e},x=(e,t)=>v(e,y(t)),S=(e,t,a)=>new Promise((i,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},s=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);l((a=a.apply(e,t)).next())});window.dgiot.dgiotEnv=Object({NODE_ENV:"production",VUE_APP_TITLE:"物联网开发平台",VUE_APP_AUTHOR:"iotn2n",VUE_APP_UPDATE_TIME:"2022年06月15日12时40分13秒",VUE_APP_VERSION:"4.5.4",VUE_APP_Keywords:"一站式物联网PaaS平台|物联网应用服务",VUE_APP_Description:"提供物联网垂直领域应用使能平台及解决方案",VUE_APP_URL:"http://127.0.0.1:5080",VUE_APP_CDN_URL:"/dgiot_dashboard/public",BASE_URL:""});var I={name:"Home",components:{BmPointCollection:b["BmPointCollection"],BmInfoWindow:b["BmInfoWindow"],info:h["default"],BmScale:b["BmScale"],BmMapType:b["BmMapType"],BmOverviewMap:b["BmOverviewMap"],BmPanorama:b["BmPanorama"],BmControl:b["BmControl"],BmLabel:b["BmLabel"],BaiduMap:b["BaiduMap"],BmNavigation:b["BmNavigation"],BmGeolocation:b["BmGeolocation"],BmCityList:b["BmCityList"],BmMarker:b["BmMarker"],BmlMarkerClusterer:b["BmlMarkerClusterer"]},data(){return this.chartSettings={radius:[5,40],offsetY:100},this.chartExtend={yAxisType:["percent"],tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"}},{queryParams:{},mapHeight:"800px",mapWidth:"800px",polyline:{editing:!1,paths:[]},list:{toolbar:!1,latitude:"31.551162",longitude:"120.260545",zoom:15},mapType:"baidu",isShow:!0,ak:this.$dgiot.secret.baidu.map,center:{lng:120.260545,lat:31.551162},icoPath:{icoPath1:s.a,icoPath2:n.a},router:"",loadingConfig:{product_count:!1,app_count:!1,device_count:!1,warn_count:!1},warnCount:0,count:0,productIco:"",ChartStatus:{columns:["状态","数量"],rows:[{"状态":"在线","数量":0},{"状态":"离线","数量":0}]},clientId:"dgiot_clientId_",infoWindow:{show:!0,contents:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."},loading:!0,marker:{},deviceFlag:!1,deviceInfo:{detail:{}},Product:[],imgurl:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",subtopic:"",isConnect:!1,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20,workGroupName:"",workGroupTreeShow:!1,access_token:""},roleProps:{children:"children",label:"name"},leftWidth:"",cardHeight:"",fixedPaddingTop:"",curDepartmentId:"",leftRow:24,treeDataValue:"",deptTreeData:[],show:!1,sizeZoom:5,tableData:[],offlineData:[],onlineData:[],chartSetting:{yAxis:{type:"value",minInterval:1}},msgtopic:"",NODE_ENV:"production",category:[],activeName:"second",filterBox:"filterBox-first",project_count:0,app_count:0,product_count:0,dev_count:0,active:!1,dev_active_count:0,dev_online_count:0,dev_off_count:0,projectList:[],formInline:{starttime:"",project:""}}},computed:k({},Object(d["mapGetters"])({objectId:"user/objectId",roleTree:"user/roleTree",collapse:"settings/collapse",_Product:"user/_Product",language:"settings/language",_dev_count:"dashboard/_dev_count",_project_count:"dashboard/_project_count",_app_count:"dashboard/_app_count",_product_count:"dashboard/_product_count",token:"user/token",_dev_online_count:"dashboard/_dev_online_count",_onlineData:"dashboard/_onlineData",_dev_off_count:"dashboard/_dev_off_count",_offlineData:"dashboard/_offlineData",_ChartStatus:"dashboard/_ChartStatus",_tableData:"dashboard/_tableData",_pcimg:"dashboard/_pcimg",_role:"acl/role",_mimg:"dashboard/_mimg",mqttInfo:"mqttDB/mqttInfo",treeFlag:"settings/treeFlag"})),watch:{treeFlag:{handler:function(e){this.mapWidth=e?.77*window.innerWidth+"px":.98*window.innerWidth+"px"},deep:!0,limit:!0},sizeZoom:{handler:function(e){console.log("当前sizeZoom 为 "+e)},deep:!0,limit:!0}},mounted(){window.bh="",window.kd="",this.initMapHeight(),this.router=this.$dgiotBus.router(this.$route.fullPath),this.$dgiotBus.$off("qqMapClcik"),this.$dgiotBus.$on("qqMapClcik",e=>{console.log(e)}),this.queryForm.account="zh"==this.language?"全部产品":"All Products",this.initDgiotMqtt(),window.onresize=()=>(()=>{this.mapHeight=.8*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px"})()},beforeDestroy(){return S(this,null,(function*(){}))},activated(){this.resizeTheChart()},destroyed(){this.resizeTheChart()},methods:x(k({initMapHeight(){return S(this,null,(function*(){this.mapHeight=.7*window.innerHeight+"px",this.mapWidth=.98*window.innerWidth+"px"}))},handler({BMap:e,map:t}){console.log(e,t)},getPosition(e){return e.forEach(e=>{e.lng=e.location.longitude,e.lat=e.location.latitude}),console.log(e),e},initDgiotMqtt(){this.$nextTick(()=>S(this,null,(function*(){yield this.queryData(),yield this.setTreeFlag(!0)})))},getWarnCount(){return S(this,arguments,(function*(e={count:"objectId",where:{}}){e.where["createdAt"]={$gt:{__type:"Date",iso:moment().subtract(1,"days").format("YYYY-MM-DD")}},e.where["updatedAt"]={$lt:{__type:"Date",iso:moment(new Date).format("YYYY-MM-DD")}};try{const{count:t=0}=yield this.$query_object("Maintenance",e);this.warnCount=t}catch(t){this.$baseMessage(""+t,"error","dgiot-hey-message-error")}}))},toggleFull(e){this.count++,this.count%2==0?this.$exitFull("baidu_map"):this.$beFull("baidu_map")},resizeTheChart(){this.loading=!0;let e=this.$refs["charts"];e&&(e.$children[0].resize(),setTimeout(()=>{this.loading=!1},2e3))},tableRowClassName({row:e,rowIndex:t}){return 1===t?"warning-row":2===t?"success-row":""}},Object(d["mapMutations"])({setTreeFlag:"settings/setTreeFlag",resaveMqttInfo:"mqttDB/resaveMqttInfo",set_Product:"user/set_Product",set_dev_count:"dashboard/set_dev_count",set_project_count:"dashboard/set_project_count",set_app_count:"dashboard/set_app_count",set_product_count:"dashboard/set_product_count",set_dev_online_count:"dashboard/set_dev_online_count",set_onlineData:"dashboard/set_onlineData",set_dev_off_count:"dashboard/set_dev_off_count",set_offlineData:"dashboard/set_offlineData",set_ChartStatus:"dashboard/set_ChartStatus",set_tableData:"dashboard/set_tableData"})),{deviceToDetail(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.objectId,nodeType:"2",ischildren:"false"}})},getCategory(e){let t="";return this.category.filter(a=>{a.type==e&&(t=a.data.CategoryName)}),t},closeInfo(e,t){},showDeatils(e,t){return S(this,null,(function*(){}))},showInfo(e){return S(this,null,(function*(){this.deviceInfo=yield Object(c["getDevice"])(e);let t=this.deviceInfo.product.objectId||"undefined",a=this.deviceInfo.devaddr||"undefined",i=[{topic:`thing/${t}/${a}/post`,type:"pub",desc:"设备上报",isdef:!0},{topic:`thing/${t}/${a}`,type:"sub",desc:"消息下发",isdef:!0}];this.deviceInfo.product.topics?this.deviceInfo.topicData=this.deviceInfo.product.topics.concat(i):this.deviceInfo.topicData=i,this.deviceFlag=!0}))},mqttMsg(e){let t=Object(m["isBase64"])(e)?Base64.decode(e):e;console.log(t,"收到消息");let a=JSON.parse(t).value,i=JSON.parse(t).vuekey;switch(i){case"app_count":this.app_count=a.count,this.set_app_count(this.app_count);break;case"project_count":this.project_count=a.count,this.set_project_count(this.project_count);break;case"product_count":this.product_count=a.count,this.set_product_count(this.product_count),this.Product=a.results;break;case"dev_online_count":this.dev_online_count=a.count,this.set_dev_online_count(this.dev_online_count),this.onlineData=a.results,this.set_onlineData(this.onlineData);break;case"dev_off_count":console.error(a,"mqttMsgValue"),this.dev_off_count=a.count,this.offlineData=a.results,this.set_dev_off_count(this.dev_off_count),this.set_offlineData(this.offlineData);break;case"warn_count":this.warnCount=a.count;break;case"ChartStatus":this.ChartStatus=a.chartData,this.set_ChartStatus(this.ChartStatus),this.resizeTheChart(),this.$forceUpdate();break;case"baiduMap":this.tableData=a,this.tableData.forEach(e=>{e.show=!1,e.color="0"===e.icon?"yellow":"1"===e.icon?"blue":"red"}),this.set_tableData(this.tableData),this.$forceUpdate();break;case"device_count":this.dev_count=a.count,this.set_dev_count(this.dev_count);break;default:break}this.$forceUpdate()},toggleCard(e){"0px"!=e?($(".map_card").css({height:"0px"}),this.cardHeight="0px"):($(".map_card").css({height:"98px"}),this.cardHeight="98px")},toggleLeftWidth(e){"0px"!=e?($(".dgiot-side-bar").css({width:"0px"}),$(".dgiot-main").css({"margin-left":"0px"}),this.leftWidth="0px"):($(".dgiot-side-bar").css({width:"200px"}),$(".dgiot-main").css({"margin-left":"200px"}),this.leftWidth="200px")},selectProdChange(e){},queryData(){return S(this,null,(function*(){const{dashboard:e={}}=yield Object(g["getDlinkJson"])("Dashboard");this.queryParams=e,setTimeout(()=>{this.queryParams.forEach(e=>{let t=e.vuekey;this.loadingConfig[""+t]=!0})},1240);const t="32511dbfe5";yield Object(u["Startdashboard"])(this.queryParams,t),this.$dgiotBus.$on(this.$dgiotBus.getTopicKeyBypage("dashboard"),e=>{const{payloadString:t}=e;console.log("home page topic data",t),console.log(e),this.mqttMsg(t)}),this.$nextTick(()=>{if("tencent"==this.mapType&&(this.setTreeFlag(!1),this.$refs.qqmap.$children[0].qqmap)){console.clear(),console.error(this.$refs.qqmap.$children[0]," this.$refs.qqmap.$children[0].qqmap"),document.querySelector(".lngTips").style.display="none",window.qq.maps.event.addListener(this.$refs.qqmap.$children[0].qqmap,"mousemove",(function(e){document.querySelector(".lngTips").style.display="none"}));var e=new window.qq.maps.LatLng(28.475997,121.331121),t=new qq.maps.InfoWindow({map:this.$refs.qqmap.$children[0].qqmap,position:e,content:'<div><h3>国家水泵产品质量检验中心(浙江)\n</h3><p>浙江省台州市温岭市迎宾大道温岭市泵业创新服务综合体\n</p><img class="pic" style="width:320px" src="https://sv6.map.qq.com/mmthumb?svid=18091033131005101120600&amp;from=web"></div>'});t.open(),this.$refs.qqmap.$children[0].qqmap.setZoom(18)}})}))},getProduct(){return S(this,null,(function*(){const{results:e}=yield queryProduct({count:"objectId",order:"-updatedAt",keys:"name,icon",where:{}});e.unshift({name:"zh"==this.language?"全部产品":"All Products",objectId:"0"}),this.set_Product(e)}))},change(e){e&&$(".el-tree").css({height:"100px",display:"block","overflow-x":"auto"})},handleNodeClick(e,t){return S(this,null,(function*(){const a=this._role.map(e=>e.name);if($(".el-tree").css({height:"0px",display:"none","overflow-x":"auto"}),$(".el-select-dropdown").css({display:"none"}),this.queryForm.workGroupName=e.label,this.treeDataValue=e.label,a.includes(e.name))this.queryForm.access_token=this.token;else if(1!=t.level){const{access_token:t=""}=yield Object(p["getToken"])(e.name);this.queryForm.access_token=t}else this.queryForm.access_token=this.token;this.queryForm.workGroupTreeShow=!this.queryForm.workGroupTreeShow;const{name:i,objectId:o}=e;this.curDepartmentId=o}))},handleChange(){},handleClickVisit(e){this.$router.push({path:"/Topo",query:{productid:e.objectId}})},goDevice(e){var t;this.$router.push({path:"/dashboard/device",query:{product:e}}),console.log(window.errRoute),(null==(t=null==window?void 0:window.errRoute)?void 0:t.name)&&this.$router.push({path:"/dashboard/devicelist",query:{product:e}})},_goDevice(e){var t;this.$router.push({path:"dashboard/device",query:{devicename:e.name}}),console.log(window.errRoute),(null==(t=null==window?void 0:window.errRoute)?void 0:t.name)&&this.$router.push({path:"/dashboard/devicelist",query:{devicename:e.name}})},goLink(e,t){var a;switch(e){case"real-time":this.$router.push({path:"/roles/editdevices",query:{deviceid:this.deviceInfo.objectId,nodeType:2,ischildren:"false"}});break;case"konva":this.$router.push({path:"/Topo",query:{productid:this.deviceInfo.product.objectId,devaddr:this.deviceInfo.devaddr,deviceid:this.deviceInfo.objectId,type:"device"}});break;case"video":const{basedata:e}=this.deviceInfo;if(!(null==(a=null==e?void 0:e.videoSrc)?void 0:a.length))return this.$baseMessage(this.$translateTitle("equipment.The device is not bound to the video address yet"),"info","dgiot-hey-message-error"),!1;this.$router.push({path:"/Tools/player",query:{type:e.videoType||"m3u8",url:e.videoSrc}});break}},Gotoproduct(e){this.$router.push({path:"/dashboard/productlist",query:{project:e}})}})},P=I,j=(a("78425"),a("2877")),D=Object(j["a"])(P,i,o,!1,null,"c0e6d152",null);t["default"]=D.exports},b351:function(e,t,a){"use strict";a("82e9")},b973:function(e,t,a){"use strict";a("ee6f")},d13b:function(e,t,a){"use strict";a("04d6")},e7b4:function(e,t,a){"use strict";a("f51f")},ea58:function(e,t,a){},ee6f:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},f1e8:function(e,t,a){"use strict";a("99a4")},f51f:function(e,t,a){}}]);